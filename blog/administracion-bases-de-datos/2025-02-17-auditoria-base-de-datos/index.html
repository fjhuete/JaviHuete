<!doctype html>
<html
  itemscope
  class=""
  lang="es-Es"
  itemtype="http://schema.org/WebPage">
  <head>
    
    <meta charset="utf-8" />


<meta
  name="viewport"
  content="width=device-width, initial-scale=1, maximum-scale=5" />


<meta name="theme-name" content="hugoplate" />















<link rel="shortcut icon" href="/images/favicon_hu_97d734128f375af.png" type="image/x-icon">
<link rel="icon" href="/images/favicon_hu_97d734128f375af.png" type="image/x-icon">
<link rel="icon" type="image/png" sizes="48x48" href="/images/favicon_hu_2a8eebffbb7fef12.png">
<link rel="icon" type="image/png" sizes="96x96" href="/images/favicon_hu_97d734128f375af.png">
<link rel="apple-touch-icon" sizes="144x144" href="/images/favicon_hu_cb22fd2ed3486ab3.png">








<link rel="manifest" href="/manifest.webmanifest" />
<meta
  name="msapplication-TileColor"
  content="#ddd" />
<meta
  name="theme-color"
  content="#ffffff" />





























  


<title>Auditoría de bases de datos</title>















  <meta
    name="keywords"
    content="Javi Huete, Virtualización, Sistemas, Informática, Bases de datos" />




<meta
  name="description"
  content="Estudiante de Administración de Sistemas Infomáticos en Red" />



  <meta name="author" content="Javi Huete" />






  












  

  
  
  


  
  
    
    
      
    

    


    
    


    
    
      
      
      
        <meta property="og:image" content="/images/og-image.png" />
        <meta name="twitter:image" content="/images/og-image.png" />
        <meta
          name="twitter:card"
          content="summary_large_image" />
      
      
      <meta property="og:image:width" content="1123" />
      <meta property="og:image:height" content="650" />
    


    
    <meta
      property="og:image:type"
      content="image/.png" />
  


  





<meta property="og:title" content="Auditoría de bases de datos" />
<meta property="og:description" content="Estudiante de Administración de Sistemas Infomáticos en Red" />
<meta property="og:type" content="website" />
<meta property="og:url" content="/blog/administracion-bases-de-datos/2025-02-17-auditoria-base-de-datos/" />


<meta name="twitter:title" content="Auditoría de bases de datos" />
<meta name="twitter:description" content="Estudiante de Administración de Sistemas Infomáticos en Red" />


  <meta name="twitter:site" content="@fj_huete" />


  <meta name="twitter:creator" content="@Javi Huete" />



















<script>
  let indexURL = "/searchindex.json";
  let includeSectionsInSearch = ["blog"];
  let search_no_results = "No hay resultados para";
  let search_initial_message = "Escribe algo para buscar...";
</script>























    
    
<meta http-equiv="x-dns-prefetch-control" content="on" />
<link rel="preconnect" href="https://use.fontawesome.com" crossorigin />
<link rel="preconnect" href="//cdnjs.cloudflare.com" />
<link rel="preconnect" href="//www.googletagmanager.com" />
<link rel="preconnect" href="//www.google-analytics.com" />
<link rel="dns-prefetch" href="https://use.fontawesome.com" />
<link rel="dns-prefetch" href="//ajax.googleapis.com" />
<link rel="dns-prefetch" href="//cdnjs.cloudflare.com" />
<link rel="dns-prefetch" href="//www.googletagmanager.com" />
<link rel="dns-prefetch" href="//www.google-analytics.com" />
<link rel="dns-prefetch" href="//fonts.googleapis.com" />
<link rel="dns-prefetch" href="//connect.facebook.net" />
<link rel="dns-prefetch" href="//platform.linkedin.com" />
<link rel="dns-prefetch" href="//platform.twitter.com" />




<link rel="preconnect" href="https://fonts.googleapis.com" />
<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
<script>
  (function () {
    const googleFont = document.createElement("link");
    googleFont.href = "https://fonts.googleapis.com/css2?family=Heebo:wght@400;600&family=Signika:wght@500;700&display=swap";
    googleFont.type = "text/css";
    googleFont.rel = "stylesheet";
    document.head.appendChild(googleFont);
  })();
</script>





  
    
      
    
  

  
    
      
    
  

  
    
      
    
  

  
    
      
    
  

  
    
      
    
  











  
  



<link
  href="/css/style.min.5b415ddfdcfc45a6381f2b2b542ec2e47841a7d4938375c23070838929369bec.css"
  integrity="sha256-W0Fd39z8RaY4HysrVC7C5HhBp9STg3XCMHCDiSk2m+w="
  rel="stylesheet" />


<link
  defer
  async
  rel="stylesheet"
  href="/css/style-lazy.min.1891ab9d1988b9b19756de1bbea47aecb95c7b5ab195f6fe52244b6eca5d8154.css"
  integrity="sha256-GJGrnRmIubGXVt4bvqR67Llce1qxlfb+UiRLbspdgVQ="
  media="print"
  onload="this.media='all'; this.onload=null;" />


  </head>

  <body>
    
    
      



      

    


    
    





    
    <header
  class="header sticky top-0 z-30">
  <nav class="navbar container">
    
    <div class="order-0">
      
      <a class="navbar-brand block" href="/">
        















  









  
  
  


  
  
    
    
  


  
  
      
      
    
    
    
    
    
    
  
  

  
  
    
    
      
      


      
      
        
        
        
        

        
        
        
      
      
    
  
  

  
    <img
      fetchpriority="high"
      decoding="async"
      class="img img-light"
      width="160"
      height="32"
      src="/images/logo_hu_147412e9a193273b.webp"
      alt="Javi Huete"
      onerror="this.onerror=null;this.src='\/images\/logo_hu_239070bac3e16f0e.png';" />

    <img
      fetchpriority="high"
      decoding="async"
      class="img img-dark"
      width="160"
      height="32"
      src="/images/logo-darkmode_hu_590aa44f8245a468.webp"
      alt="Javi Huete"
      onerror="this.onerror=null;this.src='\/images\/logo-darkmode_hu_7ac6db7b4e6aa847.png';" />
  
  


      </a>
    </div>
    
    <input id="nav-toggle" type="checkbox" class="hidden" />
    <label
      for="nav-toggle"
      class="order-3 cursor-pointer flex items-center lg:hidden text-dark dark:text-white lg:order-1">
      <svg id="show-button" class="h-6 fill-current block" viewBox="0 0 20 20">
        <title>Menu Open</title>
        <path d="M0 3h20v2H0V3z m0 6h20v2H0V9z m0 6h20v2H0V0z"></path>
      </svg>
      <svg id="hide-button" class="h-6 fill-current hidden" viewBox="0 0 20 20">
        <title>Menu Close</title>
        <polygon
          points="11 9 22 9 22 11 11 11 11 22 9 22 9 11 -2 11 -2 9 9 9 9 -2 11 -2"
          transform="rotate(45 10 10)"></polygon>
      </svg>
    </label>
    

    
    <ul
      id="nav-menu"
      class="navbar-nav order-3 hidden lg:flex w-full pb-6 lg:order-1 lg:w-auto lg:space-x-2 lg:pb-0 xl:space-x-8">
      
      
        
        
        
        
          <li class="nav-item">
            <a
              class="nav-link "
              
              href="/"
              >Inicio</a
            >
          </li>
        
      
        
        
        
        
          <li class="nav-item">
            <a
              class="nav-link "
              
              href="/about"
              >Sobre mí</a
            >
          </li>
        
      
        
        
        
        
          <li class="nav-item">
            <a
              class="nav-link "
              
              href="/blog"
              >Prácticas</a
            >
          </li>
        
      
        
        
        
        
          <li class="nav-item">
            <a
              class="nav-link "
              
              href="/contact"
              >Contacto</a
            >
          </li>
        
      
        
        
        
        
          <li class="nav-item nav-dropdown group relative">
            <span
              class="nav-link 
                
                
                
              
                
                
                
               inline-flex items-center">
              Más
              <svg class="h-4 w-4 fill-current" viewBox="0 0 20 20">
                <path
                  d="M9.293 12.95l.707.707L15.657 8l-1.414-1.414L10 10.828 5.757 6.586 4.343 8z" />
              </svg>
            </span>
            <ul
              class="nav-dropdown-list lg:group-hover:visible lg:group-hover:opacity-100">
              
                
                
                <li class="nav-dropdown-item">
                  <a
                    class="nav-dropdown-link "
                    
                    href="/authors">
                    Autores
                  </a>
                </li>
              
                
                
                <li class="nav-dropdown-item">
                  <a
                    class="nav-dropdown-link "
                    
                    href="/categories">
                    Categorías
                  </a>
                </li>
              
            </ul>
          </li>
        
      
      
    </ul>

    <div class="order-1 ml-auto flex items-center md:order-2 lg:ml-0">
      
        
          <button
            aria-label="search"
            
            class="border-border text-dark hover:text-primary dark:border-darkmode-border mr-5 inline-block border-r pr-5 text-xl dark:text-white dark:hover:text-darkmode-primary"
            
            data-target="search-modal">
            <i class="fa-solid fa-search"></i>
          </button>
        
      

      









      


  <div class="theme-switcher mr-5 hidden">
    <input id="theme-switcher" data-theme-switcher type="checkbox" />
    <label for="theme-switcher">
      <span class="sr-only">theme switcher</span>
      <span>
        
        <svg
          class="absolute left-1/2 top-1/2 -translate-x-1/2 -translate-y-1/2 z-10 opacity-100 dark:opacity-0"
          viewBox="0 0 56 56"
          fill="#fff"
          height="16"
          width="16">
          <path
            d="M30 4.6c0-1-.9-2-2-2a2 2 0 0 0-2 2v5c0 1 .9 2 2 2s2-1 2-2Zm9.6 9a2 2 0 0 0 0 2.8c.8.8 2 .8 2.9 0L46 13a2 2 0 0 0 0-2.9 2 2 0 0 0-3 0Zm-26 2.8c.7.8 2 .8 2.8 0 .8-.7.8-2 0-2.9L13 10c-.7-.7-2-.8-2.9 0-.7.8-.7 2.1 0 3ZM28 16a12 12 0 0 0-12 12 12 12 0 0 0 12 12 12 12 0 0 0 12-12 12 12 0 0 0-12-12Zm23.3 14c1.1 0 2-.9 2-2s-.9-2-2-2h-4.9a2 2 0 0 0-2 2c0 1.1 1 2 2 2ZM4.7 26a2 2 0 0 0-2 2c0 1.1.9 2 2 2h4.9c1 0 2-.9 2-2s-1-2-2-2Zm37.8 13.6a2 2 0 0 0-3 0 2 2 0 0 0 0 2.9l3.6 3.5a2 2 0 0 0 2.9 0c.8-.8.8-2.1 0-3ZM10 43.1a2 2 0 0 0 0 2.9c.8.7 2.1.8 3 0l3.4-3.5c.8-.8.8-2.1 0-2.9-.8-.8-2-.8-2.9 0Zm20 3.4c0-1.1-.9-2-2-2a2 2 0 0 0-2 2v4.9c0 1 .9 2 2 2s2-1 2-2Z" />
        </svg>
        
        <svg
          class="absolute left-1/2 top-1/2 -translate-x-1/2 -translate-y-1/2 z-10 opacity-0 dark:opacity-100"
          viewBox="0 0 24 24"
          fill="none"
          height="16"
          width="16">
          <path
            fill="#000"
            fill-rule="evenodd"
            clip-rule="evenodd"
            d="M8.2 2.2c1-.4 2 .6 1.6 1.5-1 3-.4 6.4 1.8 8.7a8.4 8.4 0 0 0 8.7 1.8c1-.3 2 .5 1.5 1.5v.1a10.3 10.3 0 0 1-9.4 6.2A10.3 10.3 0 0 1 3.2 6.7c1-2 2.9-3.5 4.9-4.4Z" />
        </svg>
      </span>
    </label>
  </div>

  
  <script>
    var darkMode = true;

    

    if (localStorage.getItem("theme") === "dark"){darkMode = true}
    else if (localStorage.getItem("theme") === "light"){darkMode = false}

    if (darkMode){document.documentElement.classList.add("dark")}
    else {document.documentElement.classList.remove("dark")}

    
    document.addEventListener("DOMContentLoaded", () => {
      var themeSwitch = document.querySelectorAll("[data-theme-switcher]");
      var themeSwitcherContainer = document.querySelector('.theme-switcher');

      [].forEach.call(themeSwitch, function (ts) {
        ts.checked = darkMode;
        ts.addEventListener("click", () => {
          document.documentElement.classList.toggle("dark");
          localStorage.setItem(
            "theme",
            document.documentElement.classList.contains("dark") ? "dark" : "light"
          );
        });
      });

      
      themeSwitcherContainer.classList.remove('hidden');
    });
  </script>




      
      
    </div>
  </nav>
</header>

    




  
    <div
      class="search-modal "
      aria-hidden="true"
      style="--color-primary: #121212">
      <div data-target="close-search-modal" class="search-modal-overlay"></div>
      <div
        class="search-wrapper"
        data-image="true"
        data-description="true"
        data-tags="true"
        data-categories="true">
        <div class="search-wrapper-header">
          <label for="search-modal-input" style="margin-top:-1px">
            <span class="sr-only">search icon</span>
            <svg
              xmlns="http://www.w3.org/2000/svg"
              viewBox="0 0 512 512"
              height="18"
              width="18"
              class="search-icon"
              data-type="search">
              <path
                fill="currentColor"
                d="M416 208c0 45.9-14.9 88.3-40 122.7L502.6 457.4c12.5 12.5 12.5 32.8 0 45.3s-32.8 12.5-45.3 0L330.7 376c-34.4 25.2-76.8 40-122.7 40C93.1 416 0 322.9 0 208S93.1 0 208 0S416 93.1 416 208zM208 352a144 144 0 1 0 0-288 144 144 0 1 0 0 288z" />
            </svg>
            <svg
              xmlns="http://www.w3.org/2000/svg"
              viewBox="0 0 512 512"
              height="18"
              width="18"
              class="search-reset"
              data-type="reset">
              <path
                fill="currentColor"
                d="M256 512A256 256 0 1 0 256 0a256 256 0 1 0 0 512zM175 175c9.4-9.4 24.6-9.4 33.9 0l47 47 47-47c9.4-9.4 24.6-9.4 33.9 0s9.4 24.6 0 33.9l-47 47 47 47c9.4 9.4 9.4 24.6 0 33.9s-24.6 9.4-33.9 0l-47-47-47 47c-9.4 9.4-24.6 9.4-33.9 0s-9.4-24.6 0-33.9l47-47-47-47c-9.4-9.4-9.4-24.6 0-33.9z" />
            </svg>
          </label>
          <input
            id="search-modal-input"
            type="text"
            data-search-input
            autocomplete="off"
            aria-label="Search"
            placeholder="Busca en un post..." />
        </div>
        <div class="search-wrapper-body">
          <div class="search-result" data-search-result></div>
          <span class="search-result-empty">
            Escribe algo para buscar...
          </span>
        </div>
        <div class="search-wrapper-footer">
          <span>
            <kbd>
              <svg
                xmlns="http://www.w3.org/2000/svg"
                width="14"
                height="14"
                fill="currentColor"
                viewBox="0 0 16 16">
                <path
                  d="M3.204 11h9.592L8 5.519 3.204 11zm-.753-.659 4.796-5.48a1 1 0 0 1 1.506 0l4.796 5.48c.566.647.106 1.659-.753 1.659H3.204a1 1 0 0 1-.753-1.659z" />
              </svg>
            </kbd>
            <kbd>
              <svg
                xmlns="http://www.w3.org/2000/svg"
                width="14"
                height="14"
                fill="currentColor"
                style="margin-top:1px;"
                viewBox="0 0 16 16">
                <path
                  d="M3.204 5h9.592L8 10.481 3.204 5zm-.753.659 4.796 5.48a1 1 0 0 0 1.506 0l4.796-5.48c.566-.647.106-1.659-.753-1.659H3.204a1 1 0 0 0-.753 1.659z" />
              </svg>
            </kbd>
            navegar
          </span>
          <span>
            <kbd>
              <svg
                xmlns="http://www.w3.org/2000/svg"
                width="12"
                height="12"
                fill="currentColor"
                style="display:inline-block;"
                viewBox="0 0 16 16">
                <path
                  fill-rule="evenodd"
                  d="M14.5 1.5a.5.5 0 0 1 .5.5v4.8a2.5 2.5 0 0 1-2.5 2.5H2.707l3.347 3.346a.5.5 0 0 1-.708.708l-4.2-4.2a.5.5 0 0 1 0-.708l4-4a.5.5 0 1 1 .708.708L2.707 8.3H12.5A1.5 1.5 0 0 0 14 6.8V2a.5.5 0 0 1 .5-.5z" />
              </svg>
            </kbd>
            seleccioanr
          </span>
          <span class="search-result-info"></span>
          <span data-target="close-search-modal">
            <kbd>ESC</kbd> cerrar
          </span>
        </div>
      </div>
    </div>
  




    <main>
      
  <section class="section pt-7">
    <div class="container">
      <div class="row justify-center">
        <article class="lg:col-10">
          
          
          <h1 class="h2 mb-4">
            Auditoría de bases de datos
          </h1>
          <ul class="mb-4">
            <li class="mr-4 inline-block">
              <a
                href="/authors/francisco-javier-huete/">
                <i class="fa-regular fa-circle-user mr-2"></i
                >Francisco Javier Huete
              </a>
            </li>
            
            
              <li class="mr-4 inline-block">
                <i class="fa-regular fa-folder mr-2"></i>
                
                  <a
                    href="/categories/administracion-bbdd/"
                    class=""
                    >Administracion bbdd
                  </a>
                
              </li>
            
            <li class="mr-4 inline-block">
              <i class="fa-regular fa-clock mr-2"></i>
              February 17, 2025
            </li>
          </ul>
          <div class="content mb-10">
            

 
  

<details open class="table-of-content blog">
  <summary>
    
      Índice
    
  </summary>
  <nav id="TableOfContents">
  <ol>
    <li><a href="#activa-desde-sqlplus-la-auditoría-de-los-intentos-de-acceso-no-exitosos-al-sistema-comprueba-su-funcionamiento">Activa desde SQL*Plus la auditoría de los intentos de acceso no exitosos al sistema. Comprueba su funcionamiento.</a></li>
    <li><a href="#realiza-un-procedimiento-en-plsql-que-te-muestre-los-accesos-fallidos-junto-con-el-motivo-de-los-mismos-transformando-el-código-de-error-almacenado-en-un-mensaje-de-texto-comprensible-contempla-todos-los-motivos-posibles-para-que-un-acceso-sea-fallido">Realiza un procedimiento en PL/SQL que te muestre los accesos fallidos junto con el motivo de los mismos, transformando el código de error almacenado en un mensaje de texto comprensible. Contempla todos los motivos posibles para que un acceso sea fallido.</a></li>
    <li><a href="#activa-la-auditoría-de-las-operaciones-dml-realizadas-por-el-usuario-prueba-en-tablas-de-su-esquema-comprueba-su-funcionamiento">Activa la auditoría de las operaciones DML realizadas por el usuario Prueba en tablas de su esquema. Comprueba su funcionamiento.</a></li>
    <li><a href="#realiza-una-auditoría-de-grano-fino-para-almacenar-información-sobre-la-inserción-de-empleados-con-comisión-en-la-tabla-emp-de-scott">Realiza una auditoría de grano fino para almacenar información sobre la inserción de empleados con comisión en la tabla emp de Scott.</a></li>
    <li><a href="#explica-la-diferencia-entre-auditar-una-operación-by-access-o-by-session-ilustrándolo-con-ejemplos">Explica la diferencia entre auditar una operación by access o by session ilustrándolo con ejemplos.</a></li>
    <li><a href="#documenta-las-diferencias-entre-los-valores-db-y-db-extended-del-parámetro-audit_trail-de-oracle-demuéstralas-poniendo-un-ejemplo-de-la-información-sobre-una-operación-concreta-recopilada-con-cada-uno-de-ellos">Documenta las diferencias entre los valores db y db, extended del parámetro audit_trail de ORACLE. Demuéstralas poniendo un ejemplo de la información sobre una operación concreta recopilada con cada uno de ellos.</a></li>
    <li><a href="#averigua-si-en-postgres-se-pueden-realizar-los-cuatro-primeros-apartados-si-es-así-documenta-el-proceso-adecuadamente">Averigua si en Postgres se pueden realizar los cuatro primeros apartados. Si es así, documenta el proceso adecuadamente.</a>
      <ol>
        <li><a href="#auditar-los-intentos-de-acceso-fallidos">Auditar los intentos de acceso fallidos</a></li>
        <li><a href="#procedimiento-plpgsql-que-muestre-los-accesos-fallidos">Procedimiento PL/pgSQL que muestre los accesos fallidos</a></li>
        <li><a href="#auditar-las-operaciones-dml-realizadas-por-un-usuario-sobre-tablas-de-su-esquema">Auditar las operaciones DML realizadas por un usuario sobre tablas de su esquema</a></li>
        <li><a href="#auditoría-de-grano-fino-sobre-la-inserción-de-empleados-con-comisión-en-la-tabla-emp-de-scott">Auditoría de grano fino sobre la inserción de empleados con comisión en la tabla emp de Scott</a></li>
      </ol>
    </li>
    <li><a href="#averigua-si-en-mysql-se-pueden-realizar-los-apartados-1-3-y-4-si-es-así-documenta-el-proceso-adecuadamente">Averigua si en MySQL se pueden realizar los apartados 1, 3 y 4. Si es así, documenta el proceso adecuadamente.</a>
      <ol>
        <li><a href="#auditar-los-intentos-de-acceso-fallidos-1">Auditar los intentos de acceso fallidos</a></li>
        <li><a href="#auditoría-de-operaciones-dml-realizadas-por-un-usuario-sobre-tablas-de-su-esquema">Auditoría de operaciones DML realizadas por un usuario sobre tablas de su esquema</a></li>
        <li><a href="#auditoría-de-grano-fino-sobre-la-inserción-de-empleados-con-comisión-en-la-tabla-emp-de-scott-1">Auditoría de grano fino sobre la inserción de empleados con comisión en la tabla emp de Scott</a></li>
      </ol>
    </li>
    <li><a href="#averigua-las-posibilidades-que-ofrece-mongodb-para-auditar-los-cambios-que-va-sufriendo-un-documento-demuestra-su-funcionamiento">Averigua las posibilidades que ofrece MongoDB para auditar los cambios que va sufriendo un documento. Demuestra su funcionamiento.</a></li>
    <li><a href="#averigua-si-en-mongodb-se-pueden-auditar-los-accesos-a-una-colección-concreta-demuestra-su-funcionamiento">Averigua si en MongoDB se pueden auditar los accesos a una colección concreta. Demuestra su funcionamiento.</a></li>
    <li><a href="#averigua-si-en-cassandra-se-pueden-auditar-las-inserciones-de-datos">Averigua si en Cassandra se pueden auditar las inserciones de datos.</a></li>
    <li><a href="#fuentes">Fuentes</a></li>
  </ol>
</nav>
</details>

            <p>En este post se recogen algunos ejemplos prácticos de auditoría en bases de datos instaladas en distintos sistemas gestores tanto relacionales como no relacionales.</p>
<h1 id="activa-desde-sqlplus-la-auditoría-de-los-intentos-de-acceso-no-exitosos-al-sistema-comprueba-su-funcionamiento">Activa desde SQL*Plus la auditoría de los intentos de acceso no exitosos al sistema. Comprueba su funcionamiento.</h1>
<p>Para activar cualquier tipo de auditoría en la base de datos hay que comprobar primero que la auditoría está habilitada.</p>
<div class="highlight"><pre tabindex="0" style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-SQL" data-lang="SQL"><span style="display:flex;"><span><span style="color:#6ab825;font-weight:bold">SQL</span>&gt;<span style="color:#666"> </span><span style="color:#6ab825;font-weight:bold">show</span><span style="color:#666"> </span><span style="color:#6ab825;font-weight:bold">parameter</span><span style="color:#666"> </span>audit;<span style="color:#666">
</span></span></span><span style="display:flex;"><span><span style="color:#666">
</span></span></span><span style="display:flex;"><span><span style="color:#666"></span>NAME<span style="color:#666">				     </span><span style="color:#6ab825;font-weight:bold">TYPE</span><span style="color:#666">
</span></span></span><span style="display:flex;"><span><span style="color:#666"></span><span style="color:#999;font-style:italic">------------------------------------ ---------------------------------
</span></span></span><span style="display:flex;"><span><span style="color:#999;font-style:italic"></span>VALUE<span style="color:#666">
</span></span></span><span style="display:flex;"><span><span style="color:#666"></span><span style="color:#999;font-style:italic">------------------------------
</span></span></span><span style="display:flex;"><span><span style="color:#999;font-style:italic"></span>audit_file_dest<span style="color:#666"> 		     </span>string<span style="color:#666">
</span></span></span><span style="display:flex;"><span><span style="color:#666"></span>/opt/oracle/<span style="color:#6ab825;font-weight:bold">admin</span>/ORCLCDB/adum<span style="color:#666">
</span></span></span><span style="display:flex;"><span><span style="color:#666"></span>p<span style="color:#666">
</span></span></span><span style="display:flex;"><span><span style="color:#666"></span>audit_syslog_level<span style="color:#666">		     </span>string<span style="color:#666">
</span></span></span><span style="display:flex;"><span><span style="color:#666">
</span></span></span><span style="display:flex;"><span><span style="color:#666"></span>audit_sys_operations<span style="color:#666">		     </span><span style="color:#24909d">boolean</span><span style="color:#666">
</span></span></span><span style="display:flex;"><span><span style="color:#666"></span><span style="color:#6ab825;font-weight:bold">TRUE</span><span style="color:#666">
</span></span></span><span style="display:flex;"><span><span style="color:#666"></span>audit_trail<span style="color:#666">			     </span>string<span style="color:#666">
</span></span></span><span style="display:flex;"><span><span style="color:#666"></span>DB<span style="color:#666">
</span></span></span><span style="display:flex;"><span><span style="color:#666">
</span></span></span><span style="display:flex;"><span><span style="color:#666"></span>NAME<span style="color:#666">				     </span><span style="color:#6ab825;font-weight:bold">TYPE</span><span style="color:#666">
</span></span></span><span style="display:flex;"><span><span style="color:#666"></span><span style="color:#999;font-style:italic">------------------------------------ ---------------------------------
</span></span></span><span style="display:flex;"><span><span style="color:#999;font-style:italic"></span>VALUE<span style="color:#666">
</span></span></span><span style="display:flex;"><span><span style="color:#666"></span><span style="color:#999;font-style:italic">------------------------------
</span></span></span><span style="display:flex;"><span><span style="color:#999;font-style:italic"></span>unified_audit_common_systemlog<span style="color:#666">	     </span>string<span style="color:#666">
</span></span></span><span style="display:flex;"><span><span style="color:#666">
</span></span></span><span style="display:flex;"><span><span style="color:#666"></span>unified_audit_systemlog<span style="color:#666"> 	     </span>string<span style="color:#666">
</span></span></span></code></pre></div><p>El parámetro <code>audit_trail</code> tiene el valor <code>DB</code>, lo que significa que en esta instancia de Oracle, la auditoría está habilitada.</p>
<p>Con la orden <code>AUDIT</code> se puede activar la auditoría para los intentos de inicio de sesión que no tiene éxito.</p>
<div class="highlight"><pre tabindex="0" style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-SQL" data-lang="SQL"><span style="display:flex;"><span><span style="color:#6ab825;font-weight:bold">SQL</span>&gt;<span style="color:#666"> </span>AUDIT<span style="color:#666"> </span><span style="color:#6ab825;font-weight:bold">CREATE</span><span style="color:#666"> </span><span style="color:#6ab825;font-weight:bold">SESSION</span><span style="color:#666"> </span><span style="color:#6ab825;font-weight:bold">WHENEVER</span><span style="color:#666"> </span><span style="color:#6ab825;font-weight:bold">NOT</span><span style="color:#666"> </span>SUCCESSFUL;<span style="color:#666">
</span></span></span><span style="display:flex;"><span><span style="color:#666">
</span></span></span><span style="display:flex;"><span><span style="color:#666"></span>Auditoría<span style="color:#666"> </span>terminada<span style="color:#666"> </span>correctamente.<span style="color:#666">
</span></span></span></code></pre></div><p>En la vista del diccionario de datos <code>DBA_PRIV_AUDIT_OPTS</code> se almacena la información sobre las auditorías activas en la base de datos.</p>
<div class="highlight"><pre tabindex="0" style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-sql" data-lang="sql"><span style="display:flex;"><span><span style="color:#6ab825;font-weight:bold">SQL</span>&gt;<span style="color:#666"> </span><span style="color:#6ab825;font-weight:bold">SELECT</span><span style="color:#666"> </span>*<span style="color:#666"> </span><span style="color:#6ab825;font-weight:bold">FROM</span><span style="color:#666"> </span>DBA_PRIV_AUDIT_OPTS;<span style="color:#666">
</span></span></span><span style="display:flex;"><span><span style="color:#666">
</span></span></span><span style="display:flex;"><span><span style="color:#666"></span>USER_NAME<span style="color:#666">
</span></span></span><span style="display:flex;"><span><span style="color:#666"></span><span style="color:#999;font-style:italic">--------------------------------------------------------------------------------
</span></span></span><span style="display:flex;"><span><span style="color:#999;font-style:italic"></span>PROXY_NAME<span style="color:#666">
</span></span></span><span style="display:flex;"><span><span style="color:#666"></span><span style="color:#999;font-style:italic">--------------------------------------------------------------------------------
</span></span></span><span style="display:flex;"><span><span style="color:#999;font-style:italic"></span>PRIVILEGE<span style="color:#666">
</span></span></span><span style="display:flex;"><span><span style="color:#666"></span><span style="color:#999;font-style:italic">--------------------------------------------------------------------------------
</span></span></span><span style="display:flex;"><span><span style="color:#999;font-style:italic"></span>SUCCESS<span style="color:#666"> 		       </span>FAILURE<span style="color:#666">
</span></span></span><span style="display:flex;"><span><span style="color:#666"></span><span style="color:#999;font-style:italic">------------------------------ ------------------------------
</span></span></span><span style="display:flex;"><span><span style="color:#999;font-style:italic"></span><span style="color:#666">
</span></span></span><span style="display:flex;"><span><span style="color:#666">
</span></span></span><span style="display:flex;"><span><span style="color:#666"></span><span style="color:#6ab825;font-weight:bold">CREATE</span><span style="color:#666"> </span><span style="color:#6ab825;font-weight:bold">SESSION</span><span style="color:#666">
</span></span></span><span style="display:flex;"><span><span style="color:#666"></span><span style="color:#6ab825;font-weight:bold">NOT</span><span style="color:#666"> </span><span style="color:#6ab825;font-weight:bold">SET</span><span style="color:#666"> 		       </span><span style="color:#6ab825;font-weight:bold">BY</span><span style="color:#666"> </span><span style="color:#6ab825;font-weight:bold">ACCESS</span><span style="color:#666">
</span></span></span></code></pre></div><p>Para comprobar el funcionamiento de la auditoría hay que generar un inicio de sesión fallido.</p>
<div class="highlight"><pre tabindex="0" style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-sql" data-lang="sql"><span style="display:flex;"><span><span style="color:#6ab825;font-weight:bold">SQL</span>&gt;<span style="color:#666"> </span><span style="color:#6ab825;font-weight:bold">connect</span><span style="color:#666"> </span>scott/scott<span style="color:#666">
</span></span></span><span style="display:flex;"><span><span style="color:#666"></span>ERROR:<span style="color:#666">
</span></span></span><span style="display:flex;"><span><span style="color:#666"></span>ORA-<span style="color:#3677a9">01017</span>:<span style="color:#666"> </span>invalid<span style="color:#666"> </span>username/password;<span style="color:#666"> </span>logon<span style="color:#666"> </span>denied<span style="color:#666">
</span></span></span><span style="display:flex;"><span><span style="color:#666">
</span></span></span><span style="display:flex;"><span><span style="color:#666">
</span></span></span><span style="display:flex;"><span><span style="color:#666"></span>Advertencia:<span style="color:#666"> </span><span style="color:#a61717;background-color:#e3d2d2">¡</span>Ya<span style="color:#666"> </span><span style="color:#6ab825;font-weight:bold">no</span><span style="color:#666"> </span>está<span style="color:#666"> </span>conectado<span style="color:#666"> </span>a<span style="color:#666"> </span>ORACLE!<span style="color:#666">
</span></span></span></code></pre></div><p>La información sobre las acciones auditadas se encuentra en la vista del diccionario de datos <code>DBA_AUDIT_SESSION</code>.</p>
<div class="highlight"><pre tabindex="0" style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-sql" data-lang="sql"><span style="display:flex;"><span><span style="color:#6ab825;font-weight:bold">SQL</span>&gt;<span style="color:#666"> </span><span style="color:#6ab825;font-weight:bold">SELECT</span><span style="color:#666"> </span>USERNAME,<span style="color:#666"> </span><span style="color:#6ab825;font-weight:bold">TIMESTAMP</span>,<span style="color:#666"> </span>ACTION_NAME<span style="color:#666"> </span><span style="color:#6ab825;font-weight:bold">FROM</span><span style="color:#666"> </span>DBA_AUDIT_SESSION;<span style="color:#666">
</span></span></span><span style="display:flex;"><span><span style="color:#666">
</span></span></span><span style="display:flex;"><span><span style="color:#666"></span>USERNAME<span style="color:#666">
</span></span></span><span style="display:flex;"><span><span style="color:#666"></span><span style="color:#999;font-style:italic">--------------------------------------------------------------------------------
</span></span></span><span style="display:flex;"><span><span style="color:#999;font-style:italic"></span>TIMESTAM<span style="color:#666">
</span></span></span><span style="display:flex;"><span><span style="color:#666"></span><span style="color:#999;font-style:italic">--------
</span></span></span><span style="display:flex;"><span><span style="color:#999;font-style:italic"></span>ACTION_NAME<span style="color:#666">
</span></span></span><span style="display:flex;"><span><span style="color:#666"></span><span style="color:#999;font-style:italic">--------------------------------------------------------------------------------
</span></span></span><span style="display:flex;"><span><span style="color:#999;font-style:italic"></span>SCOTT<span style="color:#666">
</span></span></span><span style="display:flex;"><span><span style="color:#666"></span><span style="color:#3677a9">16</span>/<span style="color:#3677a9">02</span>/<span style="color:#3677a9">25</span><span style="color:#666">
</span></span></span><span style="display:flex;"><span><span style="color:#666"></span>LOGON<span style="color:#666">
</span></span></span></code></pre></div><h1 id="realiza-un-procedimiento-en-plsql-que-te-muestre-los-accesos-fallidos-junto-con-el-motivo-de-los-mismos-transformando-el-código-de-error-almacenado-en-un-mensaje-de-texto-comprensible-contempla-todos-los-motivos-posibles-para-que-un-acceso-sea-fallido">Realiza un procedimiento en PL/SQL que te muestre los accesos fallidos junto con el motivo de los mismos, transformando el código de error almacenado en un mensaje de texto comprensible. Contempla todos los motivos posibles para que un acceso sea fallido.</h1>
<div class="highlight"><pre tabindex="0" style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-SQL" data-lang="SQL"><span style="display:flex;"><span><span style="color:#6ab825;font-weight:bold">SQL</span>&gt;<span style="color:#666"> </span><span style="color:#6ab825;font-weight:bold">CREATE</span><span style="color:#666"> </span><span style="color:#6ab825;font-weight:bold">OR</span><span style="color:#666"> </span><span style="color:#6ab825;font-weight:bold">REPLACE</span><span style="color:#666"> </span><span style="color:#6ab825;font-weight:bold">FUNCTION</span><span style="color:#666"> </span>BuscarCodigo<span style="color:#666"> </span>(p_RETURNCODE<span style="color:#666"> 
</span></span></span><span style="display:flex;"><span><span style="color:#666"></span>DBA_AUDIT_SESSION.RETURNCODE%<span style="color:#6ab825;font-weight:bold">TYPE</span>)<span style="color:#666">
</span></span></span><span style="display:flex;"><span><span style="color:#666"></span><span style="color:#6ab825;font-weight:bold">RETURN</span><span style="color:#666"> </span>VARCHAR2<span style="color:#666">
</span></span></span><span style="display:flex;"><span><span style="color:#666"></span><span style="color:#6ab825;font-weight:bold">AS</span><span style="color:#666">
</span></span></span><span style="display:flex;"><span><span style="color:#666">    </span>v_error<span style="color:#666"> </span>VARCHAR2(<span style="color:#3677a9">50</span>);<span style="color:#666">
</span></span></span><span style="display:flex;"><span><span style="color:#666"></span><span style="color:#6ab825;font-weight:bold">BEGIN</span><span style="color:#666">
</span></span></span><span style="display:flex;"><span><span style="color:#666">    </span><span style="color:#6ab825;font-weight:bold">CASE</span><span style="color:#666"> </span>p_RETURNCODE<span style="color:#666">
</span></span></span><span style="display:flex;"><span><span style="color:#666">        </span><span style="color:#6ab825;font-weight:bold">WHEN</span><span style="color:#666"> </span><span style="color:#3677a9">01017</span><span style="color:#666"> </span><span style="color:#6ab825;font-weight:bold">THEN</span><span style="color:#666">
</span></span></span><span style="display:flex;"><span><span style="color:#666">            </span>v_error<span style="color:#666"> </span>:=<span style="color:#666"> </span><span style="color:#ed9d13">&#39;Usuario o contraseña incorrectos&#39;</span>;<span style="color:#666">
</span></span></span><span style="display:flex;"><span><span style="color:#666">        </span><span style="color:#6ab825;font-weight:bold">WHEN</span><span style="color:#666"> </span><span style="color:#3677a9">28000</span><span style="color:#666"> </span><span style="color:#6ab825;font-weight:bold">THEN</span><span style="color:#666">
</span></span></span><span style="display:flex;"><span><span style="color:#666">            </span>v_error<span style="color:#666"> </span>:=<span style="color:#666"> </span><span style="color:#ed9d13">&#39;Cuenta bloqueada&#39;</span>;<span style="color:#666">
</span></span></span><span style="display:flex;"><span><span style="color:#666">        </span><span style="color:#6ab825;font-weight:bold">WHEN</span><span style="color:#666"> </span><span style="color:#3677a9">28001</span><span style="color:#666"> </span><span style="color:#6ab825;font-weight:bold">THEN</span><span style="color:#666">
</span></span></span><span style="display:flex;"><span><span style="color:#666">            </span>v_error<span style="color:#666"> </span>:=<span style="color:#666"> </span><span style="color:#ed9d13">&#39;Contraseña caducada&#39;</span>;<span style="color:#666">
</span></span></span><span style="display:flex;"><span><span style="color:#666">        </span><span style="color:#6ab825;font-weight:bold">WHEN</span><span style="color:#666"> </span><span style="color:#3677a9">28009</span><span style="color:#666"> </span><span style="color:#6ab825;font-weight:bold">THEN</span><span style="color:#666">
</span></span></span><span style="display:flex;"><span><span style="color:#666">            </span>v_error<span style="color:#666"> </span>:=<span style="color:#666"> </span><span style="color:#ed9d13">&#39;La conexión como SYS tiene que ser con SYSDBA o SYSOPER&#39;</span>;<span style="color:#666">
</span></span></span><span style="display:flex;"><span><span style="color:#666">        </span><span style="color:#6ab825;font-weight:bold">WHEN</span><span style="color:#666"> </span><span style="color:#3677a9">28011</span><span style="color:#666"> </span><span style="color:#6ab825;font-weight:bold">THEN</span><span style="color:#666">
</span></span></span><span style="display:flex;"><span><span style="color:#666">            </span>v_error<span style="color:#666"> </span>:=<span style="color:#666"> </span><span style="color:#ed9d13">&#39;Contraseña caducada&#39;</span>;<span style="color:#666">
</span></span></span><span style="display:flex;"><span><span style="color:#666">        </span><span style="color:#6ab825;font-weight:bold">WHEN</span><span style="color:#666"> </span><span style="color:#3677a9">01005</span><span style="color:#666"> </span><span style="color:#6ab825;font-weight:bold">THEN</span><span style="color:#666">
</span></span></span><span style="display:flex;"><span><span style="color:#666">            </span>v_error<span style="color:#666"> </span>:=<span style="color:#666"> </span><span style="color:#ed9d13">&#39;No se ha indicado ninguna contraseña&#39;</span>;<span style="color:#666">
</span></span></span><span style="display:flex;"><span><span style="color:#666">        </span><span style="color:#6ab825;font-weight:bold">WHEN</span><span style="color:#666"> </span><span style="color:#3677a9">01034</span><span style="color:#666"> </span><span style="color:#6ab825;font-weight:bold">THEN</span><span style="color:#666">
</span></span></span><span style="display:flex;"><span><span style="color:#666">            </span>v_error<span style="color:#666"> </span>:=<span style="color:#666"> </span><span style="color:#ed9d13">&#39;La instancia de Oracle no se está ejecutando&#39;</span>;<span style="color:#666">
</span></span></span><span style="display:flex;"><span><span style="color:#666">        </span><span style="color:#6ab825;font-weight:bold">WHEN</span><span style="color:#666"> </span><span style="color:#3677a9">27101</span><span style="color:#666"> </span><span style="color:#6ab825;font-weight:bold">THEN</span><span style="color:#666">
</span></span></span><span style="display:flex;"><span><span style="color:#666">            </span>v_error<span style="color:#666"> </span>:=<span style="color:#666"> </span><span style="color:#ed9d13">&#39;No existe el área de memoria compartida&#39;</span>;<span style="color:#666">
</span></span></span><span style="display:flex;"><span><span style="color:#666">    </span><span style="color:#6ab825;font-weight:bold">END</span><span style="color:#666"> </span><span style="color:#6ab825;font-weight:bold">CASE</span>;<span style="color:#666">
</span></span></span><span style="display:flex;"><span><span style="color:#666">    </span><span style="color:#6ab825;font-weight:bold">RETURN</span><span style="color:#666"> </span>v_error;<span style="color:#666">
</span></span></span><span style="display:flex;"><span><span style="color:#666"></span><span style="color:#6ab825;font-weight:bold">END</span>;<span style="color:#666">
</span></span></span><span style="display:flex;"><span><span style="color:#666"></span>/<span style="color:#666">
</span></span></span><span style="display:flex;"><span><span style="color:#666">
</span></span></span><span style="display:flex;"><span><span style="color:#666"></span>Función<span style="color:#666"> </span>creada.<span style="color:#666">
</span></span></span><span style="display:flex;"><span><span style="color:#666">
</span></span></span><span style="display:flex;"><span><span style="color:#666"></span><span style="color:#6ab825;font-weight:bold">SQL</span>&gt;<span style="color:#666"> </span><span style="color:#6ab825;font-weight:bold">CREATE</span><span style="color:#666"> </span><span style="color:#6ab825;font-weight:bold">OR</span><span style="color:#666"> </span><span style="color:#6ab825;font-weight:bold">REPLACE</span><span style="color:#666"> </span><span style="color:#6ab825;font-weight:bold">PROCEDURE</span><span style="color:#666"> </span>AccesosFallidos<span style="color:#666">
</span></span></span><span style="display:flex;"><span><span style="color:#666"></span><span style="color:#6ab825;font-weight:bold">AS</span><span style="color:#666">
</span></span></span><span style="display:flex;"><span><span style="color:#666">    </span><span style="color:#6ab825;font-weight:bold">CURSOR</span><span style="color:#666"> </span>c_accesos<span style="color:#666">
</span></span></span><span style="display:flex;"><span><span style="color:#666">    </span><span style="color:#6ab825;font-weight:bold">IS</span><span style="color:#666">
</span></span></span><span style="display:flex;"><span><span style="color:#666">    </span><span style="color:#6ab825;font-weight:bold">SELECT</span><span style="color:#666"> </span>USERNAME,<span style="color:#666"> </span><span style="color:#6ab825;font-weight:bold">TIMESTAMP</span>,<span style="color:#666"> </span>ACTION_NAME,<span style="color:#666"> </span>RETURNCODE<span style="color:#666">
</span></span></span><span style="display:flex;"><span><span style="color:#666">    </span><span style="color:#6ab825;font-weight:bold">FROM</span><span style="color:#666"> </span>DBA_AUDIT_SESSION<span style="color:#666">
</span></span></span><span style="display:flex;"><span><span style="color:#666">    </span><span style="color:#6ab825;font-weight:bold">WHERE</span><span style="color:#666"> </span>ACTION_NAME<span style="color:#666"> </span>=<span style="color:#666"> </span><span style="color:#ed9d13">&#39;LOGON&#39;</span><span style="color:#666"> 
</span></span></span><span style="display:flex;"><span><span style="color:#666">    </span><span style="color:#6ab825;font-weight:bold">AND</span><span style="color:#666"> </span>RETURNCODE<span style="color:#666"> </span>!=<span style="color:#666"> </span><span style="color:#3677a9">0</span>;<span style="color:#666">
</span></span></span><span style="display:flex;"><span><span style="color:#666">    </span>v_error<span style="color:#666"> </span>VARCHAR2(<span style="color:#3677a9">50</span>);<span style="color:#666">
</span></span></span><span style="display:flex;"><span><span style="color:#666"></span><span style="color:#6ab825;font-weight:bold">BEGIN</span><span style="color:#666">
</span></span></span><span style="display:flex;"><span><span style="color:#666">    </span>DBMS_OUTPUT.PUT_LINE(RPAD(<span style="color:#ed9d13">&#39;USUARIO&#39;</span>,<span style="color:#3677a9">10</span>,<span style="color:#ed9d13">&#39; &#39;</span>)||RPAD(<span style="color:#ed9d13">&#39;FECHA/HORA&#39;</span>,<span style="color:#3677a9">20</span>,<span style="color:#ed9d13">&#39; &#39;</span>)||RPAD(<span style="color:#ed9d13">&#39;ERROR&#39;</span>,<span style="color:#3677a9">50</span>,<span style="color:#ed9d13">&#39; &#39;</span>));<span style="color:#666">
</span></span></span><span style="display:flex;"><span><span style="color:#666">    </span>DBMS_OUTPUT.PUT_LINE(RPAD(<span style="color:#ed9d13">&#39;-&#39;</span>,<span style="color:#3677a9">80</span>,<span style="color:#ed9d13">&#39;-&#39;</span>));<span style="color:#666">
</span></span></span><span style="display:flex;"><span><span style="color:#666">    </span><span style="color:#6ab825;font-weight:bold">FOR</span><span style="color:#666"> </span>v_acceso<span style="color:#666"> </span><span style="color:#6ab825;font-weight:bold">IN</span><span style="color:#666"> </span>c_accesos<span style="color:#666"> </span>LOOP<span style="color:#666">
</span></span></span><span style="display:flex;"><span><span style="color:#666">        </span>v_error:=BuscarCodigo(v_acceso.RETURNCODE);<span style="color:#666">
</span></span></span><span style="display:flex;"><span><span style="color:#666">        </span>DBMS_OUTPUT.PUT_LINE(RPAD(v_acceso.USERNAME,<span style="color:#3677a9">10</span>,<span style="color:#ed9d13">&#39; &#39;</span>)||RPAD(TO_CHAR(v_acceso.<span style="color:#6ab825;font-weight:bold">TIMESTAMP</span>,<span style="color:#ed9d13">&#39;DD/MM/YY HH24:MI&#39;</span>),<span style="color:#3677a9">20</span>,<span style="color:#ed9d13">&#39; &#39;</span>)||RPAD(v_error,<span style="color:#666"> </span><span style="color:#3677a9">50</span>,<span style="color:#ed9d13">&#39; &#39;</span>));<span style="color:#666">
</span></span></span><span style="display:flex;"><span><span style="color:#666">    </span><span style="color:#6ab825;font-weight:bold">END</span><span style="color:#666"> </span>LOOP;<span style="color:#666">
</span></span></span><span style="display:flex;"><span><span style="color:#666"></span><span style="color:#6ab825;font-weight:bold">END</span>;<span style="color:#666">
</span></span></span><span style="display:flex;"><span><span style="color:#666"></span>/<span style="color:#666">
</span></span></span><span style="display:flex;"><span><span style="color:#666">
</span></span></span><span style="display:flex;"><span><span style="color:#666"></span>Procedimiento<span style="color:#666"> </span>creado.<span style="color:#666">
</span></span></span></code></pre></div>


  





  


<div class="notice info">
  <div class="notice-head"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" width="22" height="22">
        <path stroke-linecap="round" stroke-linejoin="round" d="m11.25 11.25.041-.02a.75.75 0 0 1 1.063.852l-.708 2.836a.75.75 0 0 0 1.063.853l.041-.021M21 12a9 9 0 1 1-18 0 9 9 0 0 1 18 0Zm-9-3.75h.008v.008H12V8.25Z" />
      </svg><p>Info</p>
  </div>
  <div class="notice-body"><p>Aunque para comprobar el correcto funcionamiento del procedimiento se han replicado la mayor parte de los errores de acceso que se recogen en la función, algunos de ellos como el error ORA-1005, el error ORA-1034, el error ORA-28009 y el error ORA-27101 no se registran en la vista <code>DBA_AUDIT_SESSION</code> del diccionario de datos de Oracle. En el caso de los errores ORA-1034 y ORA-27101 esto se explica porque se producen al intentar iniciar sesión cuando la instancia de Oracle no está en funcionamiento y, por tanto, no puede registrar este intento de acceso fallido en la vista de auditoría.</p></div>
</div>

<div class="highlight"><pre tabindex="0" style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash-session" data-lang="bash-session"><span style="display:flex;"><span><span style="color:#ccc">debian@bbdd:~$ sqlplus
</span></span></span><span style="display:flex;"><span><span style="color:#ccc"></span><span style="color:#a61717;background-color:#e3d2d2">
</span></span></span><span style="display:flex;"><span><span style="color:#a61717;background-color:#e3d2d2"></span><span style="color:#ccc">SQL*Plus: Release 21.0.0.0.0 - Production on Mar Feb 18 18:04:53 2025
</span></span></span><span style="display:flex;"><span><span style="color:#ccc">Version 21.3.0.0.0
</span></span></span><span style="display:flex;"><span><span style="color:#ccc"></span><span style="color:#a61717;background-color:#e3d2d2">
</span></span></span><span style="display:flex;"><span><span style="color:#a61717;background-color:#e3d2d2"></span><span style="color:#ccc">Copyright (c) 1982, 2021, Oracle.  All rights reserved.
</span></span></span><span style="display:flex;"><span><span style="color:#ccc"></span><span style="color:#a61717;background-color:#e3d2d2">
</span></span></span><span style="display:flex;"><span><span style="color:#a61717;background-color:#e3d2d2"></span><span style="color:#ccc">Introduzca el nombre de usuario: scott
</span></span></span><span style="display:flex;"><span><span style="color:#ccc">Introduzca la contraseña: 
</span></span></span><span style="display:flex;"><span><span style="color:#ccc"></span><span style="color:#a61717;background-color:#e3d2d2">
</span></span></span><span style="display:flex;"><span><span style="color:#a61717;background-color:#e3d2d2"></span><span style="color:#ccc">ERROR:
</span></span></span><span style="display:flex;"><span><span style="color:#ccc">ORA-01005: se ha proporcionado una contraseña nula; conexión denegada
</span></span></span></code></pre></div><div class="highlight"><pre tabindex="0" style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash-session" data-lang="bash-session"><span style="display:flex;"><span><span style="color:#ccc">debian@bbdd:~$ sqlplus scott/tiger
</span></span></span><span style="display:flex;"><span><span style="color:#ccc"></span><span style="color:#a61717;background-color:#e3d2d2">
</span></span></span><span style="display:flex;"><span><span style="color:#a61717;background-color:#e3d2d2"></span><span style="color:#ccc">SQL*Plus: Release 21.0.0.0.0 - Production on Mar Feb 18 18:05:49 2025
</span></span></span><span style="display:flex;"><span><span style="color:#ccc">Version 21.3.0.0.0
</span></span></span><span style="display:flex;"><span><span style="color:#ccc"></span><span style="color:#a61717;background-color:#e3d2d2">
</span></span></span><span style="display:flex;"><span><span style="color:#a61717;background-color:#e3d2d2"></span><span style="color:#ccc">Copyright (c) 1982, 2021, Oracle.  All rights reserved.
</span></span></span><span style="display:flex;"><span><span style="color:#ccc"></span><span style="color:#a61717;background-color:#e3d2d2">
</span></span></span><span style="display:flex;"><span><span style="color:#a61717;background-color:#e3d2d2"></span><span style="color:#ccc">ERROR:
</span></span></span><span style="display:flex;"><span><span style="color:#ccc">ORA-01034: ORACLE not available
</span></span></span><span style="display:flex;"><span><span style="color:#ccc">ORA-27101: shared memory realm does not exist
</span></span></span><span style="display:flex;"><span><span style="color:#ccc">Linux-x86_64 Error: 2: No such file or directory
</span></span></span><span style="display:flex;"><span><span style="color:#ccc">Additional information: 4775
</span></span></span><span style="display:flex;"><span><span style="color:#ccc">Additional information: -718068697
</span></span></span><span style="display:flex;"><span><span style="color:#ccc">Identificador de Proceso: 0
</span></span></span><span style="display:flex;"><span><span style="color:#ccc">Identificador de Sesión: 0 Número de Serie: 0
</span></span></span></code></pre></div><div class="highlight"><pre tabindex="0" style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash-session" data-lang="bash-session"><span style="display:flex;"><span><span style="color:#ccc">debian@bbdd:~$ sqlplus sys/sys
</span></span></span><span style="display:flex;"><span><span style="color:#ccc"></span><span style="color:#a61717;background-color:#e3d2d2">
</span></span></span><span style="display:flex;"><span><span style="color:#a61717;background-color:#e3d2d2"></span><span style="color:#ccc">SQL*Plus: Release 21.0.0.0.0 - Production on Mar Feb 18 18:06:58 2025
</span></span></span><span style="display:flex;"><span><span style="color:#ccc">Version 21.3.0.0.0
</span></span></span><span style="display:flex;"><span><span style="color:#ccc"></span><span style="color:#a61717;background-color:#e3d2d2">
</span></span></span><span style="display:flex;"><span><span style="color:#a61717;background-color:#e3d2d2"></span><span style="color:#ccc">Copyright (c) 1982, 2021, Oracle.  All rights reserved.
</span></span></span><span style="display:flex;"><span><span style="color:#ccc"></span><span style="color:#a61717;background-color:#e3d2d2">
</span></span></span><span style="display:flex;"><span><span style="color:#a61717;background-color:#e3d2d2"></span><span style="color:#ccc">ERROR:
</span></span></span><span style="display:flex;"><span><span style="color:#ccc">ORA-28009: connection as SYS should be as SYSDBA or SYSOPER
</span></span></span></code></pre></div><div class="highlight"><pre tabindex="0" style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-SQL" data-lang="SQL"><span style="display:flex;"><span><span style="color:#6ab825;font-weight:bold">SQL</span>&gt;<span style="color:#666"> </span><span style="color:#6ab825;font-weight:bold">EXEC</span><span style="color:#666"> </span>ACCESOSFALLIDOS;<span style="color:#666">
</span></span></span><span style="display:flex;"><span><span style="color:#666"></span>USUARIO<span style="color:#666">   </span>FECHA/HORA<span style="color:#666">	        </span>ERROR<span style="color:#666">
</span></span></span><span style="display:flex;"><span><span style="color:#666"></span><span style="color:#999;font-style:italic">--------------------------------------------------------------------------------
</span></span></span><span style="display:flex;"><span><span style="color:#999;font-style:italic"></span>SCOTT<span style="color:#666">     </span><span style="color:#3677a9">16</span>/<span style="color:#3677a9">02</span>/<span style="color:#3677a9">25</span><span style="color:#666"> </span><span style="color:#3677a9">16</span>:<span style="color:#3677a9">43</span><span style="color:#666">      </span>Usuario<span style="color:#666"> </span>o<span style="color:#666"> </span>contraseña<span style="color:#666"> </span>incorrectos<span style="color:#666">
</span></span></span><span style="display:flex;"><span><span style="color:#666"></span>SCOTT<span style="color:#666">	    </span><span style="color:#3677a9">16</span>/<span style="color:#3677a9">02</span>/<span style="color:#3677a9">25</span><span style="color:#666"> </span><span style="color:#3677a9">17</span>:<span style="color:#3677a9">23</span><span style="color:#666">      </span>Cuenta<span style="color:#666"> </span>bloqueada<span style="color:#666">
</span></span></span><span style="display:flex;"><span><span style="color:#666"></span>SCOTT<span style="color:#666">	    </span><span style="color:#3677a9">16</span>/<span style="color:#3677a9">02</span>/<span style="color:#3677a9">25</span><span style="color:#666"> </span><span style="color:#3677a9">17</span>:<span style="color:#3677a9">23</span><span style="color:#666">      </span>Cuenta<span style="color:#666"> </span>bloqueada<span style="color:#666">
</span></span></span><span style="display:flex;"><span><span style="color:#666">
</span></span></span><span style="display:flex;"><span><span style="color:#666"></span>Procedimiento<span style="color:#666"> </span>PL/<span style="color:#6ab825;font-weight:bold">SQL</span><span style="color:#666"> </span>terminado<span style="color:#666"> </span>correctamente.<span style="color:#666">
</span></span></span></code></pre></div><h1 id="activa-la-auditoría-de-las-operaciones-dml-realizadas-por-el-usuario-prueba-en-tablas-de-su-esquema-comprueba-su-funcionamiento">Activa la auditoría de las operaciones DML realizadas por el usuario Prueba en tablas de su esquema. Comprueba su funcionamiento.</h1>
<p>Se activa la auditoría para el usuario prueba cuando haga una consulta, actualización, inserción de datos o borrado de filas de una tabla.</p>
<div class="highlight"><pre tabindex="0" style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-sql" data-lang="sql"><span style="display:flex;"><span><span style="color:#6ab825;font-weight:bold">SQL</span>&gt;<span style="color:#666"> </span>AUDIT<span style="color:#666"> </span><span style="color:#6ab825;font-weight:bold">SELECT</span><span style="color:#666"> </span><span style="color:#6ab825;font-weight:bold">TABLE</span>,<span style="color:#666"> </span><span style="color:#6ab825;font-weight:bold">UPDATE</span><span style="color:#666"> </span><span style="color:#6ab825;font-weight:bold">TABLE</span>,<span style="color:#666"> </span><span style="color:#6ab825;font-weight:bold">INSERT</span><span style="color:#666"> </span><span style="color:#6ab825;font-weight:bold">TABLE</span>,<span style="color:#666"> </span><span style="color:#6ab825;font-weight:bold">DELETE</span><span style="color:#666"> </span><span style="color:#6ab825;font-weight:bold">TABLE</span><span style="color:#666"> </span><span style="color:#6ab825;font-weight:bold">BY</span><span style="color:#666"> </span>PRUEBA<span style="color:#666"> </span><span style="color:#6ab825;font-weight:bold">BY</span><span style="color:#666"> </span><span style="color:#6ab825;font-weight:bold">ACCESS</span>;<span style="color:#666">
</span></span></span><span style="display:flex;"><span><span style="color:#666">
</span></span></span><span style="display:flex;"><span><span style="color:#666"></span>Auditoría<span style="color:#666"> </span>terminada<span style="color:#666"> </span>correctamente.<span style="color:#666">
</span></span></span></code></pre></div><p>Para comprobar el funcionamiento de la auditoria, primero el usuario prueba realiza las acciones auditadas.</p>
<div class="highlight"><pre tabindex="0" style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-sql" data-lang="sql"><span style="display:flex;"><span><span style="color:#6ab825;font-weight:bold">SQL</span>&gt;<span style="color:#666"> </span><span style="color:#6ab825;font-weight:bold">CONNECT</span><span style="color:#666"> </span>PRUEBA/PRUEBA<span style="color:#666">
</span></span></span><span style="display:flex;"><span><span style="color:#666"></span><span style="color:#6ab825;font-weight:bold">SQL</span>&gt;<span style="color:#666"> </span><span style="color:#6ab825;font-weight:bold">INSERT</span><span style="color:#666"> </span><span style="color:#6ab825;font-weight:bold">INTO</span><span style="color:#666"> </span>PRUEBA1<span style="color:#666"> </span><span style="color:#6ab825;font-weight:bold">VALUES</span><span style="color:#666"> </span>(<span style="color:#3677a9">1</span>);<span style="color:#666">
</span></span></span><span style="display:flex;"><span><span style="color:#666">
</span></span></span><span style="display:flex;"><span><span style="color:#666"></span><span style="color:#3677a9">1</span><span style="color:#666"> </span>fila<span style="color:#666"> </span>creada.<span style="color:#666">
</span></span></span><span style="display:flex;"><span><span style="color:#666">
</span></span></span><span style="display:flex;"><span><span style="color:#666"></span><span style="color:#6ab825;font-weight:bold">SQL</span>&gt;<span style="color:#666"> </span><span style="color:#6ab825;font-weight:bold">INSERT</span><span style="color:#666"> </span><span style="color:#6ab825;font-weight:bold">INTO</span><span style="color:#666"> </span>PRUEBA1<span style="color:#666"> </span><span style="color:#6ab825;font-weight:bold">VALUES</span><span style="color:#666"> </span>(<span style="color:#3677a9">2</span>);<span style="color:#666">
</span></span></span><span style="display:flex;"><span><span style="color:#666">
</span></span></span><span style="display:flex;"><span><span style="color:#666"></span><span style="color:#3677a9">1</span><span style="color:#666"> </span>fila<span style="color:#666"> </span>creada.<span style="color:#666">
</span></span></span><span style="display:flex;"><span><span style="color:#666">
</span></span></span><span style="display:flex;"><span><span style="color:#666"></span><span style="color:#6ab825;font-weight:bold">SQL</span>&gt;<span style="color:#666"> </span><span style="color:#6ab825;font-weight:bold">INSERT</span><span style="color:#666"> </span><span style="color:#6ab825;font-weight:bold">INTO</span><span style="color:#666"> </span>PRUEBA1<span style="color:#666"> </span><span style="color:#6ab825;font-weight:bold">VALUES</span><span style="color:#666"> </span>(<span style="color:#3677a9">3</span>);<span style="color:#666">
</span></span></span><span style="display:flex;"><span><span style="color:#666">
</span></span></span><span style="display:flex;"><span><span style="color:#666"></span><span style="color:#3677a9">1</span><span style="color:#666"> </span>fila<span style="color:#666"> </span>creada.<span style="color:#666">
</span></span></span><span style="display:flex;"><span><span style="color:#666">
</span></span></span><span style="display:flex;"><span><span style="color:#666"></span><span style="color:#6ab825;font-weight:bold">SQL</span>&gt;<span style="color:#666"> </span><span style="color:#6ab825;font-weight:bold">UPDATE</span><span style="color:#666"> </span>PRUEBA1<span style="color:#666"> </span><span style="color:#6ab825;font-weight:bold">SET</span><span style="color:#666"> </span>ID=<span style="color:#3677a9">4</span><span style="color:#666"> </span><span style="color:#6ab825;font-weight:bold">WHERE</span><span style="color:#666"> </span>ID=<span style="color:#3677a9">3</span>;<span style="color:#666">
</span></span></span><span style="display:flex;"><span><span style="color:#666">
</span></span></span><span style="display:flex;"><span><span style="color:#666"></span><span style="color:#3677a9">1</span><span style="color:#666"> </span>fila<span style="color:#666"> </span>actualizada.<span style="color:#666">
</span></span></span><span style="display:flex;"><span><span style="color:#666">
</span></span></span><span style="display:flex;"><span><span style="color:#666"></span><span style="color:#6ab825;font-weight:bold">SQL</span>&gt;<span style="color:#666"> </span><span style="color:#6ab825;font-weight:bold">SELECT</span><span style="color:#666"> </span>*<span style="color:#666"> </span><span style="color:#6ab825;font-weight:bold">FROM</span><span style="color:#666"> </span>PRUEBA1;<span style="color:#666">
</span></span></span><span style="display:flex;"><span><span style="color:#666">
</span></span></span><span style="display:flex;"><span><span style="color:#666">	</span>ID<span style="color:#666">
</span></span></span><span style="display:flex;"><span><span style="color:#666"></span><span style="color:#999;font-style:italic">----------
</span></span></span><span style="display:flex;"><span><span style="color:#999;font-style:italic"></span><span style="color:#666">	 </span><span style="color:#3677a9">1</span><span style="color:#666">
</span></span></span><span style="display:flex;"><span><span style="color:#666">	 </span><span style="color:#3677a9">2</span><span style="color:#666">
</span></span></span><span style="display:flex;"><span><span style="color:#666">	 </span><span style="color:#3677a9">4</span><span style="color:#666">
</span></span></span><span style="display:flex;"><span><span style="color:#666">
</span></span></span><span style="display:flex;"><span><span style="color:#666"></span><span style="color:#6ab825;font-weight:bold">SQL</span>&gt;<span style="color:#666"> </span><span style="color:#6ab825;font-weight:bold">DELETE</span><span style="color:#666"> </span><span style="color:#6ab825;font-weight:bold">FROM</span><span style="color:#666"> </span>PRUEBA1<span style="color:#666"> </span><span style="color:#6ab825;font-weight:bold">WHERE</span><span style="color:#666"> </span>ID=<span style="color:#3677a9">2</span>;<span style="color:#666">
</span></span></span><span style="display:flex;"><span><span style="color:#666">
</span></span></span><span style="display:flex;"><span><span style="color:#666"></span><span style="color:#3677a9">1</span><span style="color:#666"> </span>fila<span style="color:#666"> </span>suprimida.<span style="color:#666">
</span></span></span></code></pre></div><p>La vista del diccionario de datos de Oracle donde se almacena la información de estas auditorías es <code>DBA_AUDIT_TRAIL</code>.</p>
<div class="highlight"><pre tabindex="0" style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-sql" data-lang="sql"><span style="display:flex;"><span><span style="color:#6ab825;font-weight:bold">SQL</span>&gt;<span style="color:#666"> </span><span style="color:#6ab825;font-weight:bold">SELECT</span><span style="color:#666"> </span>USERNAME,<span style="color:#6ab825;font-weight:bold">TIMESTAMP</span>,OBJ_NAME,ACTION_NAME<span style="color:#666">
</span></span></span><span style="display:flex;"><span><span style="color:#666">  </span><span style="color:#3677a9">2</span><span style="color:#666">  </span><span style="color:#6ab825;font-weight:bold">FROM</span><span style="color:#666">   </span>DBA_AUDIT_TRAIL<span style="color:#666">
</span></span></span><span style="display:flex;"><span><span style="color:#666">  </span><span style="color:#3677a9">3</span><span style="color:#666">  </span><span style="color:#6ab825;font-weight:bold">WHERE</span><span style="color:#666"> </span><span style="color:#6ab825;font-weight:bold">OWNER</span><span style="color:#666"> </span>=<span style="color:#666"> </span><span style="color:#ed9d13">&#39;PRUEBA&#39;</span>;<span style="color:#666">
</span></span></span><span style="display:flex;"><span><span style="color:#666">
</span></span></span><span style="display:flex;"><span><span style="color:#666"></span>USERNAME<span style="color:#666">
</span></span></span><span style="display:flex;"><span><span style="color:#666"></span><span style="color:#999;font-style:italic">--------------------------------------------------------------------------------
</span></span></span><span style="display:flex;"><span><span style="color:#999;font-style:italic"></span>TIMESTAM<span style="color:#666">
</span></span></span><span style="display:flex;"><span><span style="color:#666"></span><span style="color:#999;font-style:italic">--------
</span></span></span><span style="display:flex;"><span><span style="color:#999;font-style:italic"></span>OBJ_NAME<span style="color:#666">
</span></span></span><span style="display:flex;"><span><span style="color:#666"></span><span style="color:#999;font-style:italic">--------------------------------------------------------------------------------
</span></span></span><span style="display:flex;"><span><span style="color:#999;font-style:italic"></span>ACTION_NAME<span style="color:#666">
</span></span></span><span style="display:flex;"><span><span style="color:#666"></span><span style="color:#999;font-style:italic">--------------------------------------------------------------------------------
</span></span></span><span style="display:flex;"><span><span style="color:#999;font-style:italic"></span>PRUEBA<span style="color:#666">
</span></span></span><span style="display:flex;"><span><span style="color:#666"></span><span style="color:#3677a9">16</span>/<span style="color:#3677a9">02</span>/<span style="color:#3677a9">25</span><span style="color:#666">
</span></span></span><span style="display:flex;"><span><span style="color:#666"></span>PRUEBA1<span style="color:#666">
</span></span></span><span style="display:flex;"><span><span style="color:#666"></span><span style="color:#6ab825;font-weight:bold">INSERT</span><span style="color:#666">
</span></span></span><span style="display:flex;"><span><span style="color:#666">
</span></span></span><span style="display:flex;"><span><span style="color:#666">
</span></span></span><span style="display:flex;"><span><span style="color:#666"></span>USERNAME<span style="color:#666">
</span></span></span><span style="display:flex;"><span><span style="color:#666"></span><span style="color:#999;font-style:italic">--------------------------------------------------------------------------------
</span></span></span><span style="display:flex;"><span><span style="color:#999;font-style:italic"></span>TIMESTAM<span style="color:#666">
</span></span></span><span style="display:flex;"><span><span style="color:#666"></span><span style="color:#999;font-style:italic">--------
</span></span></span><span style="display:flex;"><span><span style="color:#999;font-style:italic"></span>OBJ_NAME<span style="color:#666">
</span></span></span><span style="display:flex;"><span><span style="color:#666"></span><span style="color:#999;font-style:italic">--------------------------------------------------------------------------------
</span></span></span><span style="display:flex;"><span><span style="color:#999;font-style:italic"></span>ACTION_NAME<span style="color:#666">
</span></span></span><span style="display:flex;"><span><span style="color:#666"></span><span style="color:#999;font-style:italic">--------------------------------------------------------------------------------
</span></span></span><span style="display:flex;"><span><span style="color:#999;font-style:italic"></span>PRUEBA<span style="color:#666">
</span></span></span><span style="display:flex;"><span><span style="color:#666"></span><span style="color:#3677a9">16</span>/<span style="color:#3677a9">02</span>/<span style="color:#3677a9">25</span><span style="color:#666">
</span></span></span><span style="display:flex;"><span><span style="color:#666"></span>PRUEBA1<span style="color:#666">
</span></span></span><span style="display:flex;"><span><span style="color:#666"></span><span style="color:#6ab825;font-weight:bold">INSERT</span><span style="color:#666">
</span></span></span><span style="display:flex;"><span><span style="color:#666">
</span></span></span><span style="display:flex;"><span><span style="color:#666">
</span></span></span><span style="display:flex;"><span><span style="color:#666"></span>USERNAME<span style="color:#666">
</span></span></span><span style="display:flex;"><span><span style="color:#666"></span><span style="color:#999;font-style:italic">--------------------------------------------------------------------------------
</span></span></span><span style="display:flex;"><span><span style="color:#999;font-style:italic"></span>TIMESTAM<span style="color:#666">
</span></span></span><span style="display:flex;"><span><span style="color:#666"></span><span style="color:#999;font-style:italic">--------
</span></span></span><span style="display:flex;"><span><span style="color:#999;font-style:italic"></span>OBJ_NAME<span style="color:#666">
</span></span></span><span style="display:flex;"><span><span style="color:#666"></span><span style="color:#999;font-style:italic">--------------------------------------------------------------------------------
</span></span></span><span style="display:flex;"><span><span style="color:#999;font-style:italic"></span>ACTION_NAME<span style="color:#666">
</span></span></span><span style="display:flex;"><span><span style="color:#666"></span><span style="color:#999;font-style:italic">--------------------------------------------------------------------------------
</span></span></span><span style="display:flex;"><span><span style="color:#999;font-style:italic"></span>PRUEBA<span style="color:#666">
</span></span></span><span style="display:flex;"><span><span style="color:#666"></span><span style="color:#3677a9">16</span>/<span style="color:#3677a9">02</span>/<span style="color:#3677a9">25</span><span style="color:#666">
</span></span></span><span style="display:flex;"><span><span style="color:#666"></span>PRUEBA1<span style="color:#666">
</span></span></span><span style="display:flex;"><span><span style="color:#666"></span><span style="color:#6ab825;font-weight:bold">INSERT</span><span style="color:#666">
</span></span></span><span style="display:flex;"><span><span style="color:#666">
</span></span></span><span style="display:flex;"><span><span style="color:#666">
</span></span></span><span style="display:flex;"><span><span style="color:#666"></span>USERNAME<span style="color:#666">
</span></span></span><span style="display:flex;"><span><span style="color:#666"></span><span style="color:#999;font-style:italic">--------------------------------------------------------------------------------
</span></span></span><span style="display:flex;"><span><span style="color:#999;font-style:italic"></span>TIMESTAM<span style="color:#666">
</span></span></span><span style="display:flex;"><span><span style="color:#666"></span><span style="color:#999;font-style:italic">--------
</span></span></span><span style="display:flex;"><span><span style="color:#999;font-style:italic"></span>OBJ_NAME<span style="color:#666">
</span></span></span><span style="display:flex;"><span><span style="color:#666"></span><span style="color:#999;font-style:italic">--------------------------------------------------------------------------------
</span></span></span><span style="display:flex;"><span><span style="color:#999;font-style:italic"></span>ACTION_NAME<span style="color:#666">
</span></span></span><span style="display:flex;"><span><span style="color:#666"></span><span style="color:#999;font-style:italic">--------------------------------------------------------------------------------
</span></span></span><span style="display:flex;"><span><span style="color:#999;font-style:italic"></span>PRUEBA<span style="color:#666">
</span></span></span><span style="display:flex;"><span><span style="color:#666"></span><span style="color:#3677a9">16</span>/<span style="color:#3677a9">02</span>/<span style="color:#3677a9">25</span><span style="color:#666">
</span></span></span><span style="display:flex;"><span><span style="color:#666"></span>PRUEBA1<span style="color:#666">
</span></span></span><span style="display:flex;"><span><span style="color:#666"></span><span style="color:#6ab825;font-weight:bold">INSERT</span><span style="color:#666">
</span></span></span><span style="display:flex;"><span><span style="color:#666">
</span></span></span><span style="display:flex;"><span><span style="color:#666">
</span></span></span><span style="display:flex;"><span><span style="color:#666"></span>USERNAME<span style="color:#666">
</span></span></span><span style="display:flex;"><span><span style="color:#666"></span><span style="color:#999;font-style:italic">--------------------------------------------------------------------------------
</span></span></span><span style="display:flex;"><span><span style="color:#999;font-style:italic"></span>TIMESTAM<span style="color:#666">
</span></span></span><span style="display:flex;"><span><span style="color:#666"></span><span style="color:#999;font-style:italic">--------
</span></span></span><span style="display:flex;"><span><span style="color:#999;font-style:italic"></span>OBJ_NAME<span style="color:#666">
</span></span></span><span style="display:flex;"><span><span style="color:#666"></span><span style="color:#999;font-style:italic">--------------------------------------------------------------------------------
</span></span></span><span style="display:flex;"><span><span style="color:#999;font-style:italic"></span>ACTION_NAME<span style="color:#666">
</span></span></span><span style="display:flex;"><span><span style="color:#666"></span><span style="color:#999;font-style:italic">--------------------------------------------------------------------------------
</span></span></span><span style="display:flex;"><span><span style="color:#999;font-style:italic"></span>PRUEBA<span style="color:#666">
</span></span></span><span style="display:flex;"><span><span style="color:#666"></span><span style="color:#3677a9">16</span>/<span style="color:#3677a9">02</span>/<span style="color:#3677a9">25</span><span style="color:#666">
</span></span></span><span style="display:flex;"><span><span style="color:#666"></span>PRUEBA1<span style="color:#666">
</span></span></span><span style="display:flex;"><span><span style="color:#666"></span><span style="color:#6ab825;font-weight:bold">INSERT</span><span style="color:#666">
</span></span></span><span style="display:flex;"><span><span style="color:#666">
</span></span></span><span style="display:flex;"><span><span style="color:#666">
</span></span></span><span style="display:flex;"><span><span style="color:#666"></span>USERNAME<span style="color:#666">
</span></span></span><span style="display:flex;"><span><span style="color:#666"></span><span style="color:#999;font-style:italic">--------------------------------------------------------------------------------
</span></span></span><span style="display:flex;"><span><span style="color:#999;font-style:italic"></span>TIMESTAM<span style="color:#666">
</span></span></span><span style="display:flex;"><span><span style="color:#666"></span><span style="color:#999;font-style:italic">--------
</span></span></span><span style="display:flex;"><span><span style="color:#999;font-style:italic"></span>OBJ_NAME<span style="color:#666">
</span></span></span><span style="display:flex;"><span><span style="color:#666"></span><span style="color:#999;font-style:italic">--------------------------------------------------------------------------------
</span></span></span><span style="display:flex;"><span><span style="color:#999;font-style:italic"></span>ACTION_NAME<span style="color:#666">
</span></span></span><span style="display:flex;"><span><span style="color:#666"></span><span style="color:#999;font-style:italic">--------------------------------------------------------------------------------
</span></span></span><span style="display:flex;"><span><span style="color:#999;font-style:italic"></span>PRUEBA<span style="color:#666">
</span></span></span><span style="display:flex;"><span><span style="color:#666"></span><span style="color:#3677a9">16</span>/<span style="color:#3677a9">02</span>/<span style="color:#3677a9">25</span><span style="color:#666">
</span></span></span><span style="display:flex;"><span><span style="color:#666"></span>PRUEBA1<span style="color:#666">
</span></span></span><span style="display:flex;"><span><span style="color:#666"></span><span style="color:#6ab825;font-weight:bold">INSERT</span><span style="color:#666">
</span></span></span><span style="display:flex;"><span><span style="color:#666">
</span></span></span><span style="display:flex;"><span><span style="color:#666">
</span></span></span><span style="display:flex;"><span><span style="color:#666"></span>USERNAME<span style="color:#666">
</span></span></span><span style="display:flex;"><span><span style="color:#666"></span><span style="color:#999;font-style:italic">--------------------------------------------------------------------------------
</span></span></span><span style="display:flex;"><span><span style="color:#999;font-style:italic"></span>TIMESTAM<span style="color:#666">
</span></span></span><span style="display:flex;"><span><span style="color:#666"></span><span style="color:#999;font-style:italic">--------
</span></span></span><span style="display:flex;"><span><span style="color:#999;font-style:italic"></span>OBJ_NAME<span style="color:#666">
</span></span></span><span style="display:flex;"><span><span style="color:#666"></span><span style="color:#999;font-style:italic">--------------------------------------------------------------------------------
</span></span></span><span style="display:flex;"><span><span style="color:#999;font-style:italic"></span>ACTION_NAME<span style="color:#666">
</span></span></span><span style="display:flex;"><span><span style="color:#666"></span><span style="color:#999;font-style:italic">--------------------------------------------------------------------------------
</span></span></span><span style="display:flex;"><span><span style="color:#999;font-style:italic"></span>PRUEBA<span style="color:#666">
</span></span></span><span style="display:flex;"><span><span style="color:#666"></span><span style="color:#3677a9">16</span>/<span style="color:#3677a9">02</span>/<span style="color:#3677a9">25</span><span style="color:#666">
</span></span></span><span style="display:flex;"><span><span style="color:#666"></span>PRUEBA1<span style="color:#666">
</span></span></span><span style="display:flex;"><span><span style="color:#666"></span><span style="color:#6ab825;font-weight:bold">INSERT</span><span style="color:#666">
</span></span></span><span style="display:flex;"><span><span style="color:#666">
</span></span></span><span style="display:flex;"><span><span style="color:#666">
</span></span></span><span style="display:flex;"><span><span style="color:#666"></span>USERNAME<span style="color:#666">
</span></span></span><span style="display:flex;"><span><span style="color:#666"></span><span style="color:#999;font-style:italic">--------------------------------------------------------------------------------
</span></span></span><span style="display:flex;"><span><span style="color:#999;font-style:italic"></span>TIMESTAM<span style="color:#666">
</span></span></span><span style="display:flex;"><span><span style="color:#666"></span><span style="color:#999;font-style:italic">--------
</span></span></span><span style="display:flex;"><span><span style="color:#999;font-style:italic"></span>OBJ_NAME<span style="color:#666">
</span></span></span><span style="display:flex;"><span><span style="color:#666"></span><span style="color:#999;font-style:italic">--------------------------------------------------------------------------------
</span></span></span><span style="display:flex;"><span><span style="color:#999;font-style:italic"></span>ACTION_NAME<span style="color:#666">
</span></span></span><span style="display:flex;"><span><span style="color:#666"></span><span style="color:#999;font-style:italic">--------------------------------------------------------------------------------
</span></span></span><span style="display:flex;"><span><span style="color:#999;font-style:italic"></span>PRUEBA<span style="color:#666">
</span></span></span><span style="display:flex;"><span><span style="color:#666"></span><span style="color:#3677a9">16</span>/<span style="color:#3677a9">02</span>/<span style="color:#3677a9">25</span><span style="color:#666">
</span></span></span><span style="display:flex;"><span><span style="color:#666"></span>PRUEBA1<span style="color:#666">
</span></span></span><span style="display:flex;"><span><span style="color:#666"></span><span style="color:#6ab825;font-weight:bold">INSERT</span><span style="color:#666">
</span></span></span><span style="display:flex;"><span><span style="color:#666">
</span></span></span><span style="display:flex;"><span><span style="color:#666">
</span></span></span><span style="display:flex;"><span><span style="color:#666"></span>USERNAME<span style="color:#666">
</span></span></span><span style="display:flex;"><span><span style="color:#666"></span><span style="color:#999;font-style:italic">--------------------------------------------------------------------------------
</span></span></span><span style="display:flex;"><span><span style="color:#999;font-style:italic"></span>TIMESTAM<span style="color:#666">
</span></span></span><span style="display:flex;"><span><span style="color:#666"></span><span style="color:#999;font-style:italic">--------
</span></span></span><span style="display:flex;"><span><span style="color:#999;font-style:italic"></span>OBJ_NAME<span style="color:#666">
</span></span></span><span style="display:flex;"><span><span style="color:#666"></span><span style="color:#999;font-style:italic">--------------------------------------------------------------------------------
</span></span></span><span style="display:flex;"><span><span style="color:#999;font-style:italic"></span>ACTION_NAME<span style="color:#666">
</span></span></span><span style="display:flex;"><span><span style="color:#666"></span><span style="color:#999;font-style:italic">--------------------------------------------------------------------------------
</span></span></span><span style="display:flex;"><span><span style="color:#999;font-style:italic"></span>PRUEBA<span style="color:#666">
</span></span></span><span style="display:flex;"><span><span style="color:#666"></span><span style="color:#3677a9">16</span>/<span style="color:#3677a9">02</span>/<span style="color:#3677a9">25</span><span style="color:#666">
</span></span></span><span style="display:flex;"><span><span style="color:#666"></span>PRUEBA1<span style="color:#666">
</span></span></span><span style="display:flex;"><span><span style="color:#666"></span><span style="color:#6ab825;font-weight:bold">INSERT</span><span style="color:#666">
</span></span></span><span style="display:flex;"><span><span style="color:#666">
</span></span></span><span style="display:flex;"><span><span style="color:#666">
</span></span></span><span style="display:flex;"><span><span style="color:#666"></span>USERNAME<span style="color:#666">
</span></span></span><span style="display:flex;"><span><span style="color:#666"></span><span style="color:#999;font-style:italic">--------------------------------------------------------------------------------
</span></span></span><span style="display:flex;"><span><span style="color:#999;font-style:italic"></span>TIMESTAM<span style="color:#666">
</span></span></span><span style="display:flex;"><span><span style="color:#666"></span><span style="color:#999;font-style:italic">--------
</span></span></span><span style="display:flex;"><span><span style="color:#999;font-style:italic"></span>OBJ_NAME<span style="color:#666">
</span></span></span><span style="display:flex;"><span><span style="color:#666"></span><span style="color:#999;font-style:italic">--------------------------------------------------------------------------------
</span></span></span><span style="display:flex;"><span><span style="color:#999;font-style:italic"></span>ACTION_NAME<span style="color:#666">
</span></span></span><span style="display:flex;"><span><span style="color:#666"></span><span style="color:#999;font-style:italic">--------------------------------------------------------------------------------
</span></span></span><span style="display:flex;"><span><span style="color:#999;font-style:italic"></span>PRUEBA<span style="color:#666">
</span></span></span><span style="display:flex;"><span><span style="color:#666"></span><span style="color:#3677a9">16</span>/<span style="color:#3677a9">02</span>/<span style="color:#3677a9">25</span><span style="color:#666">
</span></span></span><span style="display:flex;"><span><span style="color:#666"></span>PRUEBA1<span style="color:#666">
</span></span></span><span style="display:flex;"><span><span style="color:#666"></span><span style="color:#6ab825;font-weight:bold">INSERT</span><span style="color:#666">
</span></span></span><span style="display:flex;"><span><span style="color:#666">
</span></span></span><span style="display:flex;"><span><span style="color:#666">
</span></span></span><span style="display:flex;"><span><span style="color:#666"></span>USERNAME<span style="color:#666">
</span></span></span><span style="display:flex;"><span><span style="color:#666"></span><span style="color:#999;font-style:italic">--------------------------------------------------------------------------------
</span></span></span><span style="display:flex;"><span><span style="color:#999;font-style:italic"></span>TIMESTAM<span style="color:#666">
</span></span></span><span style="display:flex;"><span><span style="color:#666"></span><span style="color:#999;font-style:italic">--------
</span></span></span><span style="display:flex;"><span><span style="color:#999;font-style:italic"></span>OBJ_NAME<span style="color:#666">
</span></span></span><span style="display:flex;"><span><span style="color:#666"></span><span style="color:#999;font-style:italic">--------------------------------------------------------------------------------
</span></span></span><span style="display:flex;"><span><span style="color:#999;font-style:italic"></span>ACTION_NAME<span style="color:#666">
</span></span></span><span style="display:flex;"><span><span style="color:#666"></span><span style="color:#999;font-style:italic">--------------------------------------------------------------------------------
</span></span></span><span style="display:flex;"><span><span style="color:#999;font-style:italic"></span>PRUEBA<span style="color:#666">
</span></span></span><span style="display:flex;"><span><span style="color:#666"></span><span style="color:#3677a9">16</span>/<span style="color:#3677a9">02</span>/<span style="color:#3677a9">25</span><span style="color:#666">
</span></span></span><span style="display:flex;"><span><span style="color:#666"></span>PRUEBA1<span style="color:#666">
</span></span></span><span style="display:flex;"><span><span style="color:#666"></span><span style="color:#6ab825;font-weight:bold">SELECT</span><span style="color:#666">
</span></span></span><span style="display:flex;"><span><span style="color:#666">
</span></span></span><span style="display:flex;"><span><span style="color:#666">
</span></span></span><span style="display:flex;"><span><span style="color:#666"></span>USERNAME<span style="color:#666">
</span></span></span><span style="display:flex;"><span><span style="color:#666"></span><span style="color:#999;font-style:italic">--------------------------------------------------------------------------------
</span></span></span><span style="display:flex;"><span><span style="color:#999;font-style:italic"></span>TIMESTAM<span style="color:#666">
</span></span></span><span style="display:flex;"><span><span style="color:#666"></span><span style="color:#999;font-style:italic">--------
</span></span></span><span style="display:flex;"><span><span style="color:#999;font-style:italic"></span>OBJ_NAME<span style="color:#666">
</span></span></span><span style="display:flex;"><span><span style="color:#666"></span><span style="color:#999;font-style:italic">--------------------------------------------------------------------------------
</span></span></span><span style="display:flex;"><span><span style="color:#999;font-style:italic"></span>ACTION_NAME<span style="color:#666">
</span></span></span><span style="display:flex;"><span><span style="color:#666"></span><span style="color:#999;font-style:italic">--------------------------------------------------------------------------------
</span></span></span><span style="display:flex;"><span><span style="color:#999;font-style:italic"></span>PRUEBA<span style="color:#666">
</span></span></span><span style="display:flex;"><span><span style="color:#666"></span><span style="color:#3677a9">16</span>/<span style="color:#3677a9">02</span>/<span style="color:#3677a9">25</span><span style="color:#666">
</span></span></span><span style="display:flex;"><span><span style="color:#666"></span>PRUEBA1<span style="color:#666">
</span></span></span><span style="display:flex;"><span><span style="color:#666"></span><span style="color:#6ab825;font-weight:bold">SELECT</span><span style="color:#666">
</span></span></span><span style="display:flex;"><span><span style="color:#666">
</span></span></span><span style="display:flex;"><span><span style="color:#666">
</span></span></span><span style="display:flex;"><span><span style="color:#666"></span>USERNAME<span style="color:#666">
</span></span></span><span style="display:flex;"><span><span style="color:#666"></span><span style="color:#999;font-style:italic">--------------------------------------------------------------------------------
</span></span></span><span style="display:flex;"><span><span style="color:#999;font-style:italic"></span>TIMESTAM<span style="color:#666">
</span></span></span><span style="display:flex;"><span><span style="color:#666"></span><span style="color:#999;font-style:italic">--------
</span></span></span><span style="display:flex;"><span><span style="color:#999;font-style:italic"></span>OBJ_NAME<span style="color:#666">
</span></span></span><span style="display:flex;"><span><span style="color:#666"></span><span style="color:#999;font-style:italic">--------------------------------------------------------------------------------
</span></span></span><span style="display:flex;"><span><span style="color:#999;font-style:italic"></span>ACTION_NAME<span style="color:#666">
</span></span></span><span style="display:flex;"><span><span style="color:#666"></span><span style="color:#999;font-style:italic">--------------------------------------------------------------------------------
</span></span></span><span style="display:flex;"><span><span style="color:#999;font-style:italic"></span>PRUEBA<span style="color:#666">
</span></span></span><span style="display:flex;"><span><span style="color:#666"></span><span style="color:#3677a9">16</span>/<span style="color:#3677a9">02</span>/<span style="color:#3677a9">25</span><span style="color:#666">
</span></span></span><span style="display:flex;"><span><span style="color:#666"></span>PRUEBA1<span style="color:#666">
</span></span></span><span style="display:flex;"><span><span style="color:#666"></span><span style="color:#6ab825;font-weight:bold">SELECT</span><span style="color:#666">
</span></span></span><span style="display:flex;"><span><span style="color:#666">
</span></span></span><span style="display:flex;"><span><span style="color:#666"></span>USERNAME<span style="color:#666">
</span></span></span><span style="display:flex;"><span><span style="color:#666"></span><span style="color:#999;font-style:italic">--------------------------------------------------------------------------------
</span></span></span><span style="display:flex;"><span><span style="color:#999;font-style:italic"></span>TIMESTAM<span style="color:#666">
</span></span></span><span style="display:flex;"><span><span style="color:#666"></span><span style="color:#999;font-style:italic">--------
</span></span></span><span style="display:flex;"><span><span style="color:#999;font-style:italic"></span>OBJ_NAME<span style="color:#666">
</span></span></span><span style="display:flex;"><span><span style="color:#666"></span><span style="color:#999;font-style:italic">--------------------------------------------------------------------------------
</span></span></span><span style="display:flex;"><span><span style="color:#999;font-style:italic"></span>ACTION_NAME<span style="color:#666">
</span></span></span><span style="display:flex;"><span><span style="color:#666"></span><span style="color:#999;font-style:italic">--------------------------------------------------------------------------------
</span></span></span><span style="display:flex;"><span><span style="color:#999;font-style:italic"></span>PRUEBA<span style="color:#666">
</span></span></span><span style="display:flex;"><span><span style="color:#666"></span><span style="color:#3677a9">16</span>/<span style="color:#3677a9">02</span>/<span style="color:#3677a9">25</span><span style="color:#666">
</span></span></span><span style="display:flex;"><span><span style="color:#666"></span>PRUEBA1<span style="color:#666">
</span></span></span><span style="display:flex;"><span><span style="color:#666"></span><span style="color:#6ab825;font-weight:bold">UPDATE</span><span style="color:#666">
</span></span></span><span style="display:flex;"><span><span style="color:#666">
</span></span></span><span style="display:flex;"><span><span style="color:#666">
</span></span></span><span style="display:flex;"><span><span style="color:#666"></span>USERNAME<span style="color:#666">
</span></span></span><span style="display:flex;"><span><span style="color:#666"></span><span style="color:#999;font-style:italic">--------------------------------------------------------------------------------
</span></span></span><span style="display:flex;"><span><span style="color:#999;font-style:italic"></span>TIMESTAM<span style="color:#666">
</span></span></span><span style="display:flex;"><span><span style="color:#666"></span><span style="color:#999;font-style:italic">--------
</span></span></span><span style="display:flex;"><span><span style="color:#999;font-style:italic"></span>OBJ_NAME<span style="color:#666">
</span></span></span><span style="display:flex;"><span><span style="color:#666"></span><span style="color:#999;font-style:italic">--------------------------------------------------------------------------------
</span></span></span><span style="display:flex;"><span><span style="color:#999;font-style:italic"></span>ACTION_NAME<span style="color:#666">
</span></span></span><span style="display:flex;"><span><span style="color:#666"></span><span style="color:#999;font-style:italic">--------------------------------------------------------------------------------
</span></span></span><span style="display:flex;"><span><span style="color:#999;font-style:italic"></span>PRUEBA<span style="color:#666">
</span></span></span><span style="display:flex;"><span><span style="color:#666"></span><span style="color:#3677a9">16</span>/<span style="color:#3677a9">02</span>/<span style="color:#3677a9">25</span><span style="color:#666">
</span></span></span><span style="display:flex;"><span><span style="color:#666"></span>PRUEBA1<span style="color:#666">
</span></span></span><span style="display:flex;"><span><span style="color:#666"></span><span style="color:#6ab825;font-weight:bold">DELETE</span><span style="color:#666">
</span></span></span><span style="display:flex;"><span><span style="color:#666">
</span></span></span><span style="display:flex;"><span><span style="color:#666">
</span></span></span><span style="display:flex;"><span><span style="color:#666"></span><span style="color:#3677a9">15</span><span style="color:#666"> </span>filas<span style="color:#666"> </span>seleccionadas.<span style="color:#666">
</span></span></span></code></pre></div><h1 id="realiza-una-auditoría-de-grano-fino-para-almacenar-información-sobre-la-inserción-de-empleados-con-comisión-en-la-tabla-emp-de-scott">Realiza una auditoría de grano fino para almacenar información sobre la inserción de empleados con comisión en la tabla emp de Scott.</h1>
<p>Para hacer auditorías de grano fino o Fine Grain Auditing (FGA) en Oracle se usa el paquete <code>DBMS_FGA</code>. Este paquete cuenta con varios métodos para interactuar con él. Por ejemplo, con <code>DBMS_FGA.ADD_POLICY</code> se añade una política de auditoría. En esta política se pueden especificar las condiciones específicas que se quieren auditar. En este caso, se indica el nombre del esquema de la tabla cuyas inserciones se quieren auditar, el nombre de la tabla, el nombre de la política que se está creando, la condición que se quiere auditar (en este caso, que el campo comisión de la tabla emp de Scott no sea nulo), la columna que se audita y el tipo de operación que hay que auditar. Además, hay otro método del paquete que permite habilitar una política de auditoría: <code>DBMS_FGA.ENABLE_POLICY</code>.</p>
<div class="highlight"><pre tabindex="0" style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-SQL" data-lang="SQL"><span style="display:flex;"><span><span style="color:#6ab825;font-weight:bold">SQL</span>&gt;<span style="color:#666"> </span><span style="color:#6ab825;font-weight:bold">BEGIN</span><span style="color:#666">
</span></span></span><span style="display:flex;"><span><span style="color:#666">  </span><span style="color:#3677a9">2</span><span style="color:#666">     </span>DBMS_FGA.ADD_POLICY(<span style="color:#666">
</span></span></span><span style="display:flex;"><span><span style="color:#666">  </span><span style="color:#3677a9">3</span><span style="color:#666">        </span>object_schema<span style="color:#666">      </span>=&gt;<span style="color:#666"> </span><span style="color:#ed9d13">&#39;SCOTT&#39;</span>,<span style="color:#666">
</span></span></span><span style="display:flex;"><span><span style="color:#666">  </span><span style="color:#3677a9">4</span><span style="color:#666">        </span>object_name<span style="color:#666">        </span>=&gt;<span style="color:#666"> </span><span style="color:#ed9d13">&#39;EMP&#39;</span>,<span style="color:#666">
</span></span></span><span style="display:flex;"><span><span style="color:#666">  </span><span style="color:#3677a9">5</span><span style="color:#666">        </span>policy_name<span style="color:#666">        </span>=&gt;<span style="color:#666"> </span><span style="color:#ed9d13">&#39;COMISIONES_NO_NULAS&#39;</span>,<span style="color:#666">
</span></span></span><span style="display:flex;"><span><span style="color:#666">  </span><span style="color:#3677a9">6</span><span style="color:#666">        </span>audit_condition<span style="color:#666">    </span>=&gt;<span style="color:#666"> </span><span style="color:#ed9d13">&#39;COMM IS NOT NULL&#39;</span>,<span style="color:#666">
</span></span></span><span style="display:flex;"><span><span style="color:#666">  </span><span style="color:#3677a9">7</span><span style="color:#666">        </span>audit_column<span style="color:#666">       </span>=&gt;<span style="color:#666"> </span><span style="color:#ed9d13">&#39;COMM&#39;</span>,<span style="color:#666">
</span></span></span><span style="display:flex;"><span><span style="color:#666">  </span><span style="color:#3677a9">8</span><span style="color:#666">        </span>statement_types<span style="color:#666">    </span>=&gt;<span style="color:#666"> </span><span style="color:#ed9d13">&#39;INSERT&#39;</span><span style="color:#666">
</span></span></span><span style="display:flex;"><span><span style="color:#666">  </span><span style="color:#3677a9">9</span><span style="color:#666">     </span>);<span style="color:#666">
</span></span></span><span style="display:flex;"><span><span style="color:#666"> </span><span style="color:#3677a9">10</span><span style="color:#666">  </span><span style="color:#6ab825;font-weight:bold">END</span>;<span style="color:#666">
</span></span></span><span style="display:flex;"><span><span style="color:#666"> </span><span style="color:#3677a9">11</span><span style="color:#666">  </span>/<span style="color:#666">
</span></span></span><span style="display:flex;"><span><span style="color:#666">
</span></span></span><span style="display:flex;"><span><span style="color:#666"></span>Procedimiento<span style="color:#666"> </span>PL/<span style="color:#6ab825;font-weight:bold">SQL</span><span style="color:#666"> </span>terminado<span style="color:#666"> </span>correctamente.<span style="color:#666">
</span></span></span><span style="display:flex;"><span><span style="color:#666">
</span></span></span><span style="display:flex;"><span><span style="color:#666"></span><span style="color:#6ab825;font-weight:bold">SQL</span>&gt;<span style="color:#666"> </span><span style="color:#6ab825;font-weight:bold">BEGIN</span><span style="color:#666">
</span></span></span><span style="display:flex;"><span><span style="color:#666">  </span><span style="color:#3677a9">2</span><span style="color:#666">     </span>DBMS_FGA.ENABLE_POLICY(<span style="color:#666">
</span></span></span><span style="display:flex;"><span><span style="color:#666">  </span><span style="color:#3677a9">3</span><span style="color:#666">        </span>object_schema<span style="color:#666">      </span>=&gt;<span style="color:#666"> </span><span style="color:#ed9d13">&#39;SCOTT&#39;</span>,<span style="color:#666">
</span></span></span><span style="display:flex;"><span><span style="color:#666">  </span><span style="color:#3677a9">4</span><span style="color:#666">        </span>object_name<span style="color:#666">        </span>=&gt;<span style="color:#666"> </span><span style="color:#ed9d13">&#39;EMP&#39;</span>,<span style="color:#666">
</span></span></span><span style="display:flex;"><span><span style="color:#666">  </span><span style="color:#3677a9">5</span><span style="color:#666">        </span>policy_name<span style="color:#666">        </span>=&gt;<span style="color:#666"> </span><span style="color:#ed9d13">&#39;COMISIONES_NO_NULAS&#39;</span><span style="color:#666">
</span></span></span><span style="display:flex;"><span><span style="color:#666">  </span><span style="color:#3677a9">6</span><span style="color:#666">     </span>);<span style="color:#666">
</span></span></span><span style="display:flex;"><span><span style="color:#666">  </span><span style="color:#3677a9">7</span><span style="color:#666">  </span><span style="color:#6ab825;font-weight:bold">END</span>;<span style="color:#666">
</span></span></span><span style="display:flex;"><span><span style="color:#666">  </span><span style="color:#3677a9">8</span><span style="color:#666">  </span>/<span style="color:#666">
</span></span></span><span style="display:flex;"><span><span style="color:#666">
</span></span></span><span style="display:flex;"><span><span style="color:#666"></span>Procedimiento<span style="color:#666"> </span>PL/<span style="color:#6ab825;font-weight:bold">SQL</span><span style="color:#666"> </span>terminado<span style="color:#666"> </span>correctamente.<span style="color:#666">
</span></span></span></code></pre></div><p>Las políticas de auditoría creadas en la base de datos se almacenan en la vista del diccionario de datos <code>DBA_AUDIT_POLICIES</code>.</p>
<div class="highlight"><pre tabindex="0" style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-SQL" data-lang="SQL"><span style="display:flex;"><span><span style="color:#6ab825;font-weight:bold">SQL</span>&gt;<span style="color:#666"> </span><span style="color:#6ab825;font-weight:bold">SELECT</span><span style="color:#666"> </span>OBJECT_SCHEMA,OBJECT_NAME,POLICY_NAME<span style="color:#666"> </span><span style="color:#6ab825;font-weight:bold">FROM</span><span style="color:#666"> </span>DBA_AUDIT_POLICIES;<span style="color:#666">
</span></span></span><span style="display:flex;"><span><span style="color:#666">
</span></span></span><span style="display:flex;"><span><span style="color:#666"></span>OBJECT_SCHEMA<span style="color:#666">
</span></span></span><span style="display:flex;"><span><span style="color:#666"></span><span style="color:#999;font-style:italic">--------------------------------------------------------------------------------
</span></span></span><span style="display:flex;"><span><span style="color:#999;font-style:italic"></span>OBJECT_NAME<span style="color:#666">
</span></span></span><span style="display:flex;"><span><span style="color:#666"></span><span style="color:#999;font-style:italic">--------------------------------------------------------------------------------
</span></span></span><span style="display:flex;"><span><span style="color:#999;font-style:italic"></span>POLICY_NAME<span style="color:#666">
</span></span></span><span style="display:flex;"><span><span style="color:#666"></span><span style="color:#999;font-style:italic">--------------------------------------------------------------------------------
</span></span></span><span style="display:flex;"><span><span style="color:#999;font-style:italic"></span>SCOTT<span style="color:#666">
</span></span></span><span style="display:flex;"><span><span style="color:#666"></span>EMP<span style="color:#666">
</span></span></span><span style="display:flex;"><span><span style="color:#666"></span>COMISIONES_NO_NULAS<span style="color:#666">
</span></span></span></code></pre></div><p>Para comprobar el funcionamiento de la auditoría de grano fino, el usuario SCOTT añade dos nuevas filas a la tabla <code>EMP</code>: una de ellas con el registro de un nuevo empleado que cobra comisión y otra con el campo <code>COMM</code> vacío.</p>
<div class="highlight"><pre tabindex="0" style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-sql" data-lang="sql"><span style="display:flex;"><span><span style="color:#6ab825;font-weight:bold">SQL</span>&gt;<span style="color:#666"> </span><span style="color:#6ab825;font-weight:bold">INSERT</span><span style="color:#666"> </span><span style="color:#6ab825;font-weight:bold">INTO</span><span style="color:#666"> </span>SCOTT.EMP<span style="color:#666"> </span><span style="color:#6ab825;font-weight:bold">VALUES</span><span style="color:#666"> </span>(<span style="color:#3677a9">7901</span>,<span style="color:#ed9d13">&#39;LOLI&#39;</span>,<span style="color:#ed9d13">&#39;SALESMAN&#39;</span>,<span style="color:#3677a9">7698</span>,TO_DATE(<span style="color:#ed9d13">&#39;08/09/81&#39;</span>,<span style="color:#ed9d13">&#39;DD/MM/YY&#39;</span>),<span style="color:#3677a9">1200</span>,<span style="color:#3677a9">20</span>,<span style="color:#3677a9">30</span>);<span style="color:#666">
</span></span></span><span style="display:flex;"><span><span style="color:#666">
</span></span></span><span style="display:flex;"><span><span style="color:#666"></span><span style="color:#3677a9">1</span><span style="color:#666"> </span>fila<span style="color:#666"> </span>creada.<span style="color:#666">
</span></span></span><span style="display:flex;"><span><span style="color:#666">
</span></span></span><span style="display:flex;"><span><span style="color:#666"></span><span style="color:#6ab825;font-weight:bold">SQL</span>&gt;<span style="color:#666"> </span><span style="color:#6ab825;font-weight:bold">INSERT</span><span style="color:#666"> </span><span style="color:#6ab825;font-weight:bold">INTO</span><span style="color:#666"> </span>SCOTT.EMP<span style="color:#666"> </span>(EMPNO,ENAME,JOB,MGR,HIREDATE,SAL,DEPTNO)<span style="color:#666"> </span><span style="color:#6ab825;font-weight:bold">VALUES</span><span style="color:#666"> </span>(<span style="color:#3677a9">7903</span>,<span style="color:#ed9d13">&#39;JUAN&#39;</span>,<span style="color:#ed9d13">&#39;CLERK&#39;</span>,<span style="color:#3677a9">7698</span>,TO_DATE(<span style="color:#ed9d13">&#39;03/09/81&#39;</span>,<span style="color:#ed9d13">&#39;DD/MM/YY&#39;</span>),<span style="color:#3677a9">1050</span>,<span style="color:#3677a9">30</span>);<span style="color:#666">
</span></span></span><span style="display:flex;"><span><span style="color:#666">
</span></span></span><span style="display:flex;"><span><span style="color:#666"></span><span style="color:#3677a9">1</span><span style="color:#666"> </span>fila<span style="color:#666"> </span>creada.<span style="color:#666">
</span></span></span></code></pre></div><p>La información generada por esta auditoría de grano fino se almacena en la vista del diccionario de datos <code>DBA_FGA_AUDIT_TRAIL</code>. En esta consulta se ve cómo de las dos sentencias INSERT ejecutadas anteriormente, sólo se ha almacenado en la vista aquella en la que se han insertado datos en el campo <code>COMM</code>.</p>
<div class="highlight"><pre tabindex="0" style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-SQL" data-lang="SQL"><span style="display:flex;"><span><span style="color:#6ab825;font-weight:bold">SQL</span>&gt;<span style="color:#666"> </span><span style="color:#6ab825;font-weight:bold">SELECT</span><span style="color:#666"> </span>DB_USER,<span style="color:#666"> </span>OBJECT_NAME,<span style="color:#666"> </span>SQL_TEXT,<span style="color:#666"> </span><span style="color:#6ab825;font-weight:bold">TIMESTAMP</span><span style="color:#666">
</span></span></span><span style="display:flex;"><span><span style="color:#666">  </span><span style="color:#3677a9">2</span><span style="color:#666">  </span><span style="color:#6ab825;font-weight:bold">FROM</span><span style="color:#666"> </span>DBA_FGA_AUDIT_TRAIL<span style="color:#666">
</span></span></span><span style="display:flex;"><span><span style="color:#666">  </span><span style="color:#3677a9">3</span><span style="color:#666">  </span><span style="color:#6ab825;font-weight:bold">WHERE</span><span style="color:#666"> </span>POLICY_NAME<span style="color:#666"> </span>=<span style="color:#666"> </span><span style="color:#ed9d13">&#39;COMISIONES_NO_NULAS&#39;</span>;<span style="color:#666">
</span></span></span><span style="display:flex;"><span><span style="color:#666">
</span></span></span><span style="display:flex;"><span><span style="color:#666"></span>DB_USER<span style="color:#666">
</span></span></span><span style="display:flex;"><span><span style="color:#666"></span><span style="color:#999;font-style:italic">--------------------------------------------------------------------------------
</span></span></span><span style="display:flex;"><span><span style="color:#999;font-style:italic"></span>OBJECT_NAME<span style="color:#666">
</span></span></span><span style="display:flex;"><span><span style="color:#666"></span><span style="color:#999;font-style:italic">--------------------------------------------------------------------------------
</span></span></span><span style="display:flex;"><span><span style="color:#999;font-style:italic"></span>SQL_TEXT<span style="color:#666">
</span></span></span><span style="display:flex;"><span><span style="color:#666"></span><span style="color:#999;font-style:italic">--------------------------------------------------------------------------------
</span></span></span><span style="display:flex;"><span><span style="color:#999;font-style:italic"></span>TIMESTAM<span style="color:#666">
</span></span></span><span style="display:flex;"><span><span style="color:#666"></span><span style="color:#999;font-style:italic">--------
</span></span></span><span style="display:flex;"><span><span style="color:#999;font-style:italic"></span>SCOTT<span style="color:#666">
</span></span></span><span style="display:flex;"><span><span style="color:#666"></span>EMP<span style="color:#666">
</span></span></span><span style="display:flex;"><span><span style="color:#666"></span><span style="color:#6ab825;font-weight:bold">INSERT</span><span style="color:#666"> </span><span style="color:#6ab825;font-weight:bold">INTO</span><span style="color:#666"> </span>SCOTT.EMP<span style="color:#666"> </span><span style="color:#6ab825;font-weight:bold">VALUES</span><span style="color:#666"> </span>(<span style="color:#3677a9">7901</span>,<span style="color:#ed9d13">&#39;LOLI&#39;</span>,<span style="color:#ed9d13">&#39;SALESMAN&#39;</span>,<span style="color:#3677a9">7698</span>,TO_DATE(<span style="color:#ed9d13">&#39;08/09/81&#39;</span>,<span style="color:#ed9d13">&#39;DD
</span></span></span><span style="display:flex;"><span><span style="color:#ed9d13">/MM/YY&#39;</span>),<span style="color:#3677a9">1200</span>,<span style="color:#3677a9">20</span>,<span style="color:#3677a9">30</span>)<span style="color:#666">
</span></span></span><span style="display:flex;"><span><span style="color:#666"></span><span style="color:#3677a9">16</span>/<span style="color:#3677a9">02</span>/<span style="color:#3677a9">25</span><span style="color:#666">
</span></span></span></code></pre></div><h1 id="explica-la-diferencia-entre-auditar-una-operación-by-access-o-by-session-ilustrándolo-con-ejemplos">Explica la diferencia entre auditar una operación by access o by session ilustrándolo con ejemplos.</h1>
<p>La diferencia entre auditar una operación by access o by session reside en el nivel de precisión de la información que se almacena. Cuando se audita una operación by access, se guarda una entrada en la tabla de la auditoría por cada vez que se ejecuta la acción. Por ejemplo, tomando como referencia el <a href="#activa-la-auditor%c3%ada-de-las-operaciones-dml-realizadas-por-el-usuario-prueba-en-tablas-de-su-esquema-comprueba-su-funcionamiento"



 


>ejercicio 3</a>, con la opción by access, se crea una entrada en la tabla por cada operación DML que realiza el usuario prueba. En cambio, cuando una operación se audita by session, sólo se genera una entrada en la tabla si el usuario ha realizado esa operación durante la sesión una o varias veces.</p>
<p>Es decir si, en el ejemplo referenciado el usuario Prueba realiza varias operaciones de INSERT en su tabla, una auditoría by access genera tantas entradas como INSERT haya realizado, mientras que una auditoría by session sólo genera una entrada para indicar que se ha realizado una o varias veces la operación INSERT auditada.</p>
<p>Si recordamos el resultado de la consulta cuando se ha auditado la inserción de varios datos en la tabla, la actualización, la consulta a la tabla y la eliminación de datos por parte del usuario Prueba en el ejercicio anterior, se ha almacenado la siguiente información en la vista de la auditoría:</p>
<div class="highlight"><pre tabindex="0" style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-sql" data-lang="sql"><span style="display:flex;"><span><span style="color:#6ab825;font-weight:bold">SQL</span>&gt;<span style="color:#666"> </span><span style="color:#6ab825;font-weight:bold">SELECT</span><span style="color:#666"> </span>USERNAME,<span style="color:#6ab825;font-weight:bold">TIMESTAMP</span>,OBJ_NAME,ACTION_NAME<span style="color:#666">
</span></span></span><span style="display:flex;"><span><span style="color:#666">  </span><span style="color:#3677a9">2</span><span style="color:#666">  </span><span style="color:#6ab825;font-weight:bold">FROM</span><span style="color:#666">   </span>DBA_AUDIT_TRAIL<span style="color:#666">
</span></span></span><span style="display:flex;"><span><span style="color:#666">  </span><span style="color:#3677a9">3</span><span style="color:#666">  </span><span style="color:#6ab825;font-weight:bold">WHERE</span><span style="color:#666"> </span><span style="color:#6ab825;font-weight:bold">OWNER</span><span style="color:#666"> </span>=<span style="color:#666"> </span><span style="color:#ed9d13">&#39;PRUEBA&#39;</span>;<span style="color:#666">
</span></span></span><span style="display:flex;"><span><span style="color:#666">
</span></span></span><span style="display:flex;"><span><span style="color:#666"></span>USERNAME<span style="color:#666">
</span></span></span><span style="display:flex;"><span><span style="color:#666"></span><span style="color:#999;font-style:italic">--------------------------------------------------------------------------------
</span></span></span><span style="display:flex;"><span><span style="color:#999;font-style:italic"></span>TIMESTAM<span style="color:#666">
</span></span></span><span style="display:flex;"><span><span style="color:#666"></span><span style="color:#999;font-style:italic">--------
</span></span></span><span style="display:flex;"><span><span style="color:#999;font-style:italic"></span>OBJ_NAME<span style="color:#666">
</span></span></span><span style="display:flex;"><span><span style="color:#666"></span><span style="color:#999;font-style:italic">--------------------------------------------------------------------------------
</span></span></span><span style="display:flex;"><span><span style="color:#999;font-style:italic"></span>ACTION_NAME<span style="color:#666">
</span></span></span><span style="display:flex;"><span><span style="color:#666"></span><span style="color:#999;font-style:italic">--------------------------------------------------------------------------------
</span></span></span><span style="display:flex;"><span><span style="color:#999;font-style:italic"></span>PRUEBA<span style="color:#666">
</span></span></span><span style="display:flex;"><span><span style="color:#666"></span><span style="color:#3677a9">16</span>/<span style="color:#3677a9">02</span>/<span style="color:#3677a9">25</span><span style="color:#666">
</span></span></span><span style="display:flex;"><span><span style="color:#666"></span>PRUEBA1<span style="color:#666">
</span></span></span><span style="display:flex;"><span><span style="color:#666"></span><span style="color:#6ab825;font-weight:bold">INSERT</span><span style="color:#666">
</span></span></span><span style="display:flex;"><span><span style="color:#666">
</span></span></span><span style="display:flex;"><span><span style="color:#666">
</span></span></span><span style="display:flex;"><span><span style="color:#666"></span>USERNAME<span style="color:#666">
</span></span></span><span style="display:flex;"><span><span style="color:#666"></span><span style="color:#999;font-style:italic">--------------------------------------------------------------------------------
</span></span></span><span style="display:flex;"><span><span style="color:#999;font-style:italic"></span>TIMESTAM<span style="color:#666">
</span></span></span><span style="display:flex;"><span><span style="color:#666"></span><span style="color:#999;font-style:italic">--------
</span></span></span><span style="display:flex;"><span><span style="color:#999;font-style:italic"></span>OBJ_NAME<span style="color:#666">
</span></span></span><span style="display:flex;"><span><span style="color:#666"></span><span style="color:#999;font-style:italic">--------------------------------------------------------------------------------
</span></span></span><span style="display:flex;"><span><span style="color:#999;font-style:italic"></span>ACTION_NAME<span style="color:#666">
</span></span></span><span style="display:flex;"><span><span style="color:#666"></span><span style="color:#999;font-style:italic">--------------------------------------------------------------------------------
</span></span></span><span style="display:flex;"><span><span style="color:#999;font-style:italic"></span>PRUEBA<span style="color:#666">
</span></span></span><span style="display:flex;"><span><span style="color:#666"></span><span style="color:#3677a9">16</span>/<span style="color:#3677a9">02</span>/<span style="color:#3677a9">25</span><span style="color:#666">
</span></span></span><span style="display:flex;"><span><span style="color:#666"></span>PRUEBA1<span style="color:#666">
</span></span></span><span style="display:flex;"><span><span style="color:#666"></span><span style="color:#6ab825;font-weight:bold">INSERT</span><span style="color:#666">
</span></span></span><span style="display:flex;"><span><span style="color:#666">
</span></span></span><span style="display:flex;"><span><span style="color:#666">
</span></span></span><span style="display:flex;"><span><span style="color:#666"></span>USERNAME<span style="color:#666">
</span></span></span><span style="display:flex;"><span><span style="color:#666"></span><span style="color:#999;font-style:italic">--------------------------------------------------------------------------------
</span></span></span><span style="display:flex;"><span><span style="color:#999;font-style:italic"></span>TIMESTAM<span style="color:#666">
</span></span></span><span style="display:flex;"><span><span style="color:#666"></span><span style="color:#999;font-style:italic">--------
</span></span></span><span style="display:flex;"><span><span style="color:#999;font-style:italic"></span>OBJ_NAME<span style="color:#666">
</span></span></span><span style="display:flex;"><span><span style="color:#666"></span><span style="color:#999;font-style:italic">--------------------------------------------------------------------------------
</span></span></span><span style="display:flex;"><span><span style="color:#999;font-style:italic"></span>ACTION_NAME<span style="color:#666">
</span></span></span><span style="display:flex;"><span><span style="color:#666"></span><span style="color:#999;font-style:italic">--------------------------------------------------------------------------------
</span></span></span><span style="display:flex;"><span><span style="color:#999;font-style:italic"></span>PRUEBA<span style="color:#666">
</span></span></span><span style="display:flex;"><span><span style="color:#666"></span><span style="color:#3677a9">16</span>/<span style="color:#3677a9">02</span>/<span style="color:#3677a9">25</span><span style="color:#666">
</span></span></span><span style="display:flex;"><span><span style="color:#666"></span>PRUEBA1<span style="color:#666">
</span></span></span><span style="display:flex;"><span><span style="color:#666"></span><span style="color:#6ab825;font-weight:bold">INSERT</span><span style="color:#666">
</span></span></span><span style="display:flex;"><span><span style="color:#666">
</span></span></span><span style="display:flex;"><span><span style="color:#666">
</span></span></span><span style="display:flex;"><span><span style="color:#666"></span>USERNAME<span style="color:#666">
</span></span></span><span style="display:flex;"><span><span style="color:#666"></span><span style="color:#999;font-style:italic">--------------------------------------------------------------------------------
</span></span></span><span style="display:flex;"><span><span style="color:#999;font-style:italic"></span>TIMESTAM<span style="color:#666">
</span></span></span><span style="display:flex;"><span><span style="color:#666"></span><span style="color:#999;font-style:italic">--------
</span></span></span><span style="display:flex;"><span><span style="color:#999;font-style:italic"></span>OBJ_NAME<span style="color:#666">
</span></span></span><span style="display:flex;"><span><span style="color:#666"></span><span style="color:#999;font-style:italic">--------------------------------------------------------------------------------
</span></span></span><span style="display:flex;"><span><span style="color:#999;font-style:italic"></span>ACTION_NAME<span style="color:#666">
</span></span></span><span style="display:flex;"><span><span style="color:#666"></span><span style="color:#999;font-style:italic">--------------------------------------------------------------------------------
</span></span></span><span style="display:flex;"><span><span style="color:#999;font-style:italic"></span>PRUEBA<span style="color:#666">
</span></span></span><span style="display:flex;"><span><span style="color:#666"></span><span style="color:#3677a9">16</span>/<span style="color:#3677a9">02</span>/<span style="color:#3677a9">25</span><span style="color:#666">
</span></span></span><span style="display:flex;"><span><span style="color:#666"></span>PRUEBA1<span style="color:#666">
</span></span></span><span style="display:flex;"><span><span style="color:#666"></span><span style="color:#6ab825;font-weight:bold">INSERT</span><span style="color:#666">
</span></span></span><span style="display:flex;"><span><span style="color:#666">
</span></span></span><span style="display:flex;"><span><span style="color:#666">
</span></span></span><span style="display:flex;"><span><span style="color:#666"></span>USERNAME<span style="color:#666">
</span></span></span><span style="display:flex;"><span><span style="color:#666"></span><span style="color:#999;font-style:italic">--------------------------------------------------------------------------------
</span></span></span><span style="display:flex;"><span><span style="color:#999;font-style:italic"></span>TIMESTAM<span style="color:#666">
</span></span></span><span style="display:flex;"><span><span style="color:#666"></span><span style="color:#999;font-style:italic">--------
</span></span></span><span style="display:flex;"><span><span style="color:#999;font-style:italic"></span>OBJ_NAME<span style="color:#666">
</span></span></span><span style="display:flex;"><span><span style="color:#666"></span><span style="color:#999;font-style:italic">--------------------------------------------------------------------------------
</span></span></span><span style="display:flex;"><span><span style="color:#999;font-style:italic"></span>ACTION_NAME<span style="color:#666">
</span></span></span><span style="display:flex;"><span><span style="color:#666"></span><span style="color:#999;font-style:italic">--------------------------------------------------------------------------------
</span></span></span><span style="display:flex;"><span><span style="color:#999;font-style:italic"></span>PRUEBA<span style="color:#666">
</span></span></span><span style="display:flex;"><span><span style="color:#666"></span><span style="color:#3677a9">16</span>/<span style="color:#3677a9">02</span>/<span style="color:#3677a9">25</span><span style="color:#666">
</span></span></span><span style="display:flex;"><span><span style="color:#666"></span>PRUEBA1<span style="color:#666">
</span></span></span><span style="display:flex;"><span><span style="color:#666"></span><span style="color:#6ab825;font-weight:bold">INSERT</span><span style="color:#666">
</span></span></span><span style="display:flex;"><span><span style="color:#666">
</span></span></span><span style="display:flex;"><span><span style="color:#666">
</span></span></span><span style="display:flex;"><span><span style="color:#666"></span>USERNAME<span style="color:#666">
</span></span></span><span style="display:flex;"><span><span style="color:#666"></span><span style="color:#999;font-style:italic">--------------------------------------------------------------------------------
</span></span></span><span style="display:flex;"><span><span style="color:#999;font-style:italic"></span>TIMESTAM<span style="color:#666">
</span></span></span><span style="display:flex;"><span><span style="color:#666"></span><span style="color:#999;font-style:italic">--------
</span></span></span><span style="display:flex;"><span><span style="color:#999;font-style:italic"></span>OBJ_NAME<span style="color:#666">
</span></span></span><span style="display:flex;"><span><span style="color:#666"></span><span style="color:#999;font-style:italic">--------------------------------------------------------------------------------
</span></span></span><span style="display:flex;"><span><span style="color:#999;font-style:italic"></span>ACTION_NAME<span style="color:#666">
</span></span></span><span style="display:flex;"><span><span style="color:#666"></span><span style="color:#999;font-style:italic">--------------------------------------------------------------------------------
</span></span></span><span style="display:flex;"><span><span style="color:#999;font-style:italic"></span>PRUEBA<span style="color:#666">
</span></span></span><span style="display:flex;"><span><span style="color:#666"></span><span style="color:#3677a9">16</span>/<span style="color:#3677a9">02</span>/<span style="color:#3677a9">25</span><span style="color:#666">
</span></span></span><span style="display:flex;"><span><span style="color:#666"></span>PRUEBA1<span style="color:#666">
</span></span></span><span style="display:flex;"><span><span style="color:#666"></span><span style="color:#6ab825;font-weight:bold">INSERT</span><span style="color:#666">
</span></span></span><span style="display:flex;"><span><span style="color:#666">
</span></span></span><span style="display:flex;"><span><span style="color:#666">
</span></span></span><span style="display:flex;"><span><span style="color:#666"></span>USERNAME<span style="color:#666">
</span></span></span><span style="display:flex;"><span><span style="color:#666"></span><span style="color:#999;font-style:italic">--------------------------------------------------------------------------------
</span></span></span><span style="display:flex;"><span><span style="color:#999;font-style:italic"></span>TIMESTAM<span style="color:#666">
</span></span></span><span style="display:flex;"><span><span style="color:#666"></span><span style="color:#999;font-style:italic">--------
</span></span></span><span style="display:flex;"><span><span style="color:#999;font-style:italic"></span>OBJ_NAME<span style="color:#666">
</span></span></span><span style="display:flex;"><span><span style="color:#666"></span><span style="color:#999;font-style:italic">--------------------------------------------------------------------------------
</span></span></span><span style="display:flex;"><span><span style="color:#999;font-style:italic"></span>ACTION_NAME<span style="color:#666">
</span></span></span><span style="display:flex;"><span><span style="color:#666"></span><span style="color:#999;font-style:italic">--------------------------------------------------------------------------------
</span></span></span><span style="display:flex;"><span><span style="color:#999;font-style:italic"></span>PRUEBA<span style="color:#666">
</span></span></span><span style="display:flex;"><span><span style="color:#666"></span><span style="color:#3677a9">16</span>/<span style="color:#3677a9">02</span>/<span style="color:#3677a9">25</span><span style="color:#666">
</span></span></span><span style="display:flex;"><span><span style="color:#666"></span>PRUEBA1<span style="color:#666">
</span></span></span><span style="display:flex;"><span><span style="color:#666"></span><span style="color:#6ab825;font-weight:bold">INSERT</span><span style="color:#666">
</span></span></span><span style="display:flex;"><span><span style="color:#666">
</span></span></span><span style="display:flex;"><span><span style="color:#666">
</span></span></span><span style="display:flex;"><span><span style="color:#666"></span>USERNAME<span style="color:#666">
</span></span></span><span style="display:flex;"><span><span style="color:#666"></span><span style="color:#999;font-style:italic">--------------------------------------------------------------------------------
</span></span></span><span style="display:flex;"><span><span style="color:#999;font-style:italic"></span>TIMESTAM<span style="color:#666">
</span></span></span><span style="display:flex;"><span><span style="color:#666"></span><span style="color:#999;font-style:italic">--------
</span></span></span><span style="display:flex;"><span><span style="color:#999;font-style:italic"></span>OBJ_NAME<span style="color:#666">
</span></span></span><span style="display:flex;"><span><span style="color:#666"></span><span style="color:#999;font-style:italic">--------------------------------------------------------------------------------
</span></span></span><span style="display:flex;"><span><span style="color:#999;font-style:italic"></span>ACTION_NAME<span style="color:#666">
</span></span></span><span style="display:flex;"><span><span style="color:#666"></span><span style="color:#999;font-style:italic">--------------------------------------------------------------------------------
</span></span></span><span style="display:flex;"><span><span style="color:#999;font-style:italic"></span>PRUEBA<span style="color:#666">
</span></span></span><span style="display:flex;"><span><span style="color:#666"></span><span style="color:#3677a9">16</span>/<span style="color:#3677a9">02</span>/<span style="color:#3677a9">25</span><span style="color:#666">
</span></span></span><span style="display:flex;"><span><span style="color:#666"></span>PRUEBA1<span style="color:#666">
</span></span></span><span style="display:flex;"><span><span style="color:#666"></span><span style="color:#6ab825;font-weight:bold">INSERT</span><span style="color:#666">
</span></span></span><span style="display:flex;"><span><span style="color:#666">
</span></span></span><span style="display:flex;"><span><span style="color:#666">
</span></span></span><span style="display:flex;"><span><span style="color:#666"></span>USERNAME<span style="color:#666">
</span></span></span><span style="display:flex;"><span><span style="color:#666"></span><span style="color:#999;font-style:italic">--------------------------------------------------------------------------------
</span></span></span><span style="display:flex;"><span><span style="color:#999;font-style:italic"></span>TIMESTAM<span style="color:#666">
</span></span></span><span style="display:flex;"><span><span style="color:#666"></span><span style="color:#999;font-style:italic">--------
</span></span></span><span style="display:flex;"><span><span style="color:#999;font-style:italic"></span>OBJ_NAME<span style="color:#666">
</span></span></span><span style="display:flex;"><span><span style="color:#666"></span><span style="color:#999;font-style:italic">--------------------------------------------------------------------------------
</span></span></span><span style="display:flex;"><span><span style="color:#999;font-style:italic"></span>ACTION_NAME<span style="color:#666">
</span></span></span><span style="display:flex;"><span><span style="color:#666"></span><span style="color:#999;font-style:italic">--------------------------------------------------------------------------------
</span></span></span><span style="display:flex;"><span><span style="color:#999;font-style:italic"></span>PRUEBA<span style="color:#666">
</span></span></span><span style="display:flex;"><span><span style="color:#666"></span><span style="color:#3677a9">16</span>/<span style="color:#3677a9">02</span>/<span style="color:#3677a9">25</span><span style="color:#666">
</span></span></span><span style="display:flex;"><span><span style="color:#666"></span>PRUEBA1<span style="color:#666">
</span></span></span><span style="display:flex;"><span><span style="color:#666"></span><span style="color:#6ab825;font-weight:bold">INSERT</span><span style="color:#666">
</span></span></span><span style="display:flex;"><span><span style="color:#666">
</span></span></span><span style="display:flex;"><span><span style="color:#666">
</span></span></span><span style="display:flex;"><span><span style="color:#666"></span>USERNAME<span style="color:#666">
</span></span></span><span style="display:flex;"><span><span style="color:#666"></span><span style="color:#999;font-style:italic">--------------------------------------------------------------------------------
</span></span></span><span style="display:flex;"><span><span style="color:#999;font-style:italic"></span>TIMESTAM<span style="color:#666">
</span></span></span><span style="display:flex;"><span><span style="color:#666"></span><span style="color:#999;font-style:italic">--------
</span></span></span><span style="display:flex;"><span><span style="color:#999;font-style:italic"></span>OBJ_NAME<span style="color:#666">
</span></span></span><span style="display:flex;"><span><span style="color:#666"></span><span style="color:#999;font-style:italic">--------------------------------------------------------------------------------
</span></span></span><span style="display:flex;"><span><span style="color:#999;font-style:italic"></span>ACTION_NAME<span style="color:#666">
</span></span></span><span style="display:flex;"><span><span style="color:#666"></span><span style="color:#999;font-style:italic">--------------------------------------------------------------------------------
</span></span></span><span style="display:flex;"><span><span style="color:#999;font-style:italic"></span>PRUEBA<span style="color:#666">
</span></span></span><span style="display:flex;"><span><span style="color:#666"></span><span style="color:#3677a9">16</span>/<span style="color:#3677a9">02</span>/<span style="color:#3677a9">25</span><span style="color:#666">
</span></span></span><span style="display:flex;"><span><span style="color:#666"></span>PRUEBA1<span style="color:#666">
</span></span></span><span style="display:flex;"><span><span style="color:#666"></span><span style="color:#6ab825;font-weight:bold">INSERT</span><span style="color:#666">
</span></span></span><span style="display:flex;"><span><span style="color:#666">
</span></span></span><span style="display:flex;"><span><span style="color:#666">
</span></span></span><span style="display:flex;"><span><span style="color:#666"></span>USERNAME<span style="color:#666">
</span></span></span><span style="display:flex;"><span><span style="color:#666"></span><span style="color:#999;font-style:italic">--------------------------------------------------------------------------------
</span></span></span><span style="display:flex;"><span><span style="color:#999;font-style:italic"></span>TIMESTAM<span style="color:#666">
</span></span></span><span style="display:flex;"><span><span style="color:#666"></span><span style="color:#999;font-style:italic">--------
</span></span></span><span style="display:flex;"><span><span style="color:#999;font-style:italic"></span>OBJ_NAME<span style="color:#666">
</span></span></span><span style="display:flex;"><span><span style="color:#666"></span><span style="color:#999;font-style:italic">--------------------------------------------------------------------------------
</span></span></span><span style="display:flex;"><span><span style="color:#999;font-style:italic"></span>ACTION_NAME<span style="color:#666">
</span></span></span><span style="display:flex;"><span><span style="color:#666"></span><span style="color:#999;font-style:italic">--------------------------------------------------------------------------------
</span></span></span><span style="display:flex;"><span><span style="color:#999;font-style:italic"></span>PRUEBA<span style="color:#666">
</span></span></span><span style="display:flex;"><span><span style="color:#666"></span><span style="color:#3677a9">16</span>/<span style="color:#3677a9">02</span>/<span style="color:#3677a9">25</span><span style="color:#666">
</span></span></span><span style="display:flex;"><span><span style="color:#666"></span>PRUEBA1<span style="color:#666">
</span></span></span><span style="display:flex;"><span><span style="color:#666"></span><span style="color:#6ab825;font-weight:bold">SELECT</span><span style="color:#666">
</span></span></span><span style="display:flex;"><span><span style="color:#666">
</span></span></span><span style="display:flex;"><span><span style="color:#666">
</span></span></span><span style="display:flex;"><span><span style="color:#666"></span>USERNAME<span style="color:#666">
</span></span></span><span style="display:flex;"><span><span style="color:#666"></span><span style="color:#999;font-style:italic">--------------------------------------------------------------------------------
</span></span></span><span style="display:flex;"><span><span style="color:#999;font-style:italic"></span>TIMESTAM<span style="color:#666">
</span></span></span><span style="display:flex;"><span><span style="color:#666"></span><span style="color:#999;font-style:italic">--------
</span></span></span><span style="display:flex;"><span><span style="color:#999;font-style:italic"></span>OBJ_NAME<span style="color:#666">
</span></span></span><span style="display:flex;"><span><span style="color:#666"></span><span style="color:#999;font-style:italic">--------------------------------------------------------------------------------
</span></span></span><span style="display:flex;"><span><span style="color:#999;font-style:italic"></span>ACTION_NAME<span style="color:#666">
</span></span></span><span style="display:flex;"><span><span style="color:#666"></span><span style="color:#999;font-style:italic">--------------------------------------------------------------------------------
</span></span></span><span style="display:flex;"><span><span style="color:#999;font-style:italic"></span>PRUEBA<span style="color:#666">
</span></span></span><span style="display:flex;"><span><span style="color:#666"></span><span style="color:#3677a9">16</span>/<span style="color:#3677a9">02</span>/<span style="color:#3677a9">25</span><span style="color:#666">
</span></span></span><span style="display:flex;"><span><span style="color:#666"></span>PRUEBA1<span style="color:#666">
</span></span></span><span style="display:flex;"><span><span style="color:#666"></span><span style="color:#6ab825;font-weight:bold">SELECT</span><span style="color:#666">
</span></span></span><span style="display:flex;"><span><span style="color:#666">
</span></span></span><span style="display:flex;"><span><span style="color:#666">
</span></span></span><span style="display:flex;"><span><span style="color:#666"></span>USERNAME<span style="color:#666">
</span></span></span><span style="display:flex;"><span><span style="color:#666"></span><span style="color:#999;font-style:italic">--------------------------------------------------------------------------------
</span></span></span><span style="display:flex;"><span><span style="color:#999;font-style:italic"></span>TIMESTAM<span style="color:#666">
</span></span></span><span style="display:flex;"><span><span style="color:#666"></span><span style="color:#999;font-style:italic">--------
</span></span></span><span style="display:flex;"><span><span style="color:#999;font-style:italic"></span>OBJ_NAME<span style="color:#666">
</span></span></span><span style="display:flex;"><span><span style="color:#666"></span><span style="color:#999;font-style:italic">--------------------------------------------------------------------------------
</span></span></span><span style="display:flex;"><span><span style="color:#999;font-style:italic"></span>ACTION_NAME<span style="color:#666">
</span></span></span><span style="display:flex;"><span><span style="color:#666"></span><span style="color:#999;font-style:italic">--------------------------------------------------------------------------------
</span></span></span><span style="display:flex;"><span><span style="color:#999;font-style:italic"></span>PRUEBA<span style="color:#666">
</span></span></span><span style="display:flex;"><span><span style="color:#666"></span><span style="color:#3677a9">16</span>/<span style="color:#3677a9">02</span>/<span style="color:#3677a9">25</span><span style="color:#666">
</span></span></span><span style="display:flex;"><span><span style="color:#666"></span>PRUEBA1<span style="color:#666">
</span></span></span><span style="display:flex;"><span><span style="color:#666"></span><span style="color:#6ab825;font-weight:bold">SELECT</span><span style="color:#666">
</span></span></span><span style="display:flex;"><span><span style="color:#666">
</span></span></span><span style="display:flex;"><span><span style="color:#666"></span>USERNAME<span style="color:#666">
</span></span></span><span style="display:flex;"><span><span style="color:#666"></span><span style="color:#999;font-style:italic">--------------------------------------------------------------------------------
</span></span></span><span style="display:flex;"><span><span style="color:#999;font-style:italic"></span>TIMESTAM<span style="color:#666">
</span></span></span><span style="display:flex;"><span><span style="color:#666"></span><span style="color:#999;font-style:italic">--------
</span></span></span><span style="display:flex;"><span><span style="color:#999;font-style:italic"></span>OBJ_NAME<span style="color:#666">
</span></span></span><span style="display:flex;"><span><span style="color:#666"></span><span style="color:#999;font-style:italic">--------------------------------------------------------------------------------
</span></span></span><span style="display:flex;"><span><span style="color:#999;font-style:italic"></span>ACTION_NAME<span style="color:#666">
</span></span></span><span style="display:flex;"><span><span style="color:#666"></span><span style="color:#999;font-style:italic">--------------------------------------------------------------------------------
</span></span></span><span style="display:flex;"><span><span style="color:#999;font-style:italic"></span>PRUEBA<span style="color:#666">
</span></span></span><span style="display:flex;"><span><span style="color:#666"></span><span style="color:#3677a9">16</span>/<span style="color:#3677a9">02</span>/<span style="color:#3677a9">25</span><span style="color:#666">
</span></span></span><span style="display:flex;"><span><span style="color:#666"></span>PRUEBA1<span style="color:#666">
</span></span></span><span style="display:flex;"><span><span style="color:#666"></span><span style="color:#6ab825;font-weight:bold">UPDATE</span><span style="color:#666">
</span></span></span><span style="display:flex;"><span><span style="color:#666">
</span></span></span><span style="display:flex;"><span><span style="color:#666">
</span></span></span><span style="display:flex;"><span><span style="color:#666"></span>USERNAME<span style="color:#666">
</span></span></span><span style="display:flex;"><span><span style="color:#666"></span><span style="color:#999;font-style:italic">--------------------------------------------------------------------------------
</span></span></span><span style="display:flex;"><span><span style="color:#999;font-style:italic"></span>TIMESTAM<span style="color:#666">
</span></span></span><span style="display:flex;"><span><span style="color:#666"></span><span style="color:#999;font-style:italic">--------
</span></span></span><span style="display:flex;"><span><span style="color:#999;font-style:italic"></span>OBJ_NAME<span style="color:#666">
</span></span></span><span style="display:flex;"><span><span style="color:#666"></span><span style="color:#999;font-style:italic">--------------------------------------------------------------------------------
</span></span></span><span style="display:flex;"><span><span style="color:#999;font-style:italic"></span>ACTION_NAME<span style="color:#666">
</span></span></span><span style="display:flex;"><span><span style="color:#666"></span><span style="color:#999;font-style:italic">--------------------------------------------------------------------------------
</span></span></span><span style="display:flex;"><span><span style="color:#999;font-style:italic"></span>PRUEBA<span style="color:#666">
</span></span></span><span style="display:flex;"><span><span style="color:#666"></span><span style="color:#3677a9">16</span>/<span style="color:#3677a9">02</span>/<span style="color:#3677a9">25</span><span style="color:#666">
</span></span></span><span style="display:flex;"><span><span style="color:#666"></span>PRUEBA1<span style="color:#666">
</span></span></span><span style="display:flex;"><span><span style="color:#666"></span><span style="color:#6ab825;font-weight:bold">DELETE</span><span style="color:#666">
</span></span></span><span style="display:flex;"><span><span style="color:#666">
</span></span></span><span style="display:flex;"><span><span style="color:#666">
</span></span></span><span style="display:flex;"><span><span style="color:#666"></span><span style="color:#3677a9">15</span><span style="color:#666"> </span>filas<span style="color:#666"> </span>seleccionadas.<span style="color:#666">
</span></span></span></code></pre></div><p>Ahora bien, se puede deshabilitar esa auditoría y crear una nueva auditoría by session</p>
<div class="highlight"><pre tabindex="0" style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-sql" data-lang="sql"><span style="display:flex;"><span><span style="color:#6ab825;font-weight:bold">SQL</span>&gt;<span style="color:#666"> </span>NOAUDIT<span style="color:#666"> </span><span style="color:#6ab825;font-weight:bold">SELECT</span><span style="color:#666"> </span><span style="color:#6ab825;font-weight:bold">TABLE</span>,<span style="color:#666"> </span><span style="color:#6ab825;font-weight:bold">UPDATE</span><span style="color:#666"> </span><span style="color:#6ab825;font-weight:bold">TABLE</span>,<span style="color:#666"> </span><span style="color:#6ab825;font-weight:bold">INSERT</span><span style="color:#666"> </span><span style="color:#6ab825;font-weight:bold">TABLE</span>,<span style="color:#666"> </span><span style="color:#6ab825;font-weight:bold">DELETE</span><span style="color:#666"> </span><span style="color:#6ab825;font-weight:bold">TABLE</span><span style="color:#666"> </span><span style="color:#6ab825;font-weight:bold">BY</span><span style="color:#666"> </span>PRUEBA;<span style="color:#666">
</span></span></span><span style="display:flex;"><span><span style="color:#666">
</span></span></span><span style="display:flex;"><span><span style="color:#666"></span><span style="color:#6ab825;font-weight:bold">No</span><span style="color:#666"> </span>auditoría<span style="color:#666"> </span>terminada<span style="color:#666"> </span>correctamente.<span style="color:#666">
</span></span></span><span style="display:flex;"><span><span style="color:#666">
</span></span></span><span style="display:flex;"><span><span style="color:#666"></span><span style="color:#6ab825;font-weight:bold">SQL</span>&gt;<span style="color:#666"> </span>AUDIT<span style="color:#666"> </span><span style="color:#6ab825;font-weight:bold">SELECT</span><span style="color:#666"> </span><span style="color:#6ab825;font-weight:bold">TABLE</span>,<span style="color:#666"> </span><span style="color:#6ab825;font-weight:bold">UPDATE</span><span style="color:#666"> </span><span style="color:#6ab825;font-weight:bold">TABLE</span>,<span style="color:#666"> </span><span style="color:#6ab825;font-weight:bold">INSERT</span><span style="color:#666"> </span><span style="color:#6ab825;font-weight:bold">TABLE</span>,<span style="color:#666"> </span><span style="color:#6ab825;font-weight:bold">DELETE</span><span style="color:#666"> </span><span style="color:#6ab825;font-weight:bold">TABLE</span><span style="color:#666"> </span><span style="color:#6ab825;font-weight:bold">BY</span><span style="color:#666"> </span>PRUEBA<span style="color:#666"> </span><span style="color:#6ab825;font-weight:bold">BY</span><span style="color:#666"> </span><span style="color:#6ab825;font-weight:bold">SESSION</span>;<span style="color:#666">
</span></span></span><span style="display:flex;"><span><span style="color:#666">
</span></span></span><span style="display:flex;"><span><span style="color:#666"></span>Auditoría<span style="color:#666"> </span>terminada<span style="color:#666"> </span>correctamente.<span style="color:#666">
</span></span></span></code></pre></div><p>Al repetir, exactamente, las mismas operaciones que en el ejercicio anterior como el usuario Prueba, comprobamos que en la vista de auditoría del diccionario de datos se generan seis filas nuevas que se pueden obtener con la misma consulta.</p>
<div class="highlight"><pre tabindex="0" style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-sql" data-lang="sql"><span style="display:flex;"><span><span style="color:#6ab825;font-weight:bold">SQL</span>&gt;<span style="color:#666"> </span><span style="color:#6ab825;font-weight:bold">SELECT</span><span style="color:#666"> </span>USERNAME,<span style="color:#6ab825;font-weight:bold">TIMESTAMP</span>,OBJ_NAME,SES_ACTIONS<span style="color:#666">
</span></span></span><span style="display:flex;"><span><span style="color:#666">  </span><span style="color:#3677a9">2</span><span style="color:#666">  </span><span style="color:#6ab825;font-weight:bold">FROM</span><span style="color:#666">   </span>DBA_AUDIT_TRAIL<span style="color:#666">
</span></span></span><span style="display:flex;"><span><span style="color:#666">  </span><span style="color:#3677a9">3</span><span style="color:#666">  </span><span style="color:#6ab825;font-weight:bold">WHERE</span><span style="color:#666"> </span><span style="color:#6ab825;font-weight:bold">OWNER</span><span style="color:#666"> </span>=<span style="color:#666"> </span><span style="color:#ed9d13">&#39;PRUEBA&#39;</span><span style="color:#666">
</span></span></span><span style="display:flex;"><span><span style="color:#666">  </span><span style="color:#3677a9">4</span><span style="color:#666">  </span><span style="color:#6ab825;font-weight:bold">AND</span><span style="color:#666"> </span>ACTION_NAME<span style="color:#666"> </span>=<span style="color:#666"> </span><span style="color:#ed9d13">&#39;SESSION REC&#39;</span>;<span style="color:#666">
</span></span></span><span style="display:flex;"><span><span style="color:#666">
</span></span></span><span style="display:flex;"><span><span style="color:#666"></span>USERNAME<span style="color:#666">
</span></span></span><span style="display:flex;"><span><span style="color:#666"></span><span style="color:#999;font-style:italic">--------------------------------------------------------------------------------
</span></span></span><span style="display:flex;"><span><span style="color:#999;font-style:italic"></span>TIMESTAM<span style="color:#666">
</span></span></span><span style="display:flex;"><span><span style="color:#666"></span><span style="color:#999;font-style:italic">--------
</span></span></span><span style="display:flex;"><span><span style="color:#999;font-style:italic"></span>OBJ_NAME<span style="color:#666">
</span></span></span><span style="display:flex;"><span><span style="color:#666"></span><span style="color:#999;font-style:italic">--------------------------------------------------------------------------------
</span></span></span><span style="display:flex;"><span><span style="color:#999;font-style:italic"></span>SES_ACTIONS<span style="color:#666">
</span></span></span><span style="display:flex;"><span><span style="color:#666"></span><span style="color:#999;font-style:italic">---------------------------------------------------------
</span></span></span><span style="display:flex;"><span><span style="color:#999;font-style:italic"></span>PRUEBA<span style="color:#666">
</span></span></span><span style="display:flex;"><span><span style="color:#666"></span><span style="color:#3677a9">16</span>/<span style="color:#3677a9">02</span>/<span style="color:#3677a9">25</span><span style="color:#666">
</span></span></span><span style="display:flex;"><span><span style="color:#666"></span>PRUEBA1<span style="color:#666">
</span></span></span><span style="display:flex;"><span><span style="color:#666"></span><span style="color:#999;font-style:italic">------S---------
</span></span></span><span style="display:flex;"><span><span style="color:#999;font-style:italic"></span><span style="color:#666">
</span></span></span><span style="display:flex;"><span><span style="color:#666">
</span></span></span><span style="display:flex;"><span><span style="color:#666"></span>USERNAME<span style="color:#666">
</span></span></span><span style="display:flex;"><span><span style="color:#666"></span><span style="color:#999;font-style:italic">--------------------------------------------------------------------------------
</span></span></span><span style="display:flex;"><span><span style="color:#999;font-style:italic"></span>TIMESTAM<span style="color:#666">
</span></span></span><span style="display:flex;"><span><span style="color:#666"></span><span style="color:#999;font-style:italic">--------
</span></span></span><span style="display:flex;"><span><span style="color:#999;font-style:italic"></span>OBJ_NAME<span style="color:#666">
</span></span></span><span style="display:flex;"><span><span style="color:#666"></span><span style="color:#999;font-style:italic">--------------------------------------------------------------------------------
</span></span></span><span style="display:flex;"><span><span style="color:#999;font-style:italic"></span>SES_ACTIONS<span style="color:#666">
</span></span></span><span style="display:flex;"><span><span style="color:#666"></span><span style="color:#999;font-style:italic">---------------------------------------------------------
</span></span></span><span style="display:flex;"><span><span style="color:#999;font-style:italic"></span>PRUEBA<span style="color:#666">
</span></span></span><span style="display:flex;"><span><span style="color:#666"></span><span style="color:#3677a9">16</span>/<span style="color:#3677a9">02</span>/<span style="color:#3677a9">25</span><span style="color:#666">
</span></span></span><span style="display:flex;"><span><span style="color:#666"></span>PRUEBA1<span style="color:#666">
</span></span></span><span style="display:flex;"><span><span style="color:#666"></span><span style="color:#999;font-style:italic">------S---------
</span></span></span><span style="display:flex;"><span><span style="color:#999;font-style:italic"></span><span style="color:#666">
</span></span></span><span style="display:flex;"><span><span style="color:#666">
</span></span></span><span style="display:flex;"><span><span style="color:#666"></span>USERNAME<span style="color:#666">
</span></span></span><span style="display:flex;"><span><span style="color:#666"></span><span style="color:#999;font-style:italic">--------------------------------------------------------------------------------
</span></span></span><span style="display:flex;"><span><span style="color:#999;font-style:italic"></span>TIMESTAM<span style="color:#666">
</span></span></span><span style="display:flex;"><span><span style="color:#666"></span><span style="color:#999;font-style:italic">--------
</span></span></span><span style="display:flex;"><span><span style="color:#999;font-style:italic"></span>OBJ_NAME<span style="color:#666">
</span></span></span><span style="display:flex;"><span><span style="color:#666"></span><span style="color:#999;font-style:italic">--------------------------------------------------------------------------------
</span></span></span><span style="display:flex;"><span><span style="color:#999;font-style:italic"></span>SES_ACTIONS<span style="color:#666">
</span></span></span><span style="display:flex;"><span><span style="color:#666"></span><span style="color:#999;font-style:italic">---------------------------------------------------------
</span></span></span><span style="display:flex;"><span><span style="color:#999;font-style:italic"></span>PRUEBA<span style="color:#666">
</span></span></span><span style="display:flex;"><span><span style="color:#666"></span><span style="color:#3677a9">16</span>/<span style="color:#3677a9">02</span>/<span style="color:#3677a9">25</span><span style="color:#666">
</span></span></span><span style="display:flex;"><span><span style="color:#666"></span>PRUEBA1<span style="color:#666">
</span></span></span><span style="display:flex;"><span><span style="color:#666"></span><span style="color:#999;font-style:italic">------S---------
</span></span></span><span style="display:flex;"><span><span style="color:#999;font-style:italic"></span><span style="color:#666">
</span></span></span><span style="display:flex;"><span><span style="color:#666">
</span></span></span><span style="display:flex;"><span><span style="color:#666"></span>USERNAME<span style="color:#666">
</span></span></span><span style="display:flex;"><span><span style="color:#666"></span><span style="color:#999;font-style:italic">--------------------------------------------------------------------------------
</span></span></span><span style="display:flex;"><span><span style="color:#999;font-style:italic"></span>TIMESTAM<span style="color:#666">
</span></span></span><span style="display:flex;"><span><span style="color:#666"></span><span style="color:#999;font-style:italic">--------
</span></span></span><span style="display:flex;"><span><span style="color:#999;font-style:italic"></span>OBJ_NAME<span style="color:#666">
</span></span></span><span style="display:flex;"><span><span style="color:#666"></span><span style="color:#999;font-style:italic">--------------------------------------------------------------------------------
</span></span></span><span style="display:flex;"><span><span style="color:#999;font-style:italic"></span>SES_ACTIONS<span style="color:#666">
</span></span></span><span style="display:flex;"><span><span style="color:#666"></span><span style="color:#999;font-style:italic">---------------------------------------------------------
</span></span></span><span style="display:flex;"><span><span style="color:#999;font-style:italic"></span>PRUEBA<span style="color:#666">
</span></span></span><span style="display:flex;"><span><span style="color:#666"></span><span style="color:#3677a9">16</span>/<span style="color:#3677a9">02</span>/<span style="color:#3677a9">25</span><span style="color:#666">
</span></span></span><span style="display:flex;"><span><span style="color:#666"></span>PRUEBA1<span style="color:#666">
</span></span></span><span style="display:flex;"><span><span style="color:#666"></span><span style="color:#999;font-style:italic">----------S-----
</span></span></span><span style="display:flex;"><span><span style="color:#999;font-style:italic"></span><span style="color:#666">
</span></span></span><span style="display:flex;"><span><span style="color:#666">
</span></span></span><span style="display:flex;"><span><span style="color:#666"></span>USERNAME<span style="color:#666">
</span></span></span><span style="display:flex;"><span><span style="color:#666"></span><span style="color:#999;font-style:italic">--------------------------------------------------------------------------------
</span></span></span><span style="display:flex;"><span><span style="color:#999;font-style:italic"></span>TIMESTAM<span style="color:#666">
</span></span></span><span style="display:flex;"><span><span style="color:#666"></span><span style="color:#999;font-style:italic">--------
</span></span></span><span style="display:flex;"><span><span style="color:#999;font-style:italic"></span>OBJ_NAME<span style="color:#666">
</span></span></span><span style="display:flex;"><span><span style="color:#666"></span><span style="color:#999;font-style:italic">--------------------------------------------------------------------------------
</span></span></span><span style="display:flex;"><span><span style="color:#999;font-style:italic"></span>SES_ACTIONS<span style="color:#666">
</span></span></span><span style="display:flex;"><span><span style="color:#666"></span><span style="color:#999;font-style:italic">---------------------------------------------------------
</span></span></span><span style="display:flex;"><span><span style="color:#999;font-style:italic"></span>PRUEBA<span style="color:#666">
</span></span></span><span style="display:flex;"><span><span style="color:#666"></span><span style="color:#3677a9">16</span>/<span style="color:#3677a9">02</span>/<span style="color:#3677a9">25</span><span style="color:#666">
</span></span></span><span style="display:flex;"><span><span style="color:#666"></span>PRUEBA1<span style="color:#666">
</span></span></span><span style="display:flex;"><span><span style="color:#666"></span><span style="color:#999;font-style:italic">---S------------
</span></span></span><span style="display:flex;"><span><span style="color:#999;font-style:italic"></span><span style="color:#666">
</span></span></span><span style="display:flex;"><span><span style="color:#666">
</span></span></span><span style="display:flex;"><span><span style="color:#666"></span>USERNAME<span style="color:#666">
</span></span></span><span style="display:flex;"><span><span style="color:#666"></span><span style="color:#999;font-style:italic">--------------------------------------------------------------------------------
</span></span></span><span style="display:flex;"><span><span style="color:#999;font-style:italic"></span>TIMESTAM<span style="color:#666">
</span></span></span><span style="display:flex;"><span><span style="color:#666"></span><span style="color:#999;font-style:italic">--------
</span></span></span><span style="display:flex;"><span><span style="color:#999;font-style:italic"></span>OBJ_NAME<span style="color:#666">
</span></span></span><span style="display:flex;"><span><span style="color:#666"></span><span style="color:#999;font-style:italic">--------------------------------------------------------------------------------
</span></span></span><span style="display:flex;"><span><span style="color:#999;font-style:italic"></span>SES_ACTIONS<span style="color:#666">
</span></span></span><span style="display:flex;"><span><span style="color:#666"></span><span style="color:#999;font-style:italic">---------------------------------------------------------
</span></span></span><span style="display:flex;"><span><span style="color:#999;font-style:italic"></span>PRUEBA<span style="color:#666">
</span></span></span><span style="display:flex;"><span><span style="color:#666"></span><span style="color:#3677a9">16</span>/<span style="color:#3677a9">02</span>/<span style="color:#3677a9">25</span><span style="color:#666">
</span></span></span><span style="display:flex;"><span><span style="color:#666"></span>PRUEBA1<span style="color:#666">
</span></span></span><span style="display:flex;"><span><span style="color:#666"></span><span style="color:#999;font-style:italic">---------S------
</span></span></span><span style="display:flex;"><span><span style="color:#999;font-style:italic"></span><span style="color:#666">
</span></span></span><span style="display:flex;"><span><span style="color:#666">
</span></span></span><span style="display:flex;"><span><span style="color:#666"></span><span style="color:#3677a9">6</span><span style="color:#666"> </span>filas<span style="color:#666"> </span>seleccionadas.<span style="color:#666">
</span></span></span></code></pre></div><p>En este caso, en el campo <code>ACTION_NAME</code> no aparece el nombre de la operación sino el término <code>SESSION REC</code>, que indica que se trata de una entrada generada por una auditoría by session. En cambio, en el campo <code>SES_ACTIONS</code>, que en las entradas generadas por una auditoría by access está vacío, muestra esta información.</p>
<p>Esta campo resume la sesión a través de una cadena de 16 caracteres. Cada uno de ellos representa una acción en este orden:</p>
<ol>
<li>ALTER</li>
<li>AUDIT</li>
<li>COMMENT</li>
<li>DELETE</li>
<li>GRANT</li>
<li>INDEX</li>
<li>INSERT</li>
<li>LOCK</li>
<li>RENAME</li>
<li>SELECT</li>
<li>UPDATE</li>
<li>REFERENCES</li>
<li>EXECUTE</li>
<li>Posición reservada para usar en el futuro</li>
<li>Posición reservada para usar en el futuro</li>
<li>Posición reservada para usar en el futuro</li>
</ol>
<p>Estos caracteres pueden tomar los siguientes valores para indicar el resultado de la acción:</p>
<table>
  <thead>
      <tr>
          <th>Carácter</th>
          <th>Resultado</th>
      </tr>
  </thead>
  <tbody>
      <tr>
          <td>-</td>
          <td>Nada</td>
      </tr>
      <tr>
          <td>S</td>
          <td>Éxito</td>
      </tr>
      <tr>
          <td>F</td>
          <td>Fracaso</td>
      </tr>
      <tr>
          <td>B</td>
          <td>Ambos</td>
      </tr>
  </tbody>
</table>
<p>Así, el siguiente resultado de la consulta indica que, durante la sesión, el usuario Prueba ejecutó una acción de DELETE exitosamente:</p>
<div class="highlight"><pre tabindex="0" style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-sql" data-lang="sql"><span style="display:flex;"><span>USERNAME<span style="color:#666">
</span></span></span><span style="display:flex;"><span><span style="color:#666"></span><span style="color:#999;font-style:italic">--------------------------------------------------------------------------------
</span></span></span><span style="display:flex;"><span><span style="color:#999;font-style:italic"></span>TIMESTAM<span style="color:#666">
</span></span></span><span style="display:flex;"><span><span style="color:#666"></span><span style="color:#999;font-style:italic">--------
</span></span></span><span style="display:flex;"><span><span style="color:#999;font-style:italic"></span>OBJ_NAME<span style="color:#666">
</span></span></span><span style="display:flex;"><span><span style="color:#666"></span><span style="color:#999;font-style:italic">--------------------------------------------------------------------------------
</span></span></span><span style="display:flex;"><span><span style="color:#999;font-style:italic"></span>SES_ACTIONS<span style="color:#666">
</span></span></span><span style="display:flex;"><span><span style="color:#666"></span><span style="color:#999;font-style:italic">---------------------------------------------------------
</span></span></span><span style="display:flex;"><span><span style="color:#999;font-style:italic"></span>PRUEBA<span style="color:#666">
</span></span></span><span style="display:flex;"><span><span style="color:#666"></span><span style="color:#3677a9">16</span>/<span style="color:#3677a9">02</span>/<span style="color:#3677a9">25</span><span style="color:#666">
</span></span></span><span style="display:flex;"><span><span style="color:#666"></span>PRUEBA1<span style="color:#666">
</span></span></span><span style="display:flex;"><span><span style="color:#666"></span><span style="color:#999;font-style:italic">---S------------
</span></span></span></code></pre></div><h1 id="documenta-las-diferencias-entre-los-valores-db-y-db-extended-del-parámetro-audit_trail-de-oracle-demuéstralas-poniendo-un-ejemplo-de-la-información-sobre-una-operación-concreta-recopilada-con-cada-uno-de-ellos">Documenta las diferencias entre los valores db y db, extended del parámetro audit_trail de ORACLE. Demuéstralas poniendo un ejemplo de la información sobre una operación concreta recopilada con cada uno de ellos.</h1>
<p>El parámetro <code>audit_trail</code> habilita o deshabilita la auditoría a nivel de la base de datos en Oracle. Este parámetro puede tomar varios valores. Entre ellos, la auditoría se puede activar indicando el valor <code>db</code> o el valor <code>db, extended</code>.</p>
<p>Cuando el parámetro <code>audit_trail</code> toma el valor <code>db</code> los registros de la auditoría se dirigen a la tabla de registros de auditoría (SYS.AUD$), excepto para aquellos registros que se escriben siempre en el registro de auditoría del sistema operativo. Esta configuración se suele usar en bases de datos de propósito general para facilitar su manejo.</p>
<p>Cuando el parámetro <code>audit_trail</code> toma el valor <code>db, extended</code> la auditoría ejecuta las mismas acciones que cuando toma el valor <code>db</code> pero, además, rellena las columnas <code>SQL BIND</code> y <code>SQL TEXT</code> de la vista SYS.AUD$ cuando sea posible.</p>
<p>Se puede modificar este parámetro en caliente usando la sentencia <code>alter system set AUDIT_TRAIL=db scope=spfile;</code> o <code>alter system set AUDIT_TRAIL=db, extended scope=spfile;</code>.</p>
<p>De nuevo, para ejemplificar la diferencia entre ambos valores del parámetro <code>audit_trail</code> se puede tomar como referencia el <a href="#activa-la-auditor%c3%ada-de-las-operaciones-dml-realizadas-por-el-usuario-prueba-en-tablas-de-su-esquema-comprueba-su-funcionamiento"



 


>ejercicio 3</a>. En este caso, el valor del parámetro <code>audit_trail</code> es <code>db</code>.</p>
<div class="highlight"><pre tabindex="0" style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-SQL" data-lang="SQL"><span style="display:flex;"><span><span style="color:#6ab825;font-weight:bold">SQL</span>&gt;<span style="color:#666"> </span><span style="color:#6ab825;font-weight:bold">show</span><span style="color:#666"> </span><span style="color:#6ab825;font-weight:bold">parameter</span><span style="color:#666"> </span>audit_trail;<span style="color:#666">
</span></span></span><span style="display:flex;"><span><span style="color:#666">
</span></span></span><span style="display:flex;"><span><span style="color:#666"></span>NAME<span style="color:#666">				     </span><span style="color:#6ab825;font-weight:bold">TYPE</span><span style="color:#666">
</span></span></span><span style="display:flex;"><span><span style="color:#666"></span><span style="color:#999;font-style:italic">------------------------------------ ---------------------------------
</span></span></span><span style="display:flex;"><span><span style="color:#999;font-style:italic"></span>VALUE<span style="color:#666">
</span></span></span><span style="display:flex;"><span><span style="color:#666"></span><span style="color:#999;font-style:italic">------------------------------
</span></span></span><span style="display:flex;"><span><span style="color:#999;font-style:italic"></span>audit_trail<span style="color:#666">			     </span>string<span style="color:#666">
</span></span></span><span style="display:flex;"><span><span style="color:#666"></span>DB<span style="color:#666">
</span></span></span></code></pre></div><p>Por eso, en la vista <code>DBA_AUDIT_TRAIL</code> el campo <code>SQL_TEXT</code> está vacío.</p>
<div class="highlight"><pre tabindex="0" style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-SQL" data-lang="SQL"><span style="display:flex;"><span><span style="color:#6ab825;font-weight:bold">SQL</span>&gt;<span style="color:#666"> </span><span style="color:#6ab825;font-weight:bold">SELECT</span><span style="color:#666"> </span>SQL_BIND,SQL_TEXT,<span style="color:#6ab825;font-weight:bold">TIMESTAMP</span>,OBJ_NAME,ACTION_NAME<span style="color:#666">
</span></span></span><span style="display:flex;"><span><span style="color:#666">  </span><span style="color:#3677a9">2</span><span style="color:#666">  </span><span style="color:#6ab825;font-weight:bold">FROM</span><span style="color:#666">   </span>DBA_AUDIT_TRAIL<span style="color:#666">
</span></span></span><span style="display:flex;"><span><span style="color:#666">  </span><span style="color:#3677a9">3</span><span style="color:#666">  </span><span style="color:#6ab825;font-weight:bold">WHERE</span><span style="color:#666"> </span><span style="color:#6ab825;font-weight:bold">OWNER</span><span style="color:#666"> </span>=<span style="color:#666"> </span><span style="color:#ed9d13">&#39;PRUEBA&#39;</span><span style="color:#666">
</span></span></span><span style="display:flex;"><span><span style="color:#666">  </span><span style="color:#3677a9">4</span><span style="color:#666">  </span><span style="color:#6ab825;font-weight:bold">AND</span><span style="color:#666"> </span>ACTION_NAME<span style="color:#666"> </span>!=<span style="color:#666"> </span><span style="color:#ed9d13">&#39;SESSION REC&#39;</span>;<span style="color:#666">
</span></span></span><span style="display:flex;"><span><span style="color:#666">
</span></span></span><span style="display:flex;"><span><span style="color:#666"></span>SQL_TEXT<span style="color:#666">
</span></span></span><span style="display:flex;"><span><span style="color:#666"></span><span style="color:#999;font-style:italic">--------------------------------------------------------------------------------
</span></span></span><span style="display:flex;"><span><span style="color:#999;font-style:italic"></span>TIMESTAM<span style="color:#666">
</span></span></span><span style="display:flex;"><span><span style="color:#666"></span><span style="color:#999;font-style:italic">--------
</span></span></span><span style="display:flex;"><span><span style="color:#999;font-style:italic"></span>OBJ_NAME<span style="color:#666">
</span></span></span><span style="display:flex;"><span><span style="color:#666"></span><span style="color:#999;font-style:italic">--------------------------------------------------------------------------------
</span></span></span><span style="display:flex;"><span><span style="color:#999;font-style:italic"></span>ACTION_NAME<span style="color:#666">
</span></span></span><span style="display:flex;"><span><span style="color:#666"></span><span style="color:#999;font-style:italic">--------------------------------------------------------------------------------
</span></span></span><span style="display:flex;"><span><span style="color:#999;font-style:italic"></span><span style="color:#666">
</span></span></span><span style="display:flex;"><span><span style="color:#666"></span><span style="color:#3677a9">16</span>/<span style="color:#3677a9">02</span>/<span style="color:#3677a9">25</span><span style="color:#666">
</span></span></span><span style="display:flex;"><span><span style="color:#666"></span>PRUEBA1<span style="color:#666">
</span></span></span><span style="display:flex;"><span><span style="color:#666"></span><span style="color:#6ab825;font-weight:bold">INSERT</span><span style="color:#666">
</span></span></span><span style="display:flex;"><span><span style="color:#666">
</span></span></span><span style="display:flex;"><span><span style="color:#666">
</span></span></span><span style="display:flex;"><span><span style="color:#666"></span>SQL_TEXT<span style="color:#666">
</span></span></span><span style="display:flex;"><span><span style="color:#666"></span><span style="color:#999;font-style:italic">--------------------------------------------------------------------------------
</span></span></span><span style="display:flex;"><span><span style="color:#999;font-style:italic"></span>TIMESTAM<span style="color:#666">
</span></span></span><span style="display:flex;"><span><span style="color:#666"></span><span style="color:#999;font-style:italic">--------
</span></span></span><span style="display:flex;"><span><span style="color:#999;font-style:italic"></span>OBJ_NAME<span style="color:#666">
</span></span></span><span style="display:flex;"><span><span style="color:#666"></span><span style="color:#999;font-style:italic">--------------------------------------------------------------------------------
</span></span></span><span style="display:flex;"><span><span style="color:#999;font-style:italic"></span>ACTION_NAME<span style="color:#666">
</span></span></span><span style="display:flex;"><span><span style="color:#666"></span><span style="color:#999;font-style:italic">--------------------------------------------------------------------------------
</span></span></span><span style="display:flex;"><span><span style="color:#999;font-style:italic"></span><span style="color:#666">
</span></span></span><span style="display:flex;"><span><span style="color:#666"></span><span style="color:#3677a9">16</span>/<span style="color:#3677a9">02</span>/<span style="color:#3677a9">25</span><span style="color:#666">
</span></span></span><span style="display:flex;"><span><span style="color:#666"></span>PRUEBA1<span style="color:#666">
</span></span></span><span style="display:flex;"><span><span style="color:#666"></span><span style="color:#6ab825;font-weight:bold">INSERT</span><span style="color:#666">
</span></span></span><span style="display:flex;"><span><span style="color:#666">
</span></span></span><span style="display:flex;"><span><span style="color:#666">
</span></span></span><span style="display:flex;"><span><span style="color:#666"></span>SQL_TEXT<span style="color:#666">
</span></span></span><span style="display:flex;"><span><span style="color:#666"></span><span style="color:#999;font-style:italic">--------------------------------------------------------------------------------
</span></span></span><span style="display:flex;"><span><span style="color:#999;font-style:italic"></span>TIMESTAM<span style="color:#666">
</span></span></span><span style="display:flex;"><span><span style="color:#666"></span><span style="color:#999;font-style:italic">--------
</span></span></span><span style="display:flex;"><span><span style="color:#999;font-style:italic"></span>OBJ_NAME<span style="color:#666">
</span></span></span><span style="display:flex;"><span><span style="color:#666"></span><span style="color:#999;font-style:italic">--------------------------------------------------------------------------------
</span></span></span><span style="display:flex;"><span><span style="color:#999;font-style:italic"></span>ACTION_NAME<span style="color:#666">
</span></span></span><span style="display:flex;"><span><span style="color:#666"></span><span style="color:#999;font-style:italic">--------------------------------------------------------------------------------
</span></span></span><span style="display:flex;"><span><span style="color:#999;font-style:italic"></span><span style="color:#666">
</span></span></span><span style="display:flex;"><span><span style="color:#666"></span><span style="color:#3677a9">16</span>/<span style="color:#3677a9">02</span>/<span style="color:#3677a9">25</span><span style="color:#666">
</span></span></span><span style="display:flex;"><span><span style="color:#666"></span>PRUEBA1<span style="color:#666">
</span></span></span><span style="display:flex;"><span><span style="color:#666"></span><span style="color:#6ab825;font-weight:bold">INSERT</span><span style="color:#666">
</span></span></span><span style="display:flex;"><span><span style="color:#666">
</span></span></span><span style="display:flex;"><span><span style="color:#666">
</span></span></span><span style="display:flex;"><span><span style="color:#666"></span>SQL_TEXT<span style="color:#666">
</span></span></span><span style="display:flex;"><span><span style="color:#666"></span><span style="color:#999;font-style:italic">--------------------------------------------------------------------------------
</span></span></span><span style="display:flex;"><span><span style="color:#999;font-style:italic"></span>TIMESTAM<span style="color:#666">
</span></span></span><span style="display:flex;"><span><span style="color:#666"></span><span style="color:#999;font-style:italic">--------
</span></span></span><span style="display:flex;"><span><span style="color:#999;font-style:italic"></span>OBJ_NAME<span style="color:#666">
</span></span></span><span style="display:flex;"><span><span style="color:#666"></span><span style="color:#999;font-style:italic">--------------------------------------------------------------------------------
</span></span></span><span style="display:flex;"><span><span style="color:#999;font-style:italic"></span>ACTION_NAME<span style="color:#666">
</span></span></span><span style="display:flex;"><span><span style="color:#666"></span><span style="color:#999;font-style:italic">--------------------------------------------------------------------------------
</span></span></span><span style="display:flex;"><span><span style="color:#999;font-style:italic"></span><span style="color:#666">
</span></span></span><span style="display:flex;"><span><span style="color:#666"></span><span style="color:#3677a9">16</span>/<span style="color:#3677a9">02</span>/<span style="color:#3677a9">25</span><span style="color:#666">
</span></span></span><span style="display:flex;"><span><span style="color:#666"></span>PRUEBA1<span style="color:#666">
</span></span></span><span style="display:flex;"><span><span style="color:#666"></span><span style="color:#6ab825;font-weight:bold">INSERT</span><span style="color:#666">
</span></span></span><span style="display:flex;"><span><span style="color:#666">
</span></span></span><span style="display:flex;"><span><span style="color:#666">
</span></span></span><span style="display:flex;"><span><span style="color:#666"></span>SQL_TEXT<span style="color:#666">
</span></span></span><span style="display:flex;"><span><span style="color:#666"></span><span style="color:#999;font-style:italic">--------------------------------------------------------------------------------
</span></span></span><span style="display:flex;"><span><span style="color:#999;font-style:italic"></span>TIMESTAM<span style="color:#666">
</span></span></span><span style="display:flex;"><span><span style="color:#666"></span><span style="color:#999;font-style:italic">--------
</span></span></span><span style="display:flex;"><span><span style="color:#999;font-style:italic"></span>OBJ_NAME<span style="color:#666">
</span></span></span><span style="display:flex;"><span><span style="color:#666"></span><span style="color:#999;font-style:italic">--------------------------------------------------------------------------------
</span></span></span><span style="display:flex;"><span><span style="color:#999;font-style:italic"></span>ACTION_NAME<span style="color:#666">
</span></span></span><span style="display:flex;"><span><span style="color:#666"></span><span style="color:#999;font-style:italic">--------------------------------------------------------------------------------
</span></span></span><span style="display:flex;"><span><span style="color:#999;font-style:italic"></span><span style="color:#666">
</span></span></span><span style="display:flex;"><span><span style="color:#666"></span><span style="color:#3677a9">16</span>/<span style="color:#3677a9">02</span>/<span style="color:#3677a9">25</span><span style="color:#666">
</span></span></span><span style="display:flex;"><span><span style="color:#666"></span>PRUEBA1<span style="color:#666">
</span></span></span><span style="display:flex;"><span><span style="color:#666"></span><span style="color:#6ab825;font-weight:bold">INSERT</span><span style="color:#666">
</span></span></span><span style="display:flex;"><span><span style="color:#666">
</span></span></span><span style="display:flex;"><span><span style="color:#666">
</span></span></span><span style="display:flex;"><span><span style="color:#666"></span>SQL_TEXT<span style="color:#666">
</span></span></span><span style="display:flex;"><span><span style="color:#666"></span><span style="color:#999;font-style:italic">--------------------------------------------------------------------------------
</span></span></span><span style="display:flex;"><span><span style="color:#999;font-style:italic"></span>TIMESTAM<span style="color:#666">
</span></span></span><span style="display:flex;"><span><span style="color:#666"></span><span style="color:#999;font-style:italic">--------
</span></span></span><span style="display:flex;"><span><span style="color:#999;font-style:italic"></span>OBJ_NAME<span style="color:#666">
</span></span></span><span style="display:flex;"><span><span style="color:#666"></span><span style="color:#999;font-style:italic">--------------------------------------------------------------------------------
</span></span></span><span style="display:flex;"><span><span style="color:#999;font-style:italic"></span>ACTION_NAME<span style="color:#666">
</span></span></span><span style="display:flex;"><span><span style="color:#666"></span><span style="color:#999;font-style:italic">--------------------------------------------------------------------------------
</span></span></span><span style="display:flex;"><span><span style="color:#999;font-style:italic"></span><span style="color:#666">
</span></span></span><span style="display:flex;"><span><span style="color:#666"></span><span style="color:#3677a9">16</span>/<span style="color:#3677a9">02</span>/<span style="color:#3677a9">25</span><span style="color:#666">
</span></span></span><span style="display:flex;"><span><span style="color:#666"></span>PRUEBA1<span style="color:#666">
</span></span></span><span style="display:flex;"><span><span style="color:#666"></span><span style="color:#6ab825;font-weight:bold">SELECT</span><span style="color:#666">
</span></span></span><span style="display:flex;"><span><span style="color:#666">
</span></span></span><span style="display:flex;"><span><span style="color:#666">
</span></span></span><span style="display:flex;"><span><span style="color:#666"></span>SQL_TEXT<span style="color:#666">
</span></span></span><span style="display:flex;"><span><span style="color:#666"></span><span style="color:#999;font-style:italic">--------------------------------------------------------------------------------
</span></span></span><span style="display:flex;"><span><span style="color:#999;font-style:italic"></span>TIMESTAM<span style="color:#666">
</span></span></span><span style="display:flex;"><span><span style="color:#666"></span><span style="color:#999;font-style:italic">--------
</span></span></span><span style="display:flex;"><span><span style="color:#999;font-style:italic"></span>OBJ_NAME<span style="color:#666">
</span></span></span><span style="display:flex;"><span><span style="color:#666"></span><span style="color:#999;font-style:italic">--------------------------------------------------------------------------------
</span></span></span><span style="display:flex;"><span><span style="color:#999;font-style:italic"></span>ACTION_NAME<span style="color:#666">
</span></span></span><span style="display:flex;"><span><span style="color:#666"></span><span style="color:#999;font-style:italic">--------------------------------------------------------------------------------
</span></span></span><span style="display:flex;"><span><span style="color:#999;font-style:italic"></span><span style="color:#666">
</span></span></span><span style="display:flex;"><span><span style="color:#666"></span><span style="color:#3677a9">16</span>/<span style="color:#3677a9">02</span>/<span style="color:#3677a9">25</span><span style="color:#666">
</span></span></span><span style="display:flex;"><span><span style="color:#666"></span>PRUEBA1<span style="color:#666">
</span></span></span><span style="display:flex;"><span><span style="color:#666"></span><span style="color:#6ab825;font-weight:bold">INSERT</span><span style="color:#666">
</span></span></span><span style="display:flex;"><span><span style="color:#666">
</span></span></span><span style="display:flex;"><span><span style="color:#666">
</span></span></span><span style="display:flex;"><span><span style="color:#666"></span>SQL_TEXT<span style="color:#666">
</span></span></span><span style="display:flex;"><span><span style="color:#666"></span><span style="color:#999;font-style:italic">--------------------------------------------------------------------------------
</span></span></span><span style="display:flex;"><span><span style="color:#999;font-style:italic"></span>TIMESTAM<span style="color:#666">
</span></span></span><span style="display:flex;"><span><span style="color:#666"></span><span style="color:#999;font-style:italic">--------
</span></span></span><span style="display:flex;"><span><span style="color:#999;font-style:italic"></span>OBJ_NAME<span style="color:#666">
</span></span></span><span style="display:flex;"><span><span style="color:#666"></span><span style="color:#999;font-style:italic">--------------------------------------------------------------------------------
</span></span></span><span style="display:flex;"><span><span style="color:#999;font-style:italic"></span>ACTION_NAME<span style="color:#666">
</span></span></span><span style="display:flex;"><span><span style="color:#666"></span><span style="color:#999;font-style:italic">--------------------------------------------------------------------------------
</span></span></span><span style="display:flex;"><span><span style="color:#999;font-style:italic"></span><span style="color:#666">
</span></span></span><span style="display:flex;"><span><span style="color:#666"></span><span style="color:#3677a9">16</span>/<span style="color:#3677a9">02</span>/<span style="color:#3677a9">25</span><span style="color:#666">
</span></span></span><span style="display:flex;"><span><span style="color:#666"></span>PRUEBA1<span style="color:#666">
</span></span></span><span style="display:flex;"><span><span style="color:#666"></span><span style="color:#6ab825;font-weight:bold">INSERT</span><span style="color:#666">
</span></span></span><span style="display:flex;"><span><span style="color:#666">
</span></span></span><span style="display:flex;"><span><span style="color:#666">
</span></span></span><span style="display:flex;"><span><span style="color:#666"></span>SQL_TEXT<span style="color:#666">
</span></span></span><span style="display:flex;"><span><span style="color:#666"></span><span style="color:#999;font-style:italic">--------------------------------------------------------------------------------
</span></span></span><span style="display:flex;"><span><span style="color:#999;font-style:italic"></span>TIMESTAM<span style="color:#666">
</span></span></span><span style="display:flex;"><span><span style="color:#666"></span><span style="color:#999;font-style:italic">--------
</span></span></span><span style="display:flex;"><span><span style="color:#999;font-style:italic"></span>OBJ_NAME<span style="color:#666">
</span></span></span><span style="display:flex;"><span><span style="color:#666"></span><span style="color:#999;font-style:italic">--------------------------------------------------------------------------------
</span></span></span><span style="display:flex;"><span><span style="color:#999;font-style:italic"></span>ACTION_NAME<span style="color:#666">
</span></span></span><span style="display:flex;"><span><span style="color:#666"></span><span style="color:#999;font-style:italic">--------------------------------------------------------------------------------
</span></span></span><span style="display:flex;"><span><span style="color:#999;font-style:italic"></span><span style="color:#666">
</span></span></span><span style="display:flex;"><span><span style="color:#666"></span><span style="color:#3677a9">16</span>/<span style="color:#3677a9">02</span>/<span style="color:#3677a9">25</span><span style="color:#666">
</span></span></span><span style="display:flex;"><span><span style="color:#666"></span>PRUEBA1<span style="color:#666">
</span></span></span><span style="display:flex;"><span><span style="color:#666"></span><span style="color:#6ab825;font-weight:bold">SELECT</span><span style="color:#666">
</span></span></span><span style="display:flex;"><span><span style="color:#666">
</span></span></span><span style="display:flex;"><span><span style="color:#666">
</span></span></span><span style="display:flex;"><span><span style="color:#666"></span>SQL_TEXT<span style="color:#666">
</span></span></span><span style="display:flex;"><span><span style="color:#666"></span><span style="color:#999;font-style:italic">--------------------------------------------------------------------------------
</span></span></span><span style="display:flex;"><span><span style="color:#999;font-style:italic"></span>TIMESTAM<span style="color:#666">
</span></span></span><span style="display:flex;"><span><span style="color:#666"></span><span style="color:#999;font-style:italic">--------
</span></span></span><span style="display:flex;"><span><span style="color:#999;font-style:italic"></span>OBJ_NAME<span style="color:#666">
</span></span></span><span style="display:flex;"><span><span style="color:#666"></span><span style="color:#999;font-style:italic">--------------------------------------------------------------------------------
</span></span></span><span style="display:flex;"><span><span style="color:#999;font-style:italic"></span>ACTION_NAME<span style="color:#666">
</span></span></span><span style="display:flex;"><span><span style="color:#666"></span><span style="color:#999;font-style:italic">--------------------------------------------------------------------------------
</span></span></span><span style="display:flex;"><span><span style="color:#999;font-style:italic"></span><span style="color:#666">
</span></span></span><span style="display:flex;"><span><span style="color:#666"></span><span style="color:#3677a9">16</span>/<span style="color:#3677a9">02</span>/<span style="color:#3677a9">25</span><span style="color:#666">
</span></span></span><span style="display:flex;"><span><span style="color:#666"></span>PRUEBA1<span style="color:#666">
</span></span></span><span style="display:flex;"><span><span style="color:#666"></span><span style="color:#6ab825;font-weight:bold">INSERT</span><span style="color:#666">
</span></span></span><span style="display:flex;"><span><span style="color:#666">
</span></span></span><span style="display:flex;"><span><span style="color:#666">
</span></span></span><span style="display:flex;"><span><span style="color:#666"></span>SQL_TEXT<span style="color:#666">
</span></span></span><span style="display:flex;"><span><span style="color:#666"></span><span style="color:#999;font-style:italic">--------------------------------------------------------------------------------
</span></span></span><span style="display:flex;"><span><span style="color:#999;font-style:italic"></span>TIMESTAM<span style="color:#666">
</span></span></span><span style="display:flex;"><span><span style="color:#666"></span><span style="color:#999;font-style:italic">--------
</span></span></span><span style="display:flex;"><span><span style="color:#999;font-style:italic"></span>OBJ_NAME<span style="color:#666">
</span></span></span><span style="display:flex;"><span><span style="color:#666"></span><span style="color:#999;font-style:italic">--------------------------------------------------------------------------------
</span></span></span><span style="display:flex;"><span><span style="color:#999;font-style:italic"></span>ACTION_NAME<span style="color:#666">
</span></span></span><span style="display:flex;"><span><span style="color:#666"></span><span style="color:#999;font-style:italic">--------------------------------------------------------------------------------
</span></span></span><span style="display:flex;"><span><span style="color:#999;font-style:italic"></span><span style="color:#666">
</span></span></span><span style="display:flex;"><span><span style="color:#666"></span><span style="color:#3677a9">16</span>/<span style="color:#3677a9">02</span>/<span style="color:#3677a9">25</span><span style="color:#666">
</span></span></span><span style="display:flex;"><span><span style="color:#666"></span>PRUEBA1<span style="color:#666">
</span></span></span><span style="display:flex;"><span><span style="color:#666"></span><span style="color:#6ab825;font-weight:bold">INSERT</span><span style="color:#666">
</span></span></span><span style="display:flex;"><span><span style="color:#666">
</span></span></span><span style="display:flex;"><span><span style="color:#666">
</span></span></span><span style="display:flex;"><span><span style="color:#666"></span>SQL_TEXT<span style="color:#666">
</span></span></span><span style="display:flex;"><span><span style="color:#666"></span><span style="color:#999;font-style:italic">--------------------------------------------------------------------------------
</span></span></span><span style="display:flex;"><span><span style="color:#999;font-style:italic"></span>TIMESTAM<span style="color:#666">
</span></span></span><span style="display:flex;"><span><span style="color:#666"></span><span style="color:#999;font-style:italic">--------
</span></span></span><span style="display:flex;"><span><span style="color:#999;font-style:italic"></span>OBJ_NAME<span style="color:#666">
</span></span></span><span style="display:flex;"><span><span style="color:#666"></span><span style="color:#999;font-style:italic">--------------------------------------------------------------------------------
</span></span></span><span style="display:flex;"><span><span style="color:#999;font-style:italic"></span>ACTION_NAME<span style="color:#666">
</span></span></span><span style="display:flex;"><span><span style="color:#666"></span><span style="color:#999;font-style:italic">--------------------------------------------------------------------------------
</span></span></span><span style="display:flex;"><span><span style="color:#999;font-style:italic"></span><span style="color:#666">
</span></span></span><span style="display:flex;"><span><span style="color:#666"></span><span style="color:#3677a9">16</span>/<span style="color:#3677a9">02</span>/<span style="color:#3677a9">25</span><span style="color:#666">
</span></span></span><span style="display:flex;"><span><span style="color:#666"></span>PRUEBA1<span style="color:#666">
</span></span></span><span style="display:flex;"><span><span style="color:#666"></span><span style="color:#6ab825;font-weight:bold">INSERT</span><span style="color:#666">
</span></span></span><span style="display:flex;"><span><span style="color:#666">
</span></span></span><span style="display:flex;"><span><span style="color:#666">
</span></span></span><span style="display:flex;"><span><span style="color:#666"></span>SQL_TEXT<span style="color:#666">
</span></span></span><span style="display:flex;"><span><span style="color:#666"></span><span style="color:#999;font-style:italic">--------------------------------------------------------------------------------
</span></span></span><span style="display:flex;"><span><span style="color:#999;font-style:italic"></span>TIMESTAM<span style="color:#666">
</span></span></span><span style="display:flex;"><span><span style="color:#666"></span><span style="color:#999;font-style:italic">--------
</span></span></span><span style="display:flex;"><span><span style="color:#999;font-style:italic"></span>OBJ_NAME<span style="color:#666">
</span></span></span><span style="display:flex;"><span><span style="color:#666"></span><span style="color:#999;font-style:italic">--------------------------------------------------------------------------------
</span></span></span><span style="display:flex;"><span><span style="color:#999;font-style:italic"></span>ACTION_NAME<span style="color:#666">
</span></span></span><span style="display:flex;"><span><span style="color:#666"></span><span style="color:#999;font-style:italic">--------------------------------------------------------------------------------
</span></span></span><span style="display:flex;"><span><span style="color:#999;font-style:italic"></span><span style="color:#666">
</span></span></span><span style="display:flex;"><span><span style="color:#666"></span><span style="color:#3677a9">16</span>/<span style="color:#3677a9">02</span>/<span style="color:#3677a9">25</span><span style="color:#666">
</span></span></span><span style="display:flex;"><span><span style="color:#666"></span>PRUEBA1<span style="color:#666">
</span></span></span><span style="display:flex;"><span><span style="color:#666"></span><span style="color:#6ab825;font-weight:bold">UPDATE</span><span style="color:#666">
</span></span></span><span style="display:flex;"><span><span style="color:#666">
</span></span></span><span style="display:flex;"><span><span style="color:#666">
</span></span></span><span style="display:flex;"><span><span style="color:#666"></span>SQL_TEXT<span style="color:#666">
</span></span></span><span style="display:flex;"><span><span style="color:#666"></span><span style="color:#999;font-style:italic">--------------------------------------------------------------------------------
</span></span></span><span style="display:flex;"><span><span style="color:#999;font-style:italic"></span>TIMESTAM<span style="color:#666">
</span></span></span><span style="display:flex;"><span><span style="color:#666"></span><span style="color:#999;font-style:italic">--------
</span></span></span><span style="display:flex;"><span><span style="color:#999;font-style:italic"></span>OBJ_NAME<span style="color:#666">
</span></span></span><span style="display:flex;"><span><span style="color:#666"></span><span style="color:#999;font-style:italic">--------------------------------------------------------------------------------
</span></span></span><span style="display:flex;"><span><span style="color:#999;font-style:italic"></span>ACTION_NAME<span style="color:#666">
</span></span></span><span style="display:flex;"><span><span style="color:#666"></span><span style="color:#999;font-style:italic">--------------------------------------------------------------------------------
</span></span></span><span style="display:flex;"><span><span style="color:#999;font-style:italic"></span><span style="color:#666">
</span></span></span><span style="display:flex;"><span><span style="color:#666"></span><span style="color:#3677a9">16</span>/<span style="color:#3677a9">02</span>/<span style="color:#3677a9">25</span><span style="color:#666">
</span></span></span><span style="display:flex;"><span><span style="color:#666"></span>PRUEBA1<span style="color:#666">
</span></span></span><span style="display:flex;"><span><span style="color:#666"></span><span style="color:#6ab825;font-weight:bold">DELETE</span><span style="color:#666">
</span></span></span><span style="display:flex;"><span><span style="color:#666">
</span></span></span><span style="display:flex;"><span><span style="color:#666">
</span></span></span><span style="display:flex;"><span><span style="color:#666"></span>SQL_TEXT<span style="color:#666">
</span></span></span><span style="display:flex;"><span><span style="color:#666"></span><span style="color:#999;font-style:italic">--------------------------------------------------------------------------------
</span></span></span><span style="display:flex;"><span><span style="color:#999;font-style:italic"></span>TIMESTAM<span style="color:#666">
</span></span></span><span style="display:flex;"><span><span style="color:#666"></span><span style="color:#999;font-style:italic">--------
</span></span></span><span style="display:flex;"><span><span style="color:#999;font-style:italic"></span>OBJ_NAME<span style="color:#666">
</span></span></span><span style="display:flex;"><span><span style="color:#666"></span><span style="color:#999;font-style:italic">--------------------------------------------------------------------------------
</span></span></span><span style="display:flex;"><span><span style="color:#999;font-style:italic"></span>ACTION_NAME<span style="color:#666">
</span></span></span><span style="display:flex;"><span><span style="color:#666"></span><span style="color:#999;font-style:italic">--------------------------------------------------------------------------------
</span></span></span><span style="display:flex;"><span><span style="color:#999;font-style:italic"></span><span style="color:#666">
</span></span></span><span style="display:flex;"><span><span style="color:#666"></span><span style="color:#3677a9">16</span>/<span style="color:#3677a9">02</span>/<span style="color:#3677a9">25</span><span style="color:#666">
</span></span></span><span style="display:flex;"><span><span style="color:#666"></span>PRUEBA1<span style="color:#666">
</span></span></span><span style="display:flex;"><span><span style="color:#666"></span><span style="color:#6ab825;font-weight:bold">SELECT</span><span style="color:#666">
</span></span></span><span style="display:flex;"><span><span style="color:#666">
</span></span></span><span style="display:flex;"><span><span style="color:#666">
</span></span></span><span style="display:flex;"><span><span style="color:#666"></span><span style="color:#3677a9">15</span><span style="color:#666"> </span>filas<span style="color:#666"> </span>seleccionadas.<span style="color:#666">
</span></span></span></code></pre></div><p>En cambio, si el valor del parámetro <code>audit_trail</code> se cambia a <code>db, extended</code> y se repiten las operaciones DML auditadas, este campo guarda la información sobre las sentencias SQL que se han ejecutado por parte del usuario.</p>
<div class="highlight"><pre tabindex="0" style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-sql" data-lang="sql"><span style="display:flex;"><span><span style="color:#6ab825;font-weight:bold">SQL</span>&gt;<span style="color:#666"> </span><span style="color:#6ab825;font-weight:bold">alter</span><span style="color:#666"> </span><span style="color:#6ab825;font-weight:bold">system</span><span style="color:#666"> </span><span style="color:#6ab825;font-weight:bold">set</span><span style="color:#666"> </span>AUDIT_TRAIL=db,<span style="color:#666"> </span>extended<span style="color:#666"> </span><span style="color:#6ab825;font-weight:bold">scope</span>=spfile;<span style="color:#666">
</span></span></span><span style="display:flex;"><span><span style="color:#666"></span><span style="color:#6ab825;font-weight:bold">SQL</span>&gt;<span style="color:#666"> </span>SHUTDOWN<span style="color:#666"> </span><span style="color:#6ab825;font-weight:bold">IMMEDIATE</span><span style="color:#666">
</span></span></span><span style="display:flex;"><span><span style="color:#666"></span><span style="color:#6ab825;font-weight:bold">SQL</span>&gt;<span style="color:#666"> </span>STARTUP<span style="color:#666">
</span></span></span><span style="display:flex;"><span><span style="color:#666"></span><span style="color:#6ab825;font-weight:bold">SQL</span>&gt;<span style="color:#666"> </span><span style="color:#6ab825;font-weight:bold">SHOW</span><span style="color:#666"> </span><span style="color:#6ab825;font-weight:bold">PARAMETER</span><span style="color:#666"> </span>AUDIT_TRAIL;<span style="color:#666">
</span></span></span><span style="display:flex;"><span><span style="color:#666">
</span></span></span><span style="display:flex;"><span><span style="color:#666"></span>NAME<span style="color:#666">				     </span><span style="color:#6ab825;font-weight:bold">TYPE</span><span style="color:#666">
</span></span></span><span style="display:flex;"><span><span style="color:#666"></span><span style="color:#999;font-style:italic">------------------------------------ ---------------------------------
</span></span></span><span style="display:flex;"><span><span style="color:#999;font-style:italic"></span>VALUE<span style="color:#666">
</span></span></span><span style="display:flex;"><span><span style="color:#666"></span><span style="color:#999;font-style:italic">------------------------------
</span></span></span><span style="display:flex;"><span><span style="color:#999;font-style:italic"></span>audit_trail<span style="color:#666">			     </span>string<span style="color:#666">
</span></span></span><span style="display:flex;"><span><span style="color:#666"></span>DB,<span style="color:#666"> </span>EXTENDED<span style="color:#666">
</span></span></span></code></pre></div><div class="highlight"><pre tabindex="0" style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-sql" data-lang="sql"><span style="display:flex;"><span><span style="color:#6ab825;font-weight:bold">SQL</span>&gt;<span style="color:#666"> </span><span style="color:#6ab825;font-weight:bold">SELECT</span><span style="color:#666"> </span>SQL_TEXT,<span style="color:#6ab825;font-weight:bold">TIMESTAMP</span>,OBJ_NAME,ACTION_NAME<span style="color:#666">
</span></span></span><span style="display:flex;"><span><span style="color:#666">  </span><span style="color:#3677a9">2</span><span style="color:#666">  </span><span style="color:#6ab825;font-weight:bold">FROM</span><span style="color:#666">   </span>DBA_AUDIT_TRAIL<span style="color:#666">
</span></span></span><span style="display:flex;"><span><span style="color:#666">  </span><span style="color:#3677a9">3</span><span style="color:#666">  </span><span style="color:#6ab825;font-weight:bold">WHERE</span><span style="color:#666"> </span><span style="color:#6ab825;font-weight:bold">OWNER</span><span style="color:#666"> </span>=<span style="color:#666"> </span><span style="color:#ed9d13">&#39;PRUEBA&#39;</span><span style="color:#666">
</span></span></span><span style="display:flex;"><span><span style="color:#666">  </span><span style="color:#3677a9">4</span><span style="color:#666">  </span><span style="color:#6ab825;font-weight:bold">AND</span><span style="color:#666"> </span>ACTION_NAME<span style="color:#666"> </span>!=<span style="color:#666"> </span><span style="color:#ed9d13">&#39;SESSION REC&#39;</span>;<span style="color:#666">
</span></span></span><span style="display:flex;"><span><span style="color:#666"></span>...<span style="color:#666">
</span></span></span><span style="display:flex;"><span><span style="color:#666"></span>SQL_TEXT<span style="color:#666">
</span></span></span><span style="display:flex;"><span><span style="color:#666"></span><span style="color:#999;font-style:italic">--------------------------------------------------------------------------------
</span></span></span><span style="display:flex;"><span><span style="color:#999;font-style:italic"></span>TIMESTAM<span style="color:#666">
</span></span></span><span style="display:flex;"><span><span style="color:#666"></span><span style="color:#999;font-style:italic">--------
</span></span></span><span style="display:flex;"><span><span style="color:#999;font-style:italic"></span>OBJ_NAME<span style="color:#666">
</span></span></span><span style="display:flex;"><span><span style="color:#666"></span><span style="color:#999;font-style:italic">--------------------------------------------------------------------------------
</span></span></span><span style="display:flex;"><span><span style="color:#999;font-style:italic"></span>ACTION_NAME<span style="color:#666">
</span></span></span><span style="display:flex;"><span><span style="color:#666"></span><span style="color:#999;font-style:italic">--------------------------------------------------------------------------------
</span></span></span><span style="display:flex;"><span><span style="color:#999;font-style:italic"></span><span style="color:#6ab825;font-weight:bold">INSERT</span><span style="color:#666"> </span><span style="color:#6ab825;font-weight:bold">INTO</span><span style="color:#666"> </span>PRUEBA1<span style="color:#666"> </span><span style="color:#6ab825;font-weight:bold">VALUES</span><span style="color:#666"> </span>(<span style="color:#3677a9">1</span>)<span style="color:#666">
</span></span></span><span style="display:flex;"><span><span style="color:#666"></span><span style="color:#3677a9">17</span>/<span style="color:#3677a9">02</span>/<span style="color:#3677a9">25</span><span style="color:#666">
</span></span></span><span style="display:flex;"><span><span style="color:#666"></span>PRUEBA1<span style="color:#666">
</span></span></span><span style="display:flex;"><span><span style="color:#666"></span><span style="color:#6ab825;font-weight:bold">INSERT</span><span style="color:#666">
</span></span></span><span style="display:flex;"><span><span style="color:#666">
</span></span></span><span style="display:flex;"><span><span style="color:#666">
</span></span></span><span style="display:flex;"><span><span style="color:#666"></span>SQL_TEXT<span style="color:#666">
</span></span></span><span style="display:flex;"><span><span style="color:#666"></span><span style="color:#999;font-style:italic">--------------------------------------------------------------------------------
</span></span></span><span style="display:flex;"><span><span style="color:#999;font-style:italic"></span>TIMESTAM<span style="color:#666">
</span></span></span><span style="display:flex;"><span><span style="color:#666"></span><span style="color:#999;font-style:italic">--------
</span></span></span><span style="display:flex;"><span><span style="color:#999;font-style:italic"></span>OBJ_NAME<span style="color:#666">
</span></span></span><span style="display:flex;"><span><span style="color:#666"></span><span style="color:#999;font-style:italic">--------------------------------------------------------------------------------
</span></span></span><span style="display:flex;"><span><span style="color:#999;font-style:italic"></span>ACTION_NAME<span style="color:#666">
</span></span></span><span style="display:flex;"><span><span style="color:#666"></span><span style="color:#999;font-style:italic">--------------------------------------------------------------------------------
</span></span></span><span style="display:flex;"><span><span style="color:#999;font-style:italic"></span><span style="color:#6ab825;font-weight:bold">INSERT</span><span style="color:#666"> </span><span style="color:#6ab825;font-weight:bold">INTO</span><span style="color:#666"> </span>PRUEBA1<span style="color:#666"> </span><span style="color:#6ab825;font-weight:bold">VALUES</span><span style="color:#666"> </span>(<span style="color:#3677a9">2</span>)<span style="color:#666">
</span></span></span><span style="display:flex;"><span><span style="color:#666"></span><span style="color:#3677a9">17</span>/<span style="color:#3677a9">02</span>/<span style="color:#3677a9">25</span><span style="color:#666">
</span></span></span><span style="display:flex;"><span><span style="color:#666"></span>PRUEBA1<span style="color:#666">
</span></span></span><span style="display:flex;"><span><span style="color:#666"></span><span style="color:#6ab825;font-weight:bold">INSERT</span><span style="color:#666">
</span></span></span><span style="display:flex;"><span><span style="color:#666">
</span></span></span><span style="display:flex;"><span><span style="color:#666">
</span></span></span><span style="display:flex;"><span><span style="color:#666"></span>SQL_TEXT<span style="color:#666">
</span></span></span><span style="display:flex;"><span><span style="color:#666"></span><span style="color:#999;font-style:italic">--------------------------------------------------------------------------------
</span></span></span><span style="display:flex;"><span><span style="color:#999;font-style:italic"></span>TIMESTAM<span style="color:#666">
</span></span></span><span style="display:flex;"><span><span style="color:#666"></span><span style="color:#999;font-style:italic">--------
</span></span></span><span style="display:flex;"><span><span style="color:#999;font-style:italic"></span>OBJ_NAME<span style="color:#666">
</span></span></span><span style="display:flex;"><span><span style="color:#666"></span><span style="color:#999;font-style:italic">--------------------------------------------------------------------------------
</span></span></span><span style="display:flex;"><span><span style="color:#999;font-style:italic"></span>ACTION_NAME<span style="color:#666">
</span></span></span><span style="display:flex;"><span><span style="color:#666"></span><span style="color:#999;font-style:italic">--------------------------------------------------------------------------------
</span></span></span><span style="display:flex;"><span><span style="color:#999;font-style:italic"></span><span style="color:#6ab825;font-weight:bold">INSERT</span><span style="color:#666"> </span><span style="color:#6ab825;font-weight:bold">INTO</span><span style="color:#666"> </span>PRUEBA1<span style="color:#666"> </span><span style="color:#6ab825;font-weight:bold">VALUES</span><span style="color:#666"> </span>(<span style="color:#3677a9">3</span>)<span style="color:#666">
</span></span></span><span style="display:flex;"><span><span style="color:#666"></span><span style="color:#3677a9">17</span>/<span style="color:#3677a9">02</span>/<span style="color:#3677a9">25</span><span style="color:#666">
</span></span></span><span style="display:flex;"><span><span style="color:#666"></span>PRUEBA1<span style="color:#666">
</span></span></span><span style="display:flex;"><span><span style="color:#666"></span><span style="color:#6ab825;font-weight:bold">INSERT</span><span style="color:#666">
</span></span></span><span style="display:flex;"><span><span style="color:#666">
</span></span></span><span style="display:flex;"><span><span style="color:#666">
</span></span></span><span style="display:flex;"><span><span style="color:#666"></span>SQL_TEXT<span style="color:#666">
</span></span></span><span style="display:flex;"><span><span style="color:#666"></span><span style="color:#999;font-style:italic">--------------------------------------------------------------------------------
</span></span></span><span style="display:flex;"><span><span style="color:#999;font-style:italic"></span>TIMESTAM<span style="color:#666">
</span></span></span><span style="display:flex;"><span><span style="color:#666"></span><span style="color:#999;font-style:italic">--------
</span></span></span><span style="display:flex;"><span><span style="color:#999;font-style:italic"></span>OBJ_NAME<span style="color:#666">
</span></span></span><span style="display:flex;"><span><span style="color:#666"></span><span style="color:#999;font-style:italic">--------------------------------------------------------------------------------
</span></span></span><span style="display:flex;"><span><span style="color:#999;font-style:italic"></span>ACTION_NAME<span style="color:#666">
</span></span></span><span style="display:flex;"><span><span style="color:#666"></span><span style="color:#999;font-style:italic">--------------------------------------------------------------------------------
</span></span></span><span style="display:flex;"><span><span style="color:#999;font-style:italic"></span><span style="color:#6ab825;font-weight:bold">UPDATE</span><span style="color:#666"> </span>PRUEBA1<span style="color:#666"> </span><span style="color:#6ab825;font-weight:bold">SET</span><span style="color:#666"> </span>ID=<span style="color:#3677a9">4</span><span style="color:#666"> </span><span style="color:#6ab825;font-weight:bold">WHERE</span><span style="color:#666"> </span>ID=<span style="color:#3677a9">3</span><span style="color:#666">
</span></span></span><span style="display:flex;"><span><span style="color:#666"></span><span style="color:#3677a9">17</span>/<span style="color:#3677a9">02</span>/<span style="color:#3677a9">25</span><span style="color:#666">
</span></span></span><span style="display:flex;"><span><span style="color:#666"></span>PRUEBA1<span style="color:#666">
</span></span></span><span style="display:flex;"><span><span style="color:#666"></span><span style="color:#6ab825;font-weight:bold">UPDATE</span><span style="color:#666">
</span></span></span><span style="display:flex;"><span><span style="color:#666">
</span></span></span><span style="display:flex;"><span><span style="color:#666">
</span></span></span><span style="display:flex;"><span><span style="color:#666"></span>SQL_TEXT<span style="color:#666">
</span></span></span><span style="display:flex;"><span><span style="color:#666"></span><span style="color:#999;font-style:italic">--------------------------------------------------------------------------------
</span></span></span><span style="display:flex;"><span><span style="color:#999;font-style:italic"></span>TIMESTAM<span style="color:#666">
</span></span></span><span style="display:flex;"><span><span style="color:#666"></span><span style="color:#999;font-style:italic">--------
</span></span></span><span style="display:flex;"><span><span style="color:#999;font-style:italic"></span>OBJ_NAME<span style="color:#666">
</span></span></span><span style="display:flex;"><span><span style="color:#666"></span><span style="color:#999;font-style:italic">--------------------------------------------------------------------------------
</span></span></span><span style="display:flex;"><span><span style="color:#999;font-style:italic"></span>ACTION_NAME<span style="color:#666">
</span></span></span><span style="display:flex;"><span><span style="color:#666"></span><span style="color:#999;font-style:italic">--------------------------------------------------------------------------------
</span></span></span><span style="display:flex;"><span><span style="color:#999;font-style:italic"></span><span style="color:#6ab825;font-weight:bold">DELETE</span><span style="color:#666"> </span><span style="color:#6ab825;font-weight:bold">FROM</span><span style="color:#666"> </span>PRUEBA1<span style="color:#666"> </span><span style="color:#6ab825;font-weight:bold">WHERE</span><span style="color:#666"> </span>ID=<span style="color:#3677a9">2</span><span style="color:#666">
</span></span></span><span style="display:flex;"><span><span style="color:#666"></span><span style="color:#3677a9">17</span>/<span style="color:#3677a9">02</span>/<span style="color:#3677a9">25</span><span style="color:#666">
</span></span></span><span style="display:flex;"><span><span style="color:#666"></span>PRUEBA1<span style="color:#666">
</span></span></span><span style="display:flex;"><span><span style="color:#666"></span><span style="color:#6ab825;font-weight:bold">DELETE</span><span style="color:#666">
</span></span></span><span style="display:flex;"><span><span style="color:#666">
</span></span></span><span style="display:flex;"><span><span style="color:#666">
</span></span></span><span style="display:flex;"><span><span style="color:#666"></span>SQL_TEXT<span style="color:#666">
</span></span></span><span style="display:flex;"><span><span style="color:#666"></span><span style="color:#999;font-style:italic">--------------------------------------------------------------------------------
</span></span></span><span style="display:flex;"><span><span style="color:#999;font-style:italic"></span>TIMESTAM<span style="color:#666">
</span></span></span><span style="display:flex;"><span><span style="color:#666"></span><span style="color:#999;font-style:italic">--------
</span></span></span><span style="display:flex;"><span><span style="color:#999;font-style:italic"></span>OBJ_NAME<span style="color:#666">
</span></span></span><span style="display:flex;"><span><span style="color:#666"></span><span style="color:#999;font-style:italic">--------------------------------------------------------------------------------
</span></span></span><span style="display:flex;"><span><span style="color:#999;font-style:italic"></span>ACTION_NAME<span style="color:#666">
</span></span></span><span style="display:flex;"><span><span style="color:#666"></span><span style="color:#999;font-style:italic">--------------------------------------------------------------------------------
</span></span></span><span style="display:flex;"><span><span style="color:#999;font-style:italic"></span><span style="color:#6ab825;font-weight:bold">SELECT</span><span style="color:#666"> </span>*<span style="color:#666"> </span><span style="color:#6ab825;font-weight:bold">FROM</span><span style="color:#666"> </span>PRUEBA1<span style="color:#666">
</span></span></span><span style="display:flex;"><span><span style="color:#666"></span><span style="color:#3677a9">17</span>/<span style="color:#3677a9">02</span>/<span style="color:#3677a9">25</span><span style="color:#666">
</span></span></span><span style="display:flex;"><span><span style="color:#666"></span>PRUEBA1<span style="color:#666">
</span></span></span><span style="display:flex;"><span><span style="color:#666"></span><span style="color:#6ab825;font-weight:bold">SELECT</span><span style="color:#666">
</span></span></span><span style="display:flex;"><span><span style="color:#666">
</span></span></span><span style="display:flex;"><span><span style="color:#666">
</span></span></span><span style="display:flex;"><span><span style="color:#666"></span><span style="color:#3677a9">27</span><span style="color:#666"> </span>filas<span style="color:#666"> </span>seleccionadas.<span style="color:#666">
</span></span></span></code></pre></div><h1 id="averigua-si-en-postgres-se-pueden-realizar-los-cuatro-primeros-apartados-si-es-así-documenta-el-proceso-adecuadamente">Averigua si en Postgres se pueden realizar los cuatro primeros apartados. Si es así, documenta el proceso adecuadamente.</h1>
<h2 id="auditar-los-intentos-de-acceso-fallidos">Auditar los intentos de acceso fallidos</h2>
<p>Hay varias formas de auditar los intentos fallidos de acceso a una base de datos Postgres. El método más sencillo pero menos preciso consiste en habilitar la auditoría general de la base de datos a nivel de sistema, que almacena una auditoría de todas las sentencias SQL que se ejecutan sobre la base de datos, incluidos los intentos de inicio de sesión. Este método genera un fichero de log en el sistema operativo en el que después se pueden buscar las coincidencias con un intento de acceso fallido con alguna herramienta como <code>grep</code>.</p>
<p>En el fichero /etc/postgresql/15/main/postgresql.conf se habilita el registro de las sentencias SQL y los inicios de sesión en el log.</p>
<div class="highlight"><pre tabindex="0" style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-ini" data-lang="ini"><span style="display:flex;"><span><span style="color:#999;font-style:italic"># This is used when logging to stderr:</span>
</span></span><span style="display:flex;"><span><span style="color:#bbb">logging_collector</span> = <span style="color:#ed9d13">on          # Enable capturing of stderr, jsonlog,
</span></span></span><span style="display:flex;"><span><span style="color:#ed9d13">                                # and csvlog into log files. Required
</span></span></span><span style="display:flex;"><span><span style="color:#ed9d13">                                # to be on for csvlogs and jsonlogs.
</span></span></span><span style="display:flex;"><span><span style="color:#ed9d13">                                # (change requires restart)</span>
</span></span><span style="display:flex;"><span><span style="color:#bbb">...</span>
</span></span><span style="display:flex;"><span><span style="color:#999;font-style:italic">#log_checkpoints = on</span>
</span></span><span style="display:flex;"><span><span style="color:#bbb">log_connections</span> = <span style="color:#ed9d13">on</span>
</span></span><span style="display:flex;"><span><span style="color:#bbb">log_disconnections</span> = <span style="color:#ed9d13">on</span>
</span></span><span style="display:flex;"><span><span style="color:#999;font-style:italic">#log_duration = off</span>
</span></span><span style="display:flex;"><span><span style="color:#999;font-style:italic">#log_error_verbosity = default  # terse, default, or verbose messages</span>
</span></span><span style="display:flex;"><span><span style="color:#bbb">log_hostname</span> = <span style="color:#ed9d13">on</span>
</span></span><span style="display:flex;"><span><span style="color:#bbb">log_line_prefix</span> = <span style="color:#ed9d13">&#39;%m [%p] %q%u@%d &#39; </span>
</span></span></code></pre></div><p>Para hacer efectivos los cambios se reinicia el servicio.</p>
<div class="highlight"><pre tabindex="0" style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>sudo systemctl restart postgresql
</span></span></code></pre></div><p>Tras provocar un intento de acceso fallido a la base de datos, se genera un registro en el fichero de log que se puede filtrar con el comando <code>grep</code>.</p>
<div class="highlight"><pre tabindex="0" style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash-session" data-lang="bash-session"><span style="display:flex;"><span><span style="color:#ccc">root@debian12:/home/debian# cat /var/lib/postgresql/15/main/log/postgresql-2025-02-18_183324.log | grep &#34;password authentication&#34;
</span></span></span><span style="display:flex;"><span><span style="color:#ccc">2025-02-18 18:33:55.288 UTC [56628] usuario@usuario FATAL:  password authentication failed for user &#34;usuario&#34;
</span></span></span><span style="display:flex;"><span><span style="color:#ccc">2025-02-18 18:46:05.275 UTC [56988] usuario@usuario FATAL:  password authentication failed for user &#34;usuario&#34;
</span></span></span><span style="display:flex;"><span><span style="color:#ccc">2025-02-18 18:46:46.910 UTC [56997] usuario@usuario FATAL:  password authentication failed for user &#34;usuario&#34;
</span></span></span><span style="display:flex;"><span><span style="color:#ccc">2025-02-18 18:48:43.759 UTC [57011] usuario@prueba FATAL:  password authentication failed for user &#34;usuario&#34;
</span></span></span></code></pre></div><p>Otra forma, algo más compleja, de activar estos registros en el log es usar la extensión <code>pg_audit</code>. Sin embargo, este método no proporciona una configuración más personalizable que el que ya se ha demostrado anteriormente. También genera registros en el log del sistema operativo.</p>
<h2 id="procedimiento-plpgsql-que-muestre-los-accesos-fallidos">Procedimiento PL/pgSQL que muestre los accesos fallidos</h2>
<p>Puesto que PostgreSQL no almacena los accesos fallidos a la base de datos en una tabla de la misma, como sí hace Oracle, no es posible acceder a esta información desde un procedimiento PL/pgSQL dentro de la base de datos.</p>
<h2 id="auditar-las-operaciones-dml-realizadas-por-un-usuario-sobre-tablas-de-su-esquema">Auditar las operaciones DML realizadas por un usuario sobre tablas de su esquema</h2>
<p>Para auditar las operaciones DML ejecutadas por un usuario sobre las tablas de su esquema en PostgreSQL se puede usar el complemento <code>pg_audit</code>. Esta extensión del sistema gestor de bases de datos permite almacenar un registro de las sentencias SQL que se ejecutan en la base de datos en los ficheros de log del sistema operativo.</p>
<p>En primer lugar, se instala la extensión <code>pg_audit</code>.</p>
<div class="highlight"><pre tabindex="0" style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>sudo apt install postgresql-15-pgaudit
</span></span></code></pre></div><p>En el fichero de configuración /etc/postgresql/15/main/postgresql.conf se habilita la extensión y se configura la auditoría de las operaciones DML.</p>
<div class="highlight"><pre tabindex="0" style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-ini" data-lang="ini"><span style="display:flex;"><span><span style="color:#bbb">shared_preload_libraries</span> = <span style="color:#ed9d13">&#39;pgaudit&#39;    # (change requires restart)</span>
</span></span><span style="display:flex;"><span><span style="color:#bbb">pgaudit.log</span> = <span style="color:#ed9d13">&#39;write, ddl&#39;</span>
</span></span><span style="display:flex;"><span><span style="color:#bbb">pgaudit.log_catalog</span> = <span style="color:#ed9d13">off</span>
</span></span><span style="display:flex;"><span><span style="color:#bbb">pgaudit.log_parameter</span> = <span style="color:#ed9d13">on</span>
</span></span><span style="display:flex;"><span><span style="color:#bbb">pgaudit.log_statement_once</span> = <span style="color:#ed9d13">off</span>
</span></span><span style="display:flex;"><span><span style="color:#bbb">pgaudit.log_level</span> = <span style="color:#ed9d13">&#39;log&#39;</span>
</span></span></code></pre></div><p>Posteriormente se reinicia el servicio.</p>
<div class="highlight"><pre tabindex="0" style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>sudo systemctl restart postgresql
</span></span></code></pre></div><p>Y, en Postgres, se crea la extensión.</p>
<div class="highlight"><pre tabindex="0" style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-sql" data-lang="sql"><span style="display:flex;"><span>postgres=#<span style="color:#666"> </span><span style="color:#6ab825;font-weight:bold">create</span><span style="color:#666"> </span>extension<span style="color:#666"> </span>pgaudit;<span style="color:#666">
</span></span></span><span style="display:flex;"><span><span style="color:#666"></span><span style="color:#6ab825;font-weight:bold">CREATE</span><span style="color:#666"> </span>EXTENSION<span style="color:#666">
</span></span></span></code></pre></div><p>Para probar el funcionamiento de la auditoría, se ejecutan diferentes sentencias DML.</p>
<div class="highlight"><pre tabindex="0" style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-sql" data-lang="sql"><span style="display:flex;"><span>prueba=&gt;<span style="color:#666"> </span><span style="color:#6ab825;font-weight:bold">insert</span><span style="color:#666"> </span><span style="color:#6ab825;font-weight:bold">into</span><span style="color:#666"> </span>prueba1<span style="color:#666"> </span><span style="color:#6ab825;font-weight:bold">values</span><span style="color:#666"> </span>(<span style="color:#3677a9">1</span>);<span style="color:#666">
</span></span></span><span style="display:flex;"><span><span style="color:#666"></span><span style="color:#6ab825;font-weight:bold">INSERT</span><span style="color:#666"> </span><span style="color:#3677a9">0</span><span style="color:#666"> </span><span style="color:#3677a9">1</span><span style="color:#666">
</span></span></span><span style="display:flex;"><span><span style="color:#666"></span>prueba=&gt;<span style="color:#666"> </span><span style="color:#6ab825;font-weight:bold">insert</span><span style="color:#666"> </span><span style="color:#6ab825;font-weight:bold">into</span><span style="color:#666"> </span>prueba1<span style="color:#666"> </span><span style="color:#6ab825;font-weight:bold">values</span><span style="color:#666"> </span>(<span style="color:#3677a9">2</span>);<span style="color:#666">
</span></span></span><span style="display:flex;"><span><span style="color:#666"></span><span style="color:#6ab825;font-weight:bold">INSERT</span><span style="color:#666"> </span><span style="color:#3677a9">0</span><span style="color:#666"> </span><span style="color:#3677a9">1</span><span style="color:#666">
</span></span></span><span style="display:flex;"><span><span style="color:#666"></span>prueba=&gt;<span style="color:#666"> </span><span style="color:#6ab825;font-weight:bold">insert</span><span style="color:#666"> </span><span style="color:#6ab825;font-weight:bold">into</span><span style="color:#666"> </span>prueba1<span style="color:#666"> </span><span style="color:#6ab825;font-weight:bold">values</span><span style="color:#666"> </span>(<span style="color:#3677a9">3</span>);<span style="color:#666">
</span></span></span><span style="display:flex;"><span><span style="color:#666"></span><span style="color:#6ab825;font-weight:bold">INSERT</span><span style="color:#666"> </span><span style="color:#3677a9">0</span><span style="color:#666"> </span><span style="color:#3677a9">1</span><span style="color:#666">
</span></span></span><span style="display:flex;"><span><span style="color:#666"></span>prueba=&gt;<span style="color:#666"> </span><span style="color:#6ab825;font-weight:bold">update</span><span style="color:#666"> </span>prueba1<span style="color:#666"> </span><span style="color:#6ab825;font-weight:bold">set</span><span style="color:#666"> </span>id=<span style="color:#3677a9">4</span><span style="color:#666"> </span><span style="color:#6ab825;font-weight:bold">where</span><span style="color:#666"> </span>id=<span style="color:#3677a9">3</span>;<span style="color:#666">
</span></span></span><span style="display:flex;"><span><span style="color:#666"></span><span style="color:#6ab825;font-weight:bold">UPDATE</span><span style="color:#666"> </span><span style="color:#3677a9">1</span><span style="color:#666">
</span></span></span><span style="display:flex;"><span><span style="color:#666"></span>prueba=&gt;<span style="color:#666"> </span><span style="color:#6ab825;font-weight:bold">delete</span><span style="color:#666"> </span><span style="color:#6ab825;font-weight:bold">from</span><span style="color:#666"> </span>prueba1<span style="color:#666"> </span><span style="color:#6ab825;font-weight:bold">where</span><span style="color:#666"> </span>id=<span style="color:#3677a9">2</span>;<span style="color:#666">
</span></span></span><span style="display:flex;"><span><span style="color:#666"></span><span style="color:#6ab825;font-weight:bold">DELETE</span><span style="color:#666"> </span><span style="color:#3677a9">1</span><span style="color:#666">
</span></span></span><span style="display:flex;"><span><span style="color:#666"></span>prueba=&gt;<span style="color:#666"> </span><span style="color:#6ab825;font-weight:bold">select</span><span style="color:#666"> </span>*<span style="color:#666"> </span><span style="color:#6ab825;font-weight:bold">from</span><span style="color:#666"> </span>prueba1;<span style="color:#666">
</span></span></span><span style="display:flex;"><span><span style="color:#666"> </span>id<span style="color:#666"> 
</span></span></span><span style="display:flex;"><span><span style="color:#666"></span><span style="color:#999;font-style:italic">----
</span></span></span><span style="display:flex;"><span><span style="color:#999;font-style:italic"></span><span style="color:#666">  </span><span style="color:#3677a9">1</span><span style="color:#666">
</span></span></span><span style="display:flex;"><span><span style="color:#666">  </span><span style="color:#3677a9">4</span><span style="color:#666">
</span></span></span><span style="display:flex;"><span><span style="color:#666"></span>(<span style="color:#3677a9">2</span><span style="color:#666"> </span><span style="color:#6ab825;font-weight:bold">rows</span>)<span style="color:#666">
</span></span></span></code></pre></div><p>Como se ha comentado previamente, la información de la auditoría de Postgres no se almacena en una tabla de la base de datos, sino que se registra en los ficheros de log del propio sistema operativo. Así, para poder consultar esta información, se puede leer este fichero filtrando con alguna herramienta como <code>grep</code> su contenido.</p>
<div class="highlight"><pre tabindex="0" style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash-session" data-lang="bash-session"><span style="display:flex;"><span><span style="color:#ccc">root@debian12:/home/debian# cat /var/lib/postgresql/15/main/log/postgresql-2025-02-19_000000.log | grep &#34;AUDIT&#34;
</span></span></span><span style="display:flex;"><span><span style="color:#ccc">2025-02-19 08:26:56.964 UTC [61081] usuario@prueba LOG:  AUDIT: SESSION,1,1,DDL,CREATE TABLE,,,create table prueba1(id int);,&lt;none&gt;
</span></span></span><span style="display:flex;"><span><span style="color:#ccc">2025-02-19 08:33:02.785 UTC [61122] usuario@prueba LOG:  AUDIT: SESSION,1,1,WRITE,INSERT,,,insert into prueba1 values (1);,&lt;none&gt;
</span></span></span><span style="display:flex;"><span><span style="color:#ccc">2025-02-19 08:34:01.462 UTC [61136] usuario@prueba LOG:  AUDIT: SESSION,1,1,WRITE,INSERT,,,insert into prueba1 values (2);,&lt;none&gt;
</span></span></span><span style="display:flex;"><span><span style="color:#ccc">2025-02-19 08:34:03.651 UTC [61136] usuario@prueba LOG:  AUDIT: SESSION,2,1,WRITE,INSERT,,,insert into prueba1 values (3);,&lt;none&gt;
</span></span></span><span style="display:flex;"><span><span style="color:#ccc">2025-02-19 08:34:15.484 UTC [61136] usuario@prueba LOG:  AUDIT: SESSION,3,1,WRITE,UPDATE,,,update prueba1 set id=4 where id=3;,&lt;none&gt;
</span></span></span><span style="display:flex;"><span><span style="color:#ccc">2025-02-19 08:34:29.132 UTC [61136] usuario@prueba LOG:  AUDIT: SESSION,4,1,WRITE,DELETE,,,delete from prueba1 where id=2;,&lt;none&gt;
</span></span></span></code></pre></div><h2 id="auditoría-de-grano-fino-sobre-la-inserción-de-empleados-con-comisión-en-la-tabla-emp-de-scott">Auditoría de grano fino sobre la inserción de empleados con comisión en la tabla emp de Scott</h2>
<p>En Postgres no existe una herramienta que permita realizar una auditoría de grano fino al estilo de las que se pueden realizar en Oracle usando la librería DBMS_FGA. La herramienta de Postgres que permite acercarse lo máximo posible a un resultado parecido son los triggers. En este caso, habría que crear manualmente una tabla de auditoría en la que se almacenase la información recogida por el procedimiento y, por otra parte, crear un trigger que se ejecute cada vez que se inserten o actualicen datos en la tabla emp de Scott en los que el campo <code>comm</code> no esté vacío.</p>
<p>Así, en primer lugar, se crea la tabla de auditoría.</p>
<div class="highlight"><pre tabindex="0" style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-sql" data-lang="sql"><span style="display:flex;"><span>scott=#<span style="color:#666"> </span><span style="color:#6ab825;font-weight:bold">CREATE</span><span style="color:#666"> </span><span style="color:#6ab825;font-weight:bold">TABLE</span><span style="color:#666"> </span>auditoria<span style="color:#666"> </span>(<span style="color:#666">
</span></span></span><span style="display:flex;"><span><span style="color:#666">    </span>fecha_hora<span style="color:#666"> </span><span style="color:#6ab825;font-weight:bold">TIMESTAMP</span>,<span style="color:#666">
</span></span></span><span style="display:flex;"><span><span style="color:#666">    </span>operacion<span style="color:#666"> </span><span style="color:#24909d">VARCHAR</span>(<span style="color:#3677a9">10</span>),<span style="color:#666">
</span></span></span><span style="display:flex;"><span><span style="color:#666">    </span>usuario<span style="color:#666"> </span><span style="color:#24909d">VARCHAR</span>(<span style="color:#3677a9">50</span>),<span style="color:#666">
</span></span></span><span style="display:flex;"><span><span style="color:#666">    </span>empno<span style="color:#666"> </span><span style="color:#24909d">INT</span>,<span style="color:#666">
</span></span></span><span style="display:flex;"><span><span style="color:#666">    </span>comm<span style="color:#666"> </span><span style="color:#24909d">INT</span>,<span style="color:#666">
</span></span></span><span style="display:flex;"><span><span style="color:#666">    </span><span style="color:#6ab825;font-weight:bold">CONSTRAINT</span><span style="color:#666"> </span>pk_auditoria<span style="color:#666"> </span><span style="color:#6ab825;font-weight:bold">PRIMARY</span><span style="color:#666"> </span><span style="color:#6ab825;font-weight:bold">KEY</span><span style="color:#666"> </span>(fecha_hora)<span style="color:#666">
</span></span></span><span style="display:flex;"><span><span style="color:#666"></span>);<span style="color:#666">
</span></span></span><span style="display:flex;"><span><span style="color:#666"></span><span style="color:#6ab825;font-weight:bold">CREATE</span><span style="color:#666"> </span><span style="color:#6ab825;font-weight:bold">TABLE</span><span style="color:#666">
</span></span></span></code></pre></div><p>A continuación, se crea la función que se va a ejecutar cada vez que se lance el trigger.</p>
<div class="highlight"><pre tabindex="0" style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-sql" data-lang="sql"><span style="display:flex;"><span>scott=#<span style="color:#666"> </span><span style="color:#6ab825;font-weight:bold">CREATE</span><span style="color:#666"> </span><span style="color:#6ab825;font-weight:bold">OR</span><span style="color:#666"> </span><span style="color:#6ab825;font-weight:bold">REPLACE</span><span style="color:#666"> </span><span style="color:#6ab825;font-weight:bold">FUNCTION</span><span style="color:#666"> </span>auditoria_emp()<span style="color:#666"> 
</span></span></span><span style="display:flex;"><span><span style="color:#666"></span><span style="color:#6ab825;font-weight:bold">RETURNS</span><span style="color:#666"> </span><span style="color:#6ab825;font-weight:bold">TRIGGER</span><span style="color:#666"> </span><span style="color:#6ab825;font-weight:bold">AS</span><span style="color:#666"> </span><span style="color:#a61717;background-color:#e3d2d2">$$</span><span style="color:#666">
</span></span></span><span style="display:flex;"><span><span style="color:#666"></span><span style="color:#6ab825;font-weight:bold">BEGIN</span><span style="color:#666">
</span></span></span><span style="display:flex;"><span><span style="color:#666">    </span><span style="color:#6ab825;font-weight:bold">IF</span><span style="color:#666"> </span><span style="color:#6ab825;font-weight:bold">NEW</span>.comm<span style="color:#666"> </span><span style="color:#6ab825;font-weight:bold">IS</span><span style="color:#666"> </span><span style="color:#6ab825;font-weight:bold">NOT</span><span style="color:#666"> </span><span style="color:#6ab825;font-weight:bold">NULL</span><span style="color:#666"> </span><span style="color:#6ab825;font-weight:bold">THEN</span><span style="color:#666">
</span></span></span><span style="display:flex;"><span><span style="color:#666">        </span><span style="color:#6ab825;font-weight:bold">INSERT</span><span style="color:#666"> </span><span style="color:#6ab825;font-weight:bold">INTO</span><span style="color:#666"> </span>auditoria<span style="color:#666">
</span></span></span><span style="display:flex;"><span><span style="color:#666">        </span><span style="color:#6ab825;font-weight:bold">VALUES</span><span style="color:#666"> </span>(TG_OP,<span style="color:#666"> </span><span style="color:#6ab825;font-weight:bold">CURRENT_USER</span>,<span style="color:#666"> </span>NOW(),<span style="color:#666"> </span><span style="color:#6ab825;font-weight:bold">NEW</span>.empno,<span style="color:#666"> </span><span style="color:#6ab825;font-weight:bold">NEW</span>.comm);<span style="color:#666">
</span></span></span><span style="display:flex;"><span><span style="color:#666">    </span><span style="color:#6ab825;font-weight:bold">END</span><span style="color:#666"> </span><span style="color:#6ab825;font-weight:bold">IF</span>;<span style="color:#666">
</span></span></span><span style="display:flex;"><span><span style="color:#666">    </span><span style="color:#6ab825;font-weight:bold">RETURN</span><span style="color:#666"> </span><span style="color:#6ab825;font-weight:bold">NEW</span>;<span style="color:#666">
</span></span></span><span style="display:flex;"><span><span style="color:#666"></span><span style="color:#6ab825;font-weight:bold">END</span>;<span style="color:#666">
</span></span></span><span style="display:flex;"><span><span style="color:#666"></span><span style="color:#a61717;background-color:#e3d2d2">$$</span><span style="color:#666"> </span><span style="color:#6ab825;font-weight:bold">LANGUAGE</span><span style="color:#666"> </span>plpgsql;<span style="color:#666">
</span></span></span><span style="display:flex;"><span><span style="color:#666"></span><span style="color:#6ab825;font-weight:bold">CREATE</span><span style="color:#666"> </span><span style="color:#6ab825;font-weight:bold">FUNCTION</span><span style="color:#666">
</span></span></span></code></pre></div><p>Después se crean los triggers. Tanto para cuando se insertan como para cuando se actualizan datos en la tabla emp de Scott.</p>
<div class="highlight"><pre tabindex="0" style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-sql" data-lang="sql"><span style="display:flex;"><span>scott=#<span style="color:#666"> </span><span style="color:#6ab825;font-weight:bold">CREATE</span><span style="color:#666"> </span><span style="color:#6ab825;font-weight:bold">OR</span><span style="color:#666"> </span><span style="color:#6ab825;font-weight:bold">REPLACE</span><span style="color:#666"> </span><span style="color:#6ab825;font-weight:bold">TRIGGER</span><span style="color:#666"> </span>trigger_auditoria_emp<span style="color:#666">
</span></span></span><span style="display:flex;"><span><span style="color:#666"></span><span style="color:#6ab825;font-weight:bold">AFTER</span><span style="color:#666"> </span><span style="color:#6ab825;font-weight:bold">INSERT</span><span style="color:#666"> </span><span style="color:#6ab825;font-weight:bold">OR</span><span style="color:#666"> </span><span style="color:#6ab825;font-weight:bold">UPDATE</span><span style="color:#666"> </span><span style="color:#6ab825;font-weight:bold">ON</span><span style="color:#666"> </span>emp<span style="color:#666">
</span></span></span><span style="display:flex;"><span><span style="color:#666"></span><span style="color:#6ab825;font-weight:bold">FOR</span><span style="color:#666"> </span><span style="color:#6ab825;font-weight:bold">EACH</span><span style="color:#666"> </span><span style="color:#6ab825;font-weight:bold">ROW</span><span style="color:#666">
</span></span></span><span style="display:flex;"><span><span style="color:#666"></span><span style="color:#6ab825;font-weight:bold">EXECUTE</span><span style="color:#666"> </span><span style="color:#6ab825;font-weight:bold">FUNCTION</span><span style="color:#666"> </span>auditoria_emp();<span style="color:#666">
</span></span></span><span style="display:flex;"><span><span style="color:#666"></span><span style="color:#6ab825;font-weight:bold">CREATE</span><span style="color:#666"> </span><span style="color:#6ab825;font-weight:bold">TRIGGER</span><span style="color:#666">
</span></span></span></code></pre></div><p>Para comprobar el funcionamiento de esta solución se insertan diferentes registros en la tabla emp y se actualiza alguno existente.</p>
<div class="highlight"><pre tabindex="0" style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-sql" data-lang="sql"><span style="display:flex;"><span>scott=#<span style="color:#666"> </span><span style="color:#6ab825;font-weight:bold">INSERT</span><span style="color:#666"> </span><span style="color:#6ab825;font-weight:bold">INTO</span><span style="color:#666"> </span>EMP<span style="color:#666"> </span><span style="color:#6ab825;font-weight:bold">VALUES</span><span style="color:#666"> </span>(<span style="color:#3677a9">7901</span>,<span style="color:#ed9d13">&#39;LOLI&#39;</span>,<span style="color:#ed9d13">&#39;SALESMAN&#39;</span>,<span style="color:#3677a9">7698</span>,TO_DATE(<span style="color:#ed9d13">&#39;08/09/81&#39;</span><span style="color:#666">
</span></span></span><span style="display:flex;"><span><span style="color:#666"></span>,<span style="color:#ed9d13">&#39;DD/MM/YY&#39;</span>),<span style="color:#3677a9">1200</span>,<span style="color:#3677a9">20</span>,<span style="color:#3677a9">30</span>);<span style="color:#666">
</span></span></span><span style="display:flex;"><span><span style="color:#666"></span><span style="color:#6ab825;font-weight:bold">INSERT</span><span style="color:#666"> </span><span style="color:#3677a9">0</span><span style="color:#666"> </span><span style="color:#3677a9">1</span><span style="color:#666">
</span></span></span><span style="display:flex;"><span><span style="color:#666"></span>scott=#<span style="color:#666"> </span><span style="color:#6ab825;font-weight:bold">INSERT</span><span style="color:#666"> </span><span style="color:#6ab825;font-weight:bold">INTO</span><span style="color:#666"> </span>EMP<span style="color:#666"> </span>(EMPNO,ENAME,JOB,MGR,HIREDATE,SAL,DEPTNO)<span style="color:#666"> </span><span style="color:#6ab825;font-weight:bold">VALUES</span><span style="color:#666"> </span>(<span style="color:#3677a9">7903</span><span style="color:#666">
</span></span></span><span style="display:flex;"><span><span style="color:#666"></span>,<span style="color:#ed9d13">&#39;JUAN&#39;</span>,<span style="color:#ed9d13">&#39;CLERK&#39;</span>,<span style="color:#3677a9">7698</span>,TO_DATE(<span style="color:#ed9d13">&#39;03/09/81&#39;</span>,<span style="color:#ed9d13">&#39;DD/MM/YY&#39;</span>),<span style="color:#3677a9">1050</span>,<span style="color:#3677a9">30</span>);<span style="color:#666">
</span></span></span><span style="display:flex;"><span><span style="color:#666"></span><span style="color:#6ab825;font-weight:bold">INSERT</span><span style="color:#666"> </span><span style="color:#3677a9">0</span><span style="color:#666"> </span><span style="color:#3677a9">1</span><span style="color:#666">
</span></span></span><span style="display:flex;"><span><span style="color:#666"></span>scott=#<span style="color:#666"> </span><span style="color:#6ab825;font-weight:bold">UPDATE</span><span style="color:#666"> </span>EMP<span style="color:#666"> </span><span style="color:#6ab825;font-weight:bold">SET</span><span style="color:#666"> </span>COMM<span style="color:#666"> </span>=<span style="color:#666"> </span><span style="color:#3677a9">300</span><span style="color:#666"> </span><span style="color:#6ab825;font-weight:bold">WHERE</span><span style="color:#666"> </span>EMPNO<span style="color:#666"> </span>=<span style="color:#666"> </span><span style="color:#3677a9">7698</span>;<span style="color:#666">
</span></span></span><span style="display:flex;"><span><span style="color:#666"></span><span style="color:#6ab825;font-weight:bold">UPDATE</span><span style="color:#666"> </span><span style="color:#3677a9">1</span><span style="color:#666">
</span></span></span></code></pre></div><p>En la tabla <code>auditoria</code> se muestra la información recogida por el trigger.</p>
<div class="highlight"><pre tabindex="0" style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-sql" data-lang="sql"><span style="display:flex;"><span>scott=#<span style="color:#666"> </span><span style="color:#6ab825;font-weight:bold">select</span><span style="color:#666"> </span>*<span style="color:#666"> </span><span style="color:#6ab825;font-weight:bold">from</span><span style="color:#666"> </span>auditoria;<span style="color:#666">
</span></span></span><span style="display:flex;"><span><span style="color:#666"> </span>operacion<span style="color:#666"> </span>|<span style="color:#666"> </span>usuario<span style="color:#666">  </span>|<span style="color:#666">         </span>fecha_hora<span style="color:#666">         </span>|<span style="color:#666"> </span>empno<span style="color:#666"> </span>|<span style="color:#666"> </span>comm<span style="color:#666"> 
</span></span></span><span style="display:flex;"><span><span style="color:#666"></span><span style="color:#999;font-style:italic">-----------+----------+----------------------------+-------+------
</span></span></span><span style="display:flex;"><span><span style="color:#999;font-style:italic"></span><span style="color:#666"> </span><span style="color:#6ab825;font-weight:bold">INSERT</span><span style="color:#666">    </span>|<span style="color:#666"> </span>postgres<span style="color:#666"> </span>|<span style="color:#666"> </span><span style="color:#3677a9">2025</span>-<span style="color:#3677a9">02</span>-<span style="color:#3677a9">19</span><span style="color:#666"> </span><span style="color:#3677a9">13</span>:<span style="color:#3677a9">15</span>:<span style="color:#3677a9">10</span>.<span style="color:#3677a9">095491</span><span style="color:#666"> </span>|<span style="color:#666">  </span><span style="color:#3677a9">7901</span><span style="color:#666"> </span>|<span style="color:#666">   </span><span style="color:#3677a9">20</span><span style="color:#666">
</span></span></span><span style="display:flex;"><span><span style="color:#666"> </span><span style="color:#6ab825;font-weight:bold">UPDATE</span><span style="color:#666">    </span>|<span style="color:#666"> </span>postgres<span style="color:#666"> </span>|<span style="color:#666"> </span><span style="color:#3677a9">2025</span>-<span style="color:#3677a9">02</span>-<span style="color:#3677a9">19</span><span style="color:#666"> </span><span style="color:#3677a9">13</span>:<span style="color:#3677a9">17</span>:<span style="color:#3677a9">15</span>.<span style="color:#3677a9">674375</span><span style="color:#666"> </span>|<span style="color:#666">  </span><span style="color:#3677a9">7698</span><span style="color:#666"> </span>|<span style="color:#666">  </span><span style="color:#3677a9">300</span><span style="color:#666">
</span></span></span><span style="display:flex;"><span><span style="color:#666"></span>(<span style="color:#3677a9">2</span><span style="color:#666"> </span><span style="color:#6ab825;font-weight:bold">rows</span>)<span style="color:#666">
</span></span></span></code></pre></div><h1 id="averigua-si-en-mysql-se-pueden-realizar-los-apartados-1-3-y-4-si-es-así-documenta-el-proceso-adecuadamente">Averigua si en MySQL se pueden realizar los apartados 1, 3 y 4. Si es así, documenta el proceso adecuadamente.</h1>
<h2 id="auditar-los-intentos-de-acceso-fallidos-1">Auditar los intentos de acceso fallidos</h2>
<p>De forma similar a Postgres, MariaDB y MySQL permiten almacenar en los logs del sistema operativo un registro con las acciones ejecutadas en la base de datos. Una de las opciones para auditar acceso fallidos a la base de datos es, precisamente, activar estos logs de errores. Con esta herramienta, MariaDB almacena en un fichero de log del sistema sólo los errores que se producen en la base de datos y no todas las operaciones que se realizan en ella. Así, al filtrar el contenido de este fichero de log se pueden encontrar los registros de los intentos de acceso fallidos.</p>
<p>Esta herramienta de MariaDB y MySQL se activa con el parámetro de configuración <code>log_error</code> en el fichero de configuración principal de la base dedatos, que depende de la versión y distribución en la que se haya instalado el sistema gestor de bases de datos. En este caso, este fichero es /etc/mysql/mariadb.conf.d/50-server.cnf. El valor que toma este parámetro es la ruta al fichero de lo en el que el sistema gestor de bases de datos debe escribir todos los errores que se produzcan durante la ejecucióndel servicio. Cabe destacar que, a diferencia de Postgres, que crea sus propios ficheros de log automáticamente, en el caso de MariaDB, el fichero debe existir previamente y debe ser accesible por el usuario <code>mysql</code> que, además, debe tener permiso de escritura en el fichero.</p>
<div class="highlight"><pre tabindex="0" style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-ini" data-lang="ini"><span style="display:flex;"><span><span style="color:#999;font-style:italic"># When running under systemd, error logging goes via stdout/stderr to journald</span>
</span></span><span style="display:flex;"><span><span style="color:#999;font-style:italic"># and when running legacy init error logging goes to syslog due to</span>
</span></span><span style="display:flex;"><span><span style="color:#999;font-style:italic"># /etc/mysql/conf.d/mariadb.conf.d/50-mysqld_safe.cnf</span>
</span></span><span style="display:flex;"><span><span style="color:#999;font-style:italic"># Enable this if you want to have error logging into a separate file</span>
</span></span><span style="display:flex;"><span><span style="color:#bbb">log_error</span> = <span style="color:#ed9d13">/var/log/mysql/error.log</span>
</span></span></code></pre></div><p>Tras modificar este parámetro en la configuración de MariaDB se reinicia el servicio.</p>
<div class="highlight"><pre tabindex="0" style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>sudo systemctl restart mariadb
</span></span></code></pre></div><p>Después de intententar realizar varios accesos fallidos para comprobar el funcionamiento de esta auditoría se puede filtrar el fichero de log con alguna herramienta como <code>grep</code> para encontrar los intentos de acceso fallidos.</p>
<div class="highlight"><pre tabindex="0" style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash-session" data-lang="bash-session"><span style="display:flex;"><span><span style="color:#ccc">debian@debian12:~$ sudo cat /var/log/mysql/error.log | grep &#39;Access denied&#39;
</span></span></span><span style="display:flex;"><span><span style="color:#ccc">2025-02-19 16:20:39 33 [Warning] Access denied for user &#39;root&#39;@&#39;localhost&#39;
</span></span></span><span style="display:flex;"><span><span style="color:#ccc">2025-02-19 16:21:30 35 [Warning] Access denied for user &#39;usuario&#39;@&#39;localhost&#39; (using password: YES)
</span></span></span><span style="display:flex;"><span><span style="color:#ccc">2025-02-19 16:21:35 36 [Warning] Access denied for user &#39;usuario&#39;@&#39;localhost&#39; (using password: NO)
</span></span></span></code></pre></div><h2 id="auditoría-de-operaciones-dml-realizadas-por-un-usuario-sobre-tablas-de-su-esquema">Auditoría de operaciones DML realizadas por un usuario sobre tablas de su esquema</h2>
<p>Para auditar las operaciones DML en MariaDB se puede instalar el plugin <code>server_audit</code> en la base de datos. Este plugin, como ocurre en Postgres genera un fichero de log en el sistema operativo con las operaciones que se han ejecutado sobre la base de datos.</p>
<div class="highlight"><pre tabindex="0" style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-sql" data-lang="sql"><span style="display:flex;"><span>MariaDB<span style="color:#666"> </span>[prueba]&gt;<span style="color:#666"> </span>INSTALL<span style="color:#666"> </span>SONAME<span style="color:#666"> </span><span style="color:#ed9d13">&#39;server_audit&#39;</span>;<span style="color:#666">
</span></span></span><span style="display:flex;"><span><span style="color:#666"></span>Query<span style="color:#666"> </span>OK,<span style="color:#666"> </span><span style="color:#3677a9">0</span><span style="color:#666"> </span><span style="color:#6ab825;font-weight:bold">rows</span><span style="color:#666"> </span>affected<span style="color:#666"> </span>(<span style="color:#3677a9">0</span>.<span style="color:#3677a9">018</span><span style="color:#666"> </span>sec)<span style="color:#666">
</span></span></span></code></pre></div><p>Este plugin se puede configurar desde la línea de comandos de MySQL con sentencias <code>SET GLOBAL</code> COMO
<code>SET GLOBAL server_audit_events = 'CONNECT,QUERY,TABLE';</code> o desde el fichero de configuración del sistema gestor de bases de datos.</p>
<div class="highlight"><pre tabindex="0" style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-ini" data-lang="ini"><span style="display:flex;"><span><span style="color:#bbb">server_audit_events</span>=<span style="color:#ed9d13">QUERY_DML,TABLE</span>
</span></span><span style="display:flex;"><span><span style="color:#bbb">server_audit_loggin</span>=<span style="color:#ed9d13">ON</span>
</span></span><span style="display:flex;"><span><span style="color:#bbb">server_audit_file_path</span>=<span style="color:#ed9d13">/var/log/mysql/audit.log</span>
</span></span><span style="display:flex;"><span><span style="color:#bbb">server_audit_incl_users</span>=<span style="color:#ed9d13">&#39;usuario&#39;</span>
</span></span><span style="display:flex;"><span><span style="color:#bbb">server_audit_file_rotate_size</span>=<span style="color:#ed9d13">1000000</span>
</span></span><span style="display:flex;"><span><span style="color:#bbb">server_audit_file_rotations</span>=<span style="color:#ed9d13">5</span>
</span></span></code></pre></div><p>Esta configuración hace que se auditen las consutlas DML junto al nombre de la tabla a la que afectan del usuario <code>usuario</code> y que esta información se almacene en el fichero de log indicado en el sistema operativo. El tamaño máximo del fichero se indica también en esta configuración. Cabe indicar que si en el parámetro <code>server_audit_events</code> se indicase también la opción <code>CONNECT</code> este plugin podría usarse para auditar los intentos de acceso fallidos a la base de datos de forma muy similar a como se ha mostrado en el punto anterior.</p>
<p>Para aplicar la configuración se reinicia el servicio.</p>
<div class="highlight"><pre tabindex="0" style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>sudo systemctl restart mariadb
</span></span></code></pre></div><p>Para comprobar el funcionamiento del plugin de auditoría se realizan varias operaciones con el usuario <code>usuario</code>.</p>
<div class="highlight"><pre tabindex="0" style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-sql" data-lang="sql"><span style="display:flex;"><span>MariaDB<span style="color:#666"> </span>[prueba]&gt;<span style="color:#666"> </span><span style="color:#6ab825;font-weight:bold">create</span><span style="color:#666"> </span><span style="color:#6ab825;font-weight:bold">table</span><span style="color:#666"> </span>prueba1<span style="color:#666"> </span>(id<span style="color:#666"> </span><span style="color:#24909d">int</span>);<span style="color:#666">
</span></span></span><span style="display:flex;"><span><span style="color:#666"></span>Query<span style="color:#666"> </span>OK,<span style="color:#666"> </span><span style="color:#3677a9">0</span><span style="color:#666"> </span><span style="color:#6ab825;font-weight:bold">rows</span><span style="color:#666"> </span>affected<span style="color:#666"> </span>(<span style="color:#3677a9">0</span>.<span style="color:#3677a9">008</span><span style="color:#666"> </span>sec)<span style="color:#666">
</span></span></span><span style="display:flex;"><span><span style="color:#666">
</span></span></span><span style="display:flex;"><span><span style="color:#666"></span>MariaDB<span style="color:#666"> </span>[prueba]&gt;<span style="color:#666"> </span><span style="color:#6ab825;font-weight:bold">insert</span><span style="color:#666"> </span><span style="color:#6ab825;font-weight:bold">into</span><span style="color:#666"> </span>prueba1<span style="color:#666"> </span><span style="color:#6ab825;font-weight:bold">values</span><span style="color:#666"> </span>(<span style="color:#3677a9">1</span>);<span style="color:#666">
</span></span></span><span style="display:flex;"><span><span style="color:#666"></span>Query<span style="color:#666"> </span>OK,<span style="color:#666"> </span><span style="color:#3677a9">1</span><span style="color:#666"> </span><span style="color:#6ab825;font-weight:bold">row</span><span style="color:#666"> </span>affected<span style="color:#666"> </span>(<span style="color:#3677a9">0</span>.<span style="color:#3677a9">002</span><span style="color:#666"> </span>sec)<span style="color:#666">
</span></span></span><span style="display:flex;"><span><span style="color:#666">
</span></span></span><span style="display:flex;"><span><span style="color:#666"></span>MariaDB<span style="color:#666"> </span>[prueba]&gt;<span style="color:#666"> </span><span style="color:#6ab825;font-weight:bold">insert</span><span style="color:#666"> </span><span style="color:#6ab825;font-weight:bold">into</span><span style="color:#666"> </span>prueba1<span style="color:#666"> </span><span style="color:#6ab825;font-weight:bold">values</span><span style="color:#666"> </span>(<span style="color:#3677a9">2</span>);<span style="color:#666">
</span></span></span><span style="display:flex;"><span><span style="color:#666"></span>Query<span style="color:#666"> </span>OK,<span style="color:#666"> </span><span style="color:#3677a9">1</span><span style="color:#666"> </span><span style="color:#6ab825;font-weight:bold">row</span><span style="color:#666"> </span>affected<span style="color:#666"> </span>(<span style="color:#3677a9">0</span>.<span style="color:#3677a9">002</span><span style="color:#666"> </span>sec)<span style="color:#666">
</span></span></span><span style="display:flex;"><span><span style="color:#666">
</span></span></span><span style="display:flex;"><span><span style="color:#666"></span>MariaDB<span style="color:#666"> </span>[prueba]&gt;<span style="color:#666"> </span><span style="color:#6ab825;font-weight:bold">insert</span><span style="color:#666"> </span><span style="color:#6ab825;font-weight:bold">into</span><span style="color:#666"> </span>prueba1<span style="color:#666"> </span><span style="color:#6ab825;font-weight:bold">values</span><span style="color:#666"> </span>(<span style="color:#3677a9">3</span>);<span style="color:#666">
</span></span></span><span style="display:flex;"><span><span style="color:#666"></span>Query<span style="color:#666"> </span>OK,<span style="color:#666"> </span><span style="color:#3677a9">1</span><span style="color:#666"> </span><span style="color:#6ab825;font-weight:bold">row</span><span style="color:#666"> </span>affected<span style="color:#666"> </span>(<span style="color:#3677a9">0</span>.<span style="color:#3677a9">002</span><span style="color:#666"> </span>sec)<span style="color:#666">
</span></span></span><span style="display:flex;"><span><span style="color:#666">
</span></span></span><span style="display:flex;"><span><span style="color:#666"></span>MariaDB<span style="color:#666"> </span>[prueba]&gt;<span style="color:#666"> </span><span style="color:#6ab825;font-weight:bold">update</span><span style="color:#666"> </span>prueba1<span style="color:#666"> </span><span style="color:#6ab825;font-weight:bold">set</span><span style="color:#666"> </span>id=<span style="color:#3677a9">4</span><span style="color:#666"> </span><span style="color:#6ab825;font-weight:bold">where</span><span style="color:#666"> </span>id=<span style="color:#3677a9">3</span>;<span style="color:#666">
</span></span></span><span style="display:flex;"><span><span style="color:#666"></span>Query<span style="color:#666"> </span>OK,<span style="color:#666"> </span><span style="color:#3677a9">1</span><span style="color:#666"> </span><span style="color:#6ab825;font-weight:bold">row</span><span style="color:#666"> </span>affected<span style="color:#666"> </span>(<span style="color:#3677a9">0</span>.<span style="color:#3677a9">002</span><span style="color:#666"> </span>sec)<span style="color:#666">
</span></span></span><span style="display:flex;"><span><span style="color:#666"></span><span style="color:#6ab825;font-weight:bold">Rows</span><span style="color:#666"> </span>matched:<span style="color:#666"> </span><span style="color:#3677a9">1</span><span style="color:#666">  </span>Changed:<span style="color:#666"> </span><span style="color:#3677a9">1</span><span style="color:#666">  </span>Warnings:<span style="color:#666"> </span><span style="color:#3677a9">0</span><span style="color:#666">
</span></span></span><span style="display:flex;"><span><span style="color:#666">
</span></span></span><span style="display:flex;"><span><span style="color:#666"></span>MariaDB<span style="color:#666"> </span>[prueba]&gt;<span style="color:#666"> </span><span style="color:#6ab825;font-weight:bold">delete</span><span style="color:#666"> </span><span style="color:#6ab825;font-weight:bold">from</span><span style="color:#666"> </span>prueba1<span style="color:#666"> </span><span style="color:#6ab825;font-weight:bold">where</span><span style="color:#666"> </span>id=<span style="color:#3677a9">2</span>;<span style="color:#666">
</span></span></span><span style="display:flex;"><span><span style="color:#666"></span>Query<span style="color:#666"> </span>OK,<span style="color:#666"> </span><span style="color:#3677a9">1</span><span style="color:#666"> </span><span style="color:#6ab825;font-weight:bold">row</span><span style="color:#666"> </span>affected<span style="color:#666"> </span>(<span style="color:#3677a9">0</span>.<span style="color:#3677a9">002</span><span style="color:#666"> </span>sec)<span style="color:#666">
</span></span></span><span style="display:flex;"><span><span style="color:#666">
</span></span></span><span style="display:flex;"><span><span style="color:#666"></span>MariaDB<span style="color:#666"> </span>[prueba]&gt;<span style="color:#666"> </span><span style="color:#6ab825;font-weight:bold">select</span><span style="color:#666"> </span>*<span style="color:#666"> </span><span style="color:#6ab825;font-weight:bold">from</span><span style="color:#666"> </span>prueba1;<span style="color:#666">
</span></span></span><span style="display:flex;"><span><span style="color:#666"></span>+<span style="color:#999;font-style:italic">------+
</span></span></span><span style="display:flex;"><span><span style="color:#999;font-style:italic"></span>|<span style="color:#666"> </span>id<span style="color:#666">   </span>|<span style="color:#666">
</span></span></span><span style="display:flex;"><span><span style="color:#666"></span>+<span style="color:#999;font-style:italic">------+
</span></span></span><span style="display:flex;"><span><span style="color:#999;font-style:italic"></span>|<span style="color:#666">    </span><span style="color:#3677a9">1</span><span style="color:#666"> </span>|<span style="color:#666">
</span></span></span><span style="display:flex;"><span><span style="color:#666"></span>|<span style="color:#666">    </span><span style="color:#3677a9">4</span><span style="color:#666"> </span>|<span style="color:#666">
</span></span></span><span style="display:flex;"><span><span style="color:#666"></span>+<span style="color:#999;font-style:italic">------+
</span></span></span><span style="display:flex;"><span><span style="color:#999;font-style:italic"></span><span style="color:#3677a9">2</span><span style="color:#666"> </span><span style="color:#6ab825;font-weight:bold">rows</span><span style="color:#666"> </span><span style="color:#6ab825;font-weight:bold">in</span><span style="color:#666"> </span><span style="color:#6ab825;font-weight:bold">set</span><span style="color:#666"> </span>(<span style="color:#3677a9">0</span>.<span style="color:#3677a9">001</span><span style="color:#666"> </span>sec)<span style="color:#666">
</span></span></span></code></pre></div><p>Tras realizar estas operaciones en la base de datos, con la palabra <code>QUERY</code> se puede filtrar en el fichero la información sobre las operaciones DML realizadas por el usuario.</p>
<div class="highlight"><pre tabindex="0" style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash-session" data-lang="bash-session"><span style="display:flex;"><span><span style="color:#ccc">debian@debian12:~$ sudo cat /var/log/mysql/audit.log | grep &#39;QUERY&#39;
</span></span></span><span style="display:flex;"><span><span style="color:#ccc">20250219 16:48:13,debian12,usuario,localhost,32,60,QUERY,prueba,&#39;select @@version_comment limit 1&#39;,0
</span></span></span><span style="display:flex;"><span><span style="color:#ccc">20250219 16:48:32,debian12,usuario,localhost,32,62,QUERY,prueba,&#39;insert into prueba1 values (1)&#39;,0
</span></span></span><span style="display:flex;"><span><span style="color:#ccc">20250219 16:48:35,debian12,usuario,localhost,32,63,QUERY,prueba,&#39;insert into prueba1 values (2)&#39;,0
</span></span></span><span style="display:flex;"><span><span style="color:#ccc">20250219 16:48:38,debian12,usuario,localhost,32,64,QUERY,prueba,&#39;insert into prueba1 values (3)&#39;,0
</span></span></span><span style="display:flex;"><span><span style="color:#ccc">20250219 16:48:49,debian12,usuario,localhost,32,65,QUERY,prueba,&#39;update prueba1 set id=4 where id=3&#39;,0
</span></span></span><span style="display:flex;"><span><span style="color:#ccc">20250219 16:49:00,debian12,usuario,localhost,32,66,QUERY,prueba,&#39;delete from prueba1 where id=2&#39;,0
</span></span></span><span style="display:flex;"><span><span style="color:#ccc">20250219 16:49:06,debian12,usuario,localhost,32,67,QUERY,prueba,&#39;select * from prueba1&#39;,0
</span></span></span></code></pre></div><h2 id="auditoría-de-grano-fino-sobre-la-inserción-de-empleados-con-comisión-en-la-tabla-emp-de-scott-1">Auditoría de grano fino sobre la inserción de empleados con comisión en la tabla emp de Scott</h2>
<p>Como Postgres, MariaDB no cuenta con una herramienta para configurar auditorías de grano fino al estilo de Oracle. Así que la solución que se puede adoptar es similar a la del caso anterior: crear manualmente una tabla de auditoría, así como un trigger que la rellene a partir de las inserciones y actualizaciones en la tabla emp de Scott.</p>
<p>Para ello, en primer lugar, es necesario crear la tabla de auditoría.</p>
<div class="highlight"><pre tabindex="0" style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-sql" data-lang="sql"><span style="display:flex;"><span>MariaDB<span style="color:#666"> </span>[scott]&gt;<span style="color:#666"> </span><span style="color:#6ab825;font-weight:bold">CREATE</span><span style="color:#666"> </span><span style="color:#6ab825;font-weight:bold">TABLE</span><span style="color:#666"> </span>auditoria<span style="color:#666"> </span>(<span style="color:#666">
</span></span></span><span style="display:flex;"><span><span style="color:#666">    </span>-&gt;<span style="color:#666">     </span>fecha_hora<span style="color:#666"> </span>DATETIME,<span style="color:#666">
</span></span></span><span style="display:flex;"><span><span style="color:#666">    </span>-&gt;<span style="color:#666">     </span>operacion<span style="color:#666"> </span><span style="color:#24909d">VARCHAR</span>(<span style="color:#3677a9">10</span>),<span style="color:#666">
</span></span></span><span style="display:flex;"><span><span style="color:#666">    </span>-&gt;<span style="color:#666">     </span>usuario<span style="color:#666"> </span><span style="color:#24909d">VARCHAR</span>(<span style="color:#3677a9">50</span>),<span style="color:#666">
</span></span></span><span style="display:flex;"><span><span style="color:#666">    </span>-&gt;<span style="color:#666">     </span>empno<span style="color:#666"> </span><span style="color:#24909d">INT</span>,<span style="color:#666">
</span></span></span><span style="display:flex;"><span><span style="color:#666">    </span>-&gt;<span style="color:#666">     </span>comm<span style="color:#666"> </span><span style="color:#24909d">INT</span>,<span style="color:#666">
</span></span></span><span style="display:flex;"><span><span style="color:#666">    </span>-&gt;<span style="color:#666">     </span><span style="color:#6ab825;font-weight:bold">CONSTRAINT</span><span style="color:#666"> </span>pk_auditoria<span style="color:#666"> </span><span style="color:#6ab825;font-weight:bold">PRIMARY</span><span style="color:#666"> </span><span style="color:#6ab825;font-weight:bold">KEY</span><span style="color:#666"> </span>(fecha_hora)<span style="color:#666">
</span></span></span><span style="display:flex;"><span><span style="color:#666">    </span>-&gt;<span style="color:#666"> </span>);<span style="color:#666">
</span></span></span><span style="display:flex;"><span><span style="color:#666"></span>Query<span style="color:#666"> </span>OK,<span style="color:#666"> </span><span style="color:#3677a9">0</span><span style="color:#666"> </span><span style="color:#6ab825;font-weight:bold">rows</span><span style="color:#666"> </span>affected,<span style="color:#666"> </span><span style="color:#3677a9">1</span><span style="color:#666"> </span>warning<span style="color:#666"> </span>(<span style="color:#3677a9">0</span>.<span style="color:#3677a9">008</span><span style="color:#666"> </span>sec)<span style="color:#666">
</span></span></span></code></pre></div><p>A continuación, se crean los triggers para rellenar la tabla de auditoría cada vez que se inserte o actualice alguna comisión de la tabla emp. Como no hay ninguna forma de almacenar la operación que se está realizando en MariaDB, en este caso se hace dos triggers diferentes, uno para las inserciones y otro para las actualizaciones y el campo <code>operacion</code> se indica de forma manual en cada uno de ellos.</p>
<div class="highlight"><pre tabindex="0" style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-sql" data-lang="sql"><span style="display:flex;"><span>MariaDB<span style="color:#666"> </span>[scott]&gt;<span style="color:#666"> </span><span style="color:#6ab825;font-weight:bold">DELIMITER</span><span style="color:#666"> </span>//<span style="color:#666">
</span></span></span><span style="display:flex;"><span><span style="color:#666"></span>MariaDB<span style="color:#666"> </span>[scott]&gt;<span style="color:#666"> </span><span style="color:#6ab825;font-weight:bold">CREATE</span><span style="color:#666"> </span><span style="color:#6ab825;font-weight:bold">OR</span><span style="color:#666"> </span><span style="color:#6ab825;font-weight:bold">REPLACE</span><span style="color:#666"> </span><span style="color:#6ab825;font-weight:bold">TRIGGER</span><span style="color:#666"> </span>trigger_auditoria_emp_insert<span style="color:#666">
</span></span></span><span style="display:flex;"><span><span style="color:#666">    </span>-&gt;<span style="color:#666"> </span><span style="color:#6ab825;font-weight:bold">AFTER</span><span style="color:#666"> </span><span style="color:#6ab825;font-weight:bold">INSERT</span><span style="color:#666"> </span><span style="color:#6ab825;font-weight:bold">ON</span><span style="color:#666"> </span>emp<span style="color:#666">
</span></span></span><span style="display:flex;"><span><span style="color:#666">    </span>-&gt;<span style="color:#666"> </span><span style="color:#6ab825;font-weight:bold">FOR</span><span style="color:#666"> </span><span style="color:#6ab825;font-weight:bold">EACH</span><span style="color:#666"> </span><span style="color:#6ab825;font-weight:bold">ROW</span><span style="color:#666">
</span></span></span><span style="display:flex;"><span><span style="color:#666">    </span>-&gt;<span style="color:#666"> </span><span style="color:#6ab825;font-weight:bold">BEGIN</span><span style="color:#666">
</span></span></span><span style="display:flex;"><span><span style="color:#666">    </span>-&gt;<span style="color:#666">     </span><span style="color:#6ab825;font-weight:bold">IF</span><span style="color:#666"> </span><span style="color:#6ab825;font-weight:bold">NEW</span>.comm<span style="color:#666"> </span><span style="color:#6ab825;font-weight:bold">IS</span><span style="color:#666"> </span><span style="color:#6ab825;font-weight:bold">NOT</span><span style="color:#666"> </span><span style="color:#6ab825;font-weight:bold">NULL</span><span style="color:#666"> </span><span style="color:#6ab825;font-weight:bold">THEN</span><span style="color:#666">
</span></span></span><span style="display:flex;"><span><span style="color:#666">    </span>-&gt;<span style="color:#666">         </span><span style="color:#6ab825;font-weight:bold">INSERT</span><span style="color:#666"> </span><span style="color:#6ab825;font-weight:bold">INTO</span><span style="color:#666"> </span>auditoria<span style="color:#666"> 
</span></span></span><span style="display:flex;"><span><span style="color:#666">    </span>-&gt;<span style="color:#666">         </span><span style="color:#6ab825;font-weight:bold">VALUES</span><span style="color:#666"> </span>(NOW(),<span style="color:#ed9d13">&#39;INSERT&#39;</span>,<span style="color:#6ab825;font-weight:bold">CURRENT_USER</span>(),<span style="color:#6ab825;font-weight:bold">NEW</span>.empno,<span style="color:#6ab825;font-weight:bold">NEW</span>.comm);<span style="color:#666">
</span></span></span><span style="display:flex;"><span><span style="color:#666">    </span>-&gt;<span style="color:#666">     </span><span style="color:#6ab825;font-weight:bold">END</span><span style="color:#666"> </span><span style="color:#6ab825;font-weight:bold">IF</span>;<span style="color:#666">
</span></span></span><span style="display:flex;"><span><span style="color:#666">    </span>-&gt;<span style="color:#666"> </span><span style="color:#6ab825;font-weight:bold">END</span>;<span style="color:#666"> </span>//<span style="color:#666">
</span></span></span><span style="display:flex;"><span><span style="color:#666"></span>Query<span style="color:#666"> </span>OK,<span style="color:#666"> </span><span style="color:#3677a9">0</span><span style="color:#666"> </span><span style="color:#6ab825;font-weight:bold">rows</span><span style="color:#666"> </span>affected<span style="color:#666"> </span>(<span style="color:#3677a9">0</span>.<span style="color:#3677a9">006</span><span style="color:#666"> </span>sec)<span style="color:#666">
</span></span></span><span style="display:flex;"><span><span style="color:#666"></span>MariaDB<span style="color:#666"> </span>[scott]&gt;<span style="color:#666"> </span><span style="color:#6ab825;font-weight:bold">DELIMITER</span><span style="color:#666"> </span>;<span style="color:#666">
</span></span></span></code></pre></div><div class="highlight"><pre tabindex="0" style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-sql" data-lang="sql"><span style="display:flex;"><span>MariaDB<span style="color:#666"> </span>[scott]&gt;<span style="color:#666"> </span><span style="color:#6ab825;font-weight:bold">DELIMITER</span><span style="color:#666"> </span>//<span style="color:#666">
</span></span></span><span style="display:flex;"><span><span style="color:#666"></span>MariaDB<span style="color:#666"> </span>[scott]&gt;<span style="color:#666"> </span><span style="color:#6ab825;font-weight:bold">CREATE</span><span style="color:#666"> </span><span style="color:#6ab825;font-weight:bold">OR</span><span style="color:#666"> </span><span style="color:#6ab825;font-weight:bold">REPLACE</span><span style="color:#666"> </span><span style="color:#6ab825;font-weight:bold">TRIGGER</span><span style="color:#666"> </span>trigger_auditoria_emp_update<span style="color:#666">
</span></span></span><span style="display:flex;"><span><span style="color:#666">    </span>-&gt;<span style="color:#666"> </span><span style="color:#6ab825;font-weight:bold">AFTER</span><span style="color:#666"> </span><span style="color:#6ab825;font-weight:bold">UPDATE</span><span style="color:#666"> </span><span style="color:#6ab825;font-weight:bold">ON</span><span style="color:#666"> </span>emp<span style="color:#666">
</span></span></span><span style="display:flex;"><span><span style="color:#666">    </span>-&gt;<span style="color:#666"> </span><span style="color:#6ab825;font-weight:bold">FOR</span><span style="color:#666"> </span><span style="color:#6ab825;font-weight:bold">EACH</span><span style="color:#666"> </span><span style="color:#6ab825;font-weight:bold">ROW</span><span style="color:#666">
</span></span></span><span style="display:flex;"><span><span style="color:#666">    </span>-&gt;<span style="color:#666"> </span><span style="color:#6ab825;font-weight:bold">BEGIN</span><span style="color:#666">
</span></span></span><span style="display:flex;"><span><span style="color:#666">    </span>-&gt;<span style="color:#666">     </span><span style="color:#6ab825;font-weight:bold">IF</span><span style="color:#666"> </span><span style="color:#6ab825;font-weight:bold">NEW</span>.comm<span style="color:#666"> </span><span style="color:#6ab825;font-weight:bold">IS</span><span style="color:#666"> </span><span style="color:#6ab825;font-weight:bold">NOT</span><span style="color:#666"> </span><span style="color:#6ab825;font-weight:bold">NULL</span><span style="color:#666"> </span><span style="color:#6ab825;font-weight:bold">THEN</span><span style="color:#666">
</span></span></span><span style="display:flex;"><span><span style="color:#666">    </span>-&gt;<span style="color:#666">         </span><span style="color:#6ab825;font-weight:bold">INSERT</span><span style="color:#666"> </span><span style="color:#6ab825;font-weight:bold">INTO</span><span style="color:#666"> </span>auditoria<span style="color:#666"> 
</span></span></span><span style="display:flex;"><span><span style="color:#666">    </span>-&gt;<span style="color:#666">         </span><span style="color:#6ab825;font-weight:bold">VALUES</span><span style="color:#666"> </span>(NOW(),<span style="color:#ed9d13">&#39;UPDATE&#39;</span>,<span style="color:#6ab825;font-weight:bold">CURRENT_USER</span>(),<span style="color:#6ab825;font-weight:bold">NEW</span>.empno,<span style="color:#6ab825;font-weight:bold">NEW</span>.comm);<span style="color:#666">
</span></span></span><span style="display:flex;"><span><span style="color:#666">    </span>-&gt;<span style="color:#666">     </span><span style="color:#6ab825;font-weight:bold">END</span><span style="color:#666"> </span><span style="color:#6ab825;font-weight:bold">IF</span>;<span style="color:#666">
</span></span></span><span style="display:flex;"><span><span style="color:#666">    </span>-&gt;<span style="color:#666"> </span><span style="color:#6ab825;font-weight:bold">END</span>;<span style="color:#666"> </span>//<span style="color:#666">
</span></span></span><span style="display:flex;"><span><span style="color:#666"></span>Query<span style="color:#666"> </span>OK,<span style="color:#666"> </span><span style="color:#3677a9">0</span><span style="color:#666"> </span><span style="color:#6ab825;font-weight:bold">rows</span><span style="color:#666"> </span>affected<span style="color:#666"> </span>(<span style="color:#3677a9">0</span>.<span style="color:#3677a9">009</span><span style="color:#666"> </span>sec)<span style="color:#666">
</span></span></span><span style="display:flex;"><span><span style="color:#666"></span>MariaDB<span style="color:#666"> </span>[scott]&gt;<span style="color:#666"> </span><span style="color:#6ab825;font-weight:bold">DELIMITER</span><span style="color:#666"> </span>;<span style="color:#666">
</span></span></span></code></pre></div><p>Para probar el funcionamiento de los trigger, se realizan varias inserciones y alguna actualización en la tabla emp de Scott.</p>
<div class="highlight"><pre tabindex="0" style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-sql" data-lang="sql"><span style="display:flex;"><span>MariaDB<span style="color:#666"> </span>[scott]&gt;<span style="color:#666"> </span><span style="color:#6ab825;font-weight:bold">INSERT</span><span style="color:#666"> </span><span style="color:#6ab825;font-weight:bold">INTO</span><span style="color:#666"> </span>emp<span style="color:#666"> </span><span style="color:#6ab825;font-weight:bold">VALUES</span><span style="color:#666"> </span>(<span style="color:#3677a9">7901</span>,<span style="color:#ed9d13">&#39;LOLI&#39;</span>,<span style="color:#ed9d13">&#39;SALESMAN&#39;</span>,<span style="color:#3677a9">7698</span>,<span style="color:#ed9d13">&#39;1981-09-08&#39;</span>,<span style="color:#3677a9">1200</span>,<span style="color:#3677a9">20</span>,<span style="color:#3677a9">30</span>);<span style="color:#666">
</span></span></span><span style="display:flex;"><span><span style="color:#666"></span>Query<span style="color:#666"> </span>OK,<span style="color:#666"> </span><span style="color:#3677a9">1</span><span style="color:#666"> </span><span style="color:#6ab825;font-weight:bold">row</span><span style="color:#666"> </span>affected<span style="color:#666"> </span>(<span style="color:#3677a9">0</span>.<span style="color:#3677a9">001</span><span style="color:#666"> </span>sec)<span style="color:#666">
</span></span></span><span style="display:flex;"><span><span style="color:#666">
</span></span></span><span style="display:flex;"><span><span style="color:#666"></span>MariaDB<span style="color:#666"> </span>[scott]&gt;<span style="color:#666"> </span><span style="color:#6ab825;font-weight:bold">INSERT</span><span style="color:#666"> </span><span style="color:#6ab825;font-weight:bold">INTO</span><span style="color:#666"> </span>emp<span style="color:#666"> </span>(EMPNO,ENAME,JOB,MGR,HIREDATE,SAL,DEPTNO)<span style="color:#666"> </span><span style="color:#6ab825;font-weight:bold">VALUES</span><span style="color:#666"> </span>(<span style="color:#3677a9">7903</span>,<span style="color:#ed9d13">&#39;JUAN&#39;</span>,<span style="color:#ed9d13">&#39;CLERK&#39;</span>,<span style="color:#3677a9">7698</span>,<span style="color:#ed9d13">&#39;1981-09-03&#39;</span>,<span style="color:#3677a9">1050</span>,<span style="color:#3677a9">30</span>);<span style="color:#666">
</span></span></span><span style="display:flex;"><span><span style="color:#666"></span>Query<span style="color:#666"> </span>OK,<span style="color:#666"> </span><span style="color:#3677a9">1</span><span style="color:#666"> </span><span style="color:#6ab825;font-weight:bold">row</span><span style="color:#666"> </span>affected<span style="color:#666"> </span>(<span style="color:#3677a9">0</span>.<span style="color:#3677a9">002</span><span style="color:#666"> </span>sec)<span style="color:#666">
</span></span></span><span style="display:flex;"><span><span style="color:#666">
</span></span></span><span style="display:flex;"><span><span style="color:#666"></span>MariaDB<span style="color:#666"> </span>[scott]&gt;<span style="color:#666"> </span><span style="color:#6ab825;font-weight:bold">UPDATE</span><span style="color:#666"> </span>emp<span style="color:#666"> </span><span style="color:#6ab825;font-weight:bold">SET</span><span style="color:#666"> </span>COMM<span style="color:#666"> </span>=<span style="color:#666"> </span><span style="color:#3677a9">300</span><span style="color:#666"> </span><span style="color:#6ab825;font-weight:bold">WHERE</span><span style="color:#666"> </span>EMPNO<span style="color:#666"> </span>=<span style="color:#666"> </span><span style="color:#3677a9">7698</span>;<span style="color:#666">
</span></span></span><span style="display:flex;"><span><span style="color:#666"></span>Query<span style="color:#666"> </span>OK,<span style="color:#666"> </span><span style="color:#3677a9">1</span><span style="color:#666"> </span><span style="color:#6ab825;font-weight:bold">row</span><span style="color:#666"> </span>affected<span style="color:#666"> </span>(<span style="color:#3677a9">0</span>.<span style="color:#3677a9">002</span><span style="color:#666"> </span>sec)<span style="color:#666">
</span></span></span><span style="display:flex;"><span><span style="color:#666"></span><span style="color:#6ab825;font-weight:bold">Rows</span><span style="color:#666"> </span>matched:<span style="color:#666"> </span><span style="color:#3677a9">1</span><span style="color:#666">  </span>Changed:<span style="color:#666"> </span><span style="color:#3677a9">1</span><span style="color:#666">  </span>Warnings:<span style="color:#666"> </span><span style="color:#3677a9">0</span><span style="color:#666">
</span></span></span></code></pre></div><p>Al ejecutar estas sentencias, se disparan los triggers y en al tabla <code>auditoria</code> se almacena un registro cada vez que corresponde.</p>
<div class="highlight"><pre tabindex="0" style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-sql" data-lang="sql"><span style="display:flex;"><span>MariaDB<span style="color:#666"> </span>[scott]&gt;<span style="color:#666"> </span><span style="color:#6ab825;font-weight:bold">select</span><span style="color:#666"> </span>*<span style="color:#666"> </span><span style="color:#6ab825;font-weight:bold">from</span><span style="color:#666"> </span>auditoria;<span style="color:#666">
</span></span></span><span style="display:flex;"><span><span style="color:#666"></span>+<span style="color:#999;font-style:italic">---------------------+-----------+----------------+-------+------+
</span></span></span><span style="display:flex;"><span><span style="color:#999;font-style:italic"></span>|<span style="color:#666"> </span>fecha_hora<span style="color:#666">          </span>|<span style="color:#666"> </span>operacion<span style="color:#666"> </span>|<span style="color:#666"> </span>usuario<span style="color:#666">        </span>|<span style="color:#666"> </span>empno<span style="color:#666"> </span>|<span style="color:#666"> </span>comm<span style="color:#666"> </span>|<span style="color:#666">
</span></span></span><span style="display:flex;"><span><span style="color:#666"></span>+<span style="color:#999;font-style:italic">---------------------+-----------+----------------+-------+------+
</span></span></span><span style="display:flex;"><span><span style="color:#999;font-style:italic"></span>|<span style="color:#666"> </span><span style="color:#3677a9">2025</span>-<span style="color:#3677a9">02</span>-<span style="color:#3677a9">19</span><span style="color:#666"> </span><span style="color:#3677a9">17</span>:<span style="color:#3677a9">45</span>:<span style="color:#3677a9">05</span><span style="color:#666"> </span>|<span style="color:#666"> </span><span style="color:#6ab825;font-weight:bold">INSERT</span><span style="color:#666">    </span>|<span style="color:#666"> </span>root@localhost<span style="color:#666"> </span>|<span style="color:#666">  </span><span style="color:#3677a9">7901</span><span style="color:#666"> </span>|<span style="color:#666">   </span><span style="color:#3677a9">20</span><span style="color:#666"> </span>|<span style="color:#666">
</span></span></span><span style="display:flex;"><span><span style="color:#666"></span>|<span style="color:#666"> </span><span style="color:#3677a9">2025</span>-<span style="color:#3677a9">02</span>-<span style="color:#3677a9">19</span><span style="color:#666"> </span><span style="color:#3677a9">17</span>:<span style="color:#3677a9">45</span>:<span style="color:#3677a9">32</span><span style="color:#666"> </span>|<span style="color:#666"> </span><span style="color:#6ab825;font-weight:bold">UPDATE</span><span style="color:#666">    </span>|<span style="color:#666"> </span>root@localhost<span style="color:#666"> </span>|<span style="color:#666">  </span><span style="color:#3677a9">7698</span><span style="color:#666"> </span>|<span style="color:#666">  </span><span style="color:#3677a9">300</span><span style="color:#666"> </span>|<span style="color:#666">
</span></span></span><span style="display:flex;"><span><span style="color:#666"></span>+<span style="color:#999;font-style:italic">---------------------+-----------+----------------+-------+------+
</span></span></span><span style="display:flex;"><span><span style="color:#999;font-style:italic"></span><span style="color:#3677a9">2</span><span style="color:#666"> </span><span style="color:#6ab825;font-weight:bold">rows</span><span style="color:#666"> </span><span style="color:#6ab825;font-weight:bold">in</span><span style="color:#666"> </span><span style="color:#6ab825;font-weight:bold">set</span><span style="color:#666"> </span>(<span style="color:#3677a9">0</span>.<span style="color:#3677a9">001</span><span style="color:#666"> </span>sec)<span style="color:#666">
</span></span></span></code></pre></div><h1 id="averigua-las-posibilidades-que-ofrece-mongodb-para-auditar-los-cambios-que-va-sufriendo-un-documento-demuestra-su-funcionamiento">Averigua las posibilidades que ofrece MongoDB para auditar los cambios que va sufriendo un documento. Demuestra su funcionamiento.</h1>
<p>Las posibilidades de auditoría en las bases de datos de MongoDB difieren mucho según el nivel de pago del despliegue. Por ejemplo, los despliegues autogestionados de <a href="https://www.mongodb.com/docs/manual/tutorial/configure-auditing/"




 target="_blank"
 


>MongoDB Enterprise</a> y los despliegues <a href="https://www.mongodb.com/docs/atlas/database-auditing/#std-label-set-up-database-auditing"




 target="_blank"
 


>de pago en Atlas</a> cuentan con una herramienta de auditoría que permite registrar en los logs del sistema las operaciones realizadas sobre los documentos de las bases de datos del servidor. Esta herramienta, integrada con el sistema de logs de systemd (<code>--auditDestination syslog</code>), permite almacenar este registro de auditoría en formato (<code>--auditFormat</code>) de log, en formato JSON o en formato BSON. También ofrece la opción de mostrar una auditoría de las operaciones efectuadas sobere la base de datos en tiempo real por pantalla.</p>
<p>Puesto que esta herramienta sólo está disponible en despliegues de pago, no se puede demostrar su funcionamiento en este documento.</p>
<p>Además, también existen algunas herramientas de MongoDB que se integran con diferentes lenguajes de programación y permiten llevar un <a href="https://stackoverflow.com/questions/3507624/mongodb-nosql-keeping-document-change-history"




 target="_blank"
 


>control de las versiones de los documentos</a> cada vez que se modifica uno de ellos en una colección.</p>
<p>En los despligues de MongoDB Community Edition se puede usar la herramienta change streams para auditar las modificaciones sobre los documentos de una colección. Esta herramienta permite a las aplicaciones acceder a los cambios en tiempo real. Aunque la utilidad real de esta herramienta es permitir que las aplicaciones que se conectan a una base de datos MongoDB puedan acceder a la información sobre los cambios en los datos en las colecciones, bases de datos y despliegues de MongoDB para reaccionar a estos cambios de forma rápida, esta change streams también se puede usar para auditar los cambios que se producen sobre los documentos de una o varias colecciones de la base de datos.</p>
<p>Aunque esta herramienta está diseñada para funcionar en aplicaciones que se conectan a una base de datos MongoDB, se puede crear un Change Stream desde <code>mongosh</code> con el método <code>watch()</code>.</p>
<div class="highlight"><pre tabindex="0" style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash-session" data-lang="bash-session"><span style="display:flex;"><span><span style="color:#ccc">Atlas atlas-pk6i6y-shard-0 [primary] test&gt; watchCursor = db.eurovision.watch();
</span></span></span><span style="display:flex;"><span><span style="color:#ccc">ChangeStreamCursor on eurovision
</span></span></span></code></pre></div><p>Tras declarar el cursor en <code>mongosh</code> se puede iterar sobre los cambios que se producen en los documentos de la colección.</p>
<div class="highlight"><pre tabindex="0" style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-js" data-lang="js"><span style="display:flex;"><span><span style="color:#6ab825;font-weight:bold">while</span> (!watchCursor.isClosed()) {
</span></span><span style="display:flex;"><span>  <span style="color:#6ab825;font-weight:bold">let</span> next = watchCursor.tryNext()
</span></span><span style="display:flex;"><span>  <span style="color:#6ab825;font-weight:bold">while</span> (next !== <span style="color:#6ab825;font-weight:bold">null</span>) {
</span></span><span style="display:flex;"><span>    printjson(next);
</span></span><span style="display:flex;"><span>    next = watchCursor.tryNext()
</span></span><span style="display:flex;"><span>  }
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div><p>Para demostrar el funcionamiento de esta herramienta de auditoría se inserta un nuevo documento en esta colección, se modifica y se elimina.</p>
<div class="highlight"><pre tabindex="0" style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash-session" data-lang="bash-session"><span style="display:flex;"><span><span style="color:#ccc">Atlas atlas-pk6i6y-shard-0 [primary] test&gt; db.eurovision.insertOne({year: 2024
</span></span></span><span style="display:flex;"><span><span style="color:#ccc">}) 
</span></span></span><span style="display:flex;"><span><span style="color:#ccc">{
</span></span></span><span style="display:flex;"><span><span style="color:#ccc">  acknowledged: true,
</span></span></span><span style="display:flex;"><span><span style="color:#ccc">  insertedId: ObjectId(&#39;67b6296d193f96f504544ca7&#39;)
</span></span></span><span style="display:flex;"><span><span style="color:#ccc">}
</span></span></span><span style="display:flex;"><span><span style="color:#ccc">Atlas atlas-pk6i6y-shard-0 [primary] test&gt; db.eurovision.updateOne({year: 2024
</span></span></span><span style="display:flex;"><span><span style="color:#ccc">}, {$set: {year: 2025}})
</span></span></span><span style="display:flex;"><span><span style="color:#ccc">{
</span></span></span><span style="display:flex;"><span><span style="color:#ccc">  acknowledged: true,
</span></span></span><span style="display:flex;"><span><span style="color:#ccc">  insertedId: null,
</span></span></span><span style="display:flex;"><span><span style="color:#ccc">  matchedCount: 1,
</span></span></span><span style="display:flex;"><span><span style="color:#ccc">  modifiedCount: 1,
</span></span></span><span style="display:flex;"><span><span style="color:#ccc">  upsertedCount: 0
</span></span></span><span style="display:flex;"><span><span style="color:#ccc">}
</span></span></span><span style="display:flex;"><span><span style="color:#ccc">Atlas atlas-pk6i6y-shard-0 [primary] test&gt; db.eurovision.deleteOne({year: 2025
</span></span></span><span style="display:flex;"><span><span style="color:#ccc">}) 
</span></span></span><span style="display:flex;"><span><span style="color:#ccc">{ acknowledged: true, deletedCount: 1 }
</span></span></span></code></pre></div><p>Así, al realizar estas operaciones en la colección auditada, la salida del cursor Change Stream muestra la información sobre las modificaciones aplicadas.</p>
<div class="highlight"><pre tabindex="0" style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-js" data-lang="js"><span style="display:flex;"><span>Atlas atlas-pk6i6y-shard-<span style="color:#3677a9">0</span> [primary] test&gt; <span style="color:#6ab825;font-weight:bold">while</span> (!watchCursor.isClosed()) {
</span></span><span style="display:flex;"><span>...   <span style="color:#6ab825;font-weight:bold">let</span> next = watchCursor.tryNext()
</span></span><span style="display:flex;"><span>...   <span style="color:#6ab825;font-weight:bold">while</span> (next !== <span style="color:#6ab825;font-weight:bold">null</span>) {
</span></span><span style="display:flex;"><span>...     printjson(next);
</span></span><span style="display:flex;"><span>...     next = watchCursor.tryNext()
</span></span><span style="display:flex;"><span>...   }
</span></span><span style="display:flex;"><span>... }
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>{
</span></span><span style="display:flex;"><span>  _id: {
</span></span><span style="display:flex;"><span>    _data: <span style="color:#ed9d13">&#39;8267B6296D000000012B042C0100296E5A100420292B49D72D4CBAAD5C7DF95F02A1B9463C6F7065726174696F6E54797065003C696E736572740046646F63756D656E744B65790046645F6964006467B6296D193F96F504544CA7000004&#39;</span>
</span></span><span style="display:flex;"><span>  },
</span></span><span style="display:flex;"><span>  operationType: <span style="color:#ed9d13">&#39;insert&#39;</span>,
</span></span><span style="display:flex;"><span>  clusterTime: Timestamp({ t: <span style="color:#3677a9">1739991405</span>, i: <span style="color:#3677a9">1</span> }),
</span></span><span style="display:flex;"><span>  wallTime: ISODate(<span style="color:#ed9d13">&#39;2025-02-19T18:56:45.878Z&#39;</span>),
</span></span><span style="display:flex;"><span>  fullDocument: {
</span></span><span style="display:flex;"><span>    _id: ObjectId(<span style="color:#ed9d13">&#39;67b6296d193f96f504544ca7&#39;</span>),
</span></span><span style="display:flex;"><span>    year: <span style="color:#3677a9">2024</span>
</span></span><span style="display:flex;"><span>  },
</span></span><span style="display:flex;"><span>  ns: {
</span></span><span style="display:flex;"><span>    db: <span style="color:#ed9d13">&#39;test&#39;</span>,
</span></span><span style="display:flex;"><span>    coll: <span style="color:#ed9d13">&#39;eurovision&#39;</span>
</span></span><span style="display:flex;"><span>  },
</span></span><span style="display:flex;"><span>  documentKey: {
</span></span><span style="display:flex;"><span>    _id: ObjectId(<span style="color:#ed9d13">&#39;67b6296d193f96f504544ca7&#39;</span>)
</span></span><span style="display:flex;"><span>  }
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span>{
</span></span><span style="display:flex;"><span>  _id: {
</span></span><span style="display:flex;"><span>    _data: <span style="color:#ed9d13">&#39;8267B629FF000000012B042C0100296E5A100420292B49D72D4CBAAD5C7DF95F02A1B9463C6F7065726174696F6E54797065003C7570646174650046646F63756D656E744B65790046645F6964006467B6296D193F96F504544CA7000004&#39;</span>
</span></span><span style="display:flex;"><span>  },
</span></span><span style="display:flex;"><span>  operationType: <span style="color:#ed9d13">&#39;update&#39;</span>,
</span></span><span style="display:flex;"><span>  clusterTime: Timestamp({ t: <span style="color:#3677a9">1739991551</span>, i: <span style="color:#3677a9">1</span> }),
</span></span><span style="display:flex;"><span>  wallTime: ISODate(<span style="color:#ed9d13">&#39;2025-02-19T18:59:11.065Z&#39;</span>),
</span></span><span style="display:flex;"><span>  ns: {
</span></span><span style="display:flex;"><span>    db: <span style="color:#ed9d13">&#39;test&#39;</span>,
</span></span><span style="display:flex;"><span>    coll: <span style="color:#ed9d13">&#39;eurovision&#39;</span>
</span></span><span style="display:flex;"><span>  },
</span></span><span style="display:flex;"><span>  documentKey: {
</span></span><span style="display:flex;"><span>    _id: ObjectId(<span style="color:#ed9d13">&#39;67b6296d193f96f504544ca7&#39;</span>)
</span></span><span style="display:flex;"><span>  },
</span></span><span style="display:flex;"><span>  updateDescription: {
</span></span><span style="display:flex;"><span>    updatedFields: {
</span></span><span style="display:flex;"><span>      year: <span style="color:#3677a9">2025</span>
</span></span><span style="display:flex;"><span>    },
</span></span><span style="display:flex;"><span>    removedFields: [],
</span></span><span style="display:flex;"><span>    truncatedArrays: []
</span></span><span style="display:flex;"><span>  }
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span>{
</span></span><span style="display:flex;"><span>  _id: {
</span></span><span style="display:flex;"><span>    _data: <span style="color:#ed9d13">&#39;8267B62A1E000000012B042C0100296E5A100420292B49D72D4CBAAD5C7DF95F02A1B9463C6F7065726174696F6E54797065003C64656C6574650046646F63756D656E744B65790046645F6964006467B6296D193F96F504544CA7000004&#39;</span>
</span></span><span style="display:flex;"><span>  },
</span></span><span style="display:flex;"><span>  operationType: <span style="color:#ed9d13">&#39;delete&#39;</span>,
</span></span><span style="display:flex;"><span>  clusterTime: Timestamp({ t: <span style="color:#3677a9">1739991582</span>, i: <span style="color:#3677a9">1</span> }),
</span></span><span style="display:flex;"><span>  wallTime: ISODate(<span style="color:#ed9d13">&#39;2025-02-19T18:59:42.047Z&#39;</span>),
</span></span><span style="display:flex;"><span>  ns: {
</span></span><span style="display:flex;"><span>    db: <span style="color:#ed9d13">&#39;test&#39;</span>,
</span></span><span style="display:flex;"><span>    coll: <span style="color:#ed9d13">&#39;eurovision&#39;</span>
</span></span><span style="display:flex;"><span>  },
</span></span><span style="display:flex;"><span>  documentKey: {
</span></span><span style="display:flex;"><span>    _id: ObjectId(<span style="color:#ed9d13">&#39;67b6296d193f96f504544ca7&#39;</span>)
</span></span><span style="display:flex;"><span>  }
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div><h1 id="averigua-si-en-mongodb-se-pueden-auditar-los-accesos-a-una-colección-concreta-demuestra-su-funcionamiento">Averigua si en MongoDB se pueden auditar los accesos a una colección concreta. Demuestra su funcionamiento.</h1>
<p>Como ocurre con la auditoría de operaciones sobre los documentos, la auditoría de accesos a una colección es diferente según el nivel de pago del sistema gestor de base de datos. En MongoDB Enterprise y los clusters de pago de AtlasDB, es posible auditar con detalle el acceso a colecciones concretas usando la herramienta auditLog.</p>
<p>En cambio, en los clusters gratuitos de AtlasDB, así como en los despliegues autogestionados de MongoDB Community Edition esta herramienta no se puede usar y, por lo tanto, no existe un mecanismo para auditar los accesos a las colecciones de las bases de datos.</p>
<h1 id="averigua-si-en-cassandra-se-pueden-auditar-las-inserciones-de-datos">Averigua si en Cassandra se pueden auditar las inserciones de datos.</h1>
<p>Cassandra cuenta con una utilidad para generar logs de auditoría llamada Audit Logging. Esta herramietna se configura en el fichero de configuración principal del sistema gestor de bases de datos: /etc/cassandra/cassandra.yaml, en la instalación estándar de Cassandra en Debian.</p>
<div class="highlight"><pre tabindex="0" style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-yaml" data-lang="yaml"><span style="display:flex;"><span><span style="color:#999;font-style:italic"># Audit logging - Logs every incoming CQL command request, authentication to a</span><span style="color:#666">
</span></span></span><span style="display:flex;"><span><span style="color:#666"></span><span style="color:#999;font-style:italic"># on audit_logging for full details about the various configuration options.</span><span style="color:#666">
</span></span></span><span style="display:flex;"><span><span style="color:#666"></span><span style="color:#6ab825;font-weight:bold">audit_logging_options</span>:<span style="color:#666">
</span></span></span><span style="display:flex;"><span><span style="color:#666">  </span><span style="color:#6ab825;font-weight:bold">enabled</span>:<span style="color:#666"> </span><span style="color:#6ab825;font-weight:bold">true</span><span style="color:#666">
</span></span></span><span style="display:flex;"><span><span style="color:#666">  </span><span style="color:#6ab825;font-weight:bold">logger</span>:<span style="color:#666">
</span></span></span><span style="display:flex;"><span><span style="color:#666">    </span>- <span style="color:#6ab825;font-weight:bold">class_name</span>:<span style="color:#666"> </span>BinAuditLogger<span style="color:#666">
</span></span></span><span style="display:flex;"><span><span style="color:#666">  </span><span style="color:#6ab825;font-weight:bold">audit_logs_dir</span>:<span style="color:#666"> </span><span style="color:#ed9d13">&#34;/cassandra/audit/logs/hourly&#34;</span><span style="color:#666">
</span></span></span><span style="display:flex;"><span><span style="color:#666">  </span><span style="color:#999;font-style:italic"># included_keyspaces:</span><span style="color:#666">
</span></span></span><span style="display:flex;"><span><span style="color:#666">  </span><span style="color:#999;font-style:italic"># excluded_keyspaces: system, system_schema, system_virtual_schema</span><span style="color:#666">
</span></span></span><span style="display:flex;"><span><span style="color:#666">  </span><span style="color:#999;font-style:italic"># included_categories:</span><span style="color:#666">
</span></span></span><span style="display:flex;"><span><span style="color:#666">  </span><span style="color:#999;font-style:italic"># excluded_categories:</span><span style="color:#666">
</span></span></span><span style="display:flex;"><span><span style="color:#666">  </span><span style="color:#999;font-style:italic"># included_users:</span><span style="color:#666">
</span></span></span><span style="display:flex;"><span><span style="color:#666">  </span><span style="color:#999;font-style:italic"># excluded_users:</span><span style="color:#666">
</span></span></span><span style="display:flex;"><span><span style="color:#666">  </span><span style="color:#6ab825;font-weight:bold">roll_cycle</span>:<span style="color:#666"> </span>HOURLY<span style="color:#666">
</span></span></span><span style="display:flex;"><span><span style="color:#666">  </span><span style="color:#999;font-style:italic"># block: true</span><span style="color:#666">
</span></span></span><span style="display:flex;"><span><span style="color:#666">  </span><span style="color:#999;font-style:italic"># max_queue_weight: 268435456 # 256 MiB</span><span style="color:#666">
</span></span></span><span style="display:flex;"><span><span style="color:#666">  </span><span style="color:#999;font-style:italic"># max_log_size: 17179869184 # 16 GiB</span><span style="color:#666">
</span></span></span><span style="display:flex;"><span><span style="color:#666">  </span><span style="color:#999;font-style:italic">## archive command is &#34;/path/to/script.sh %path&#34; where %path is replaced with</span><span style="color:#666">
</span></span></span><span style="display:flex;"><span><span style="color:#666">  </span><span style="color:#999;font-style:italic"># archive_command:</span><span style="color:#666">
</span></span></span><span style="display:flex;"><span><span style="color:#666">  </span><span style="color:#999;font-style:italic"># max_archive_retries: 10</span><span style="color:#666">
</span></span></span></code></pre></div><p>Para aplicar la configuración, se reinicia el serviicio.</p>
<div class="highlight"><pre tabindex="0" style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>sudo systemctl restart cassandra
</span></span></code></pre></div><p>Para que Cassandra pueda escribir los logs debe existir el directorio que se indica en el fichero de configuración en el sistema y, además, debe tener permiso de lectura, escritura y ejecución para otros.</p>
<div class="highlight"><pre tabindex="0" style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>sudo mkdir -p /cassandra/audit/logs/hourly
</span></span><span style="display:flex;"><span>sudo chmod -R a+rwx /cassandra/audit/logs/hourly
</span></span></code></pre></div><p>Para demostrar el funcionamiento de la herramienta de auditoría en Cassandra, se crea un nuevo keyspace y una tabla en él y se insertan algunos datos.</p>
<div class="highlight"><pre tabindex="0" style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-sql" data-lang="sql"><span style="display:flex;"><span>cassandra@cqlsh&gt;<span style="color:#666"> </span><span style="color:#6ab825;font-weight:bold">CREATE</span><span style="color:#666"> </span>KEYSPACE<span style="color:#666"> </span>prueba<span style="color:#666">
</span></span></span><span style="display:flex;"><span><span style="color:#666">   </span>...<span style="color:#666"> </span><span style="color:#6ab825;font-weight:bold">WITH</span><span style="color:#666"> </span>replication<span style="color:#666"> </span>=<span style="color:#666"> </span><span style="color:#a61717;background-color:#e3d2d2">{</span><span style="color:#ed9d13">&#39;class&#39;</span>:<span style="color:#666"> </span><span style="color:#ed9d13">&#39;SimpleStrategy&#39;</span>,<span style="color:#666"> </span><span style="color:#ed9d13">&#39;replication_factor&#39;</span><span style="color:#666"> </span>:<span style="color:#666"> </span><span style="color:#3677a9">1</span><span style="color:#a61717;background-color:#e3d2d2">}</span>;<span style="color:#666">
</span></span></span><span style="display:flex;"><span><span style="color:#666"></span>cassandra@cqlsh&gt;<span style="color:#666"> </span>USE<span style="color:#666"> </span>prueba;<span style="color:#666">
</span></span></span><span style="display:flex;"><span><span style="color:#666"></span>cassandra@cqlsh:prueba&gt;<span style="color:#666"> </span><span style="color:#6ab825;font-weight:bold">CREATE</span><span style="color:#666"> </span><span style="color:#6ab825;font-weight:bold">TABLE</span><span style="color:#666"> </span>prueba1(id<span style="color:#666"> </span><span style="color:#24909d">int</span>,<span style="color:#666">
</span></span></span><span style="display:flex;"><span><span style="color:#666">          </span>...<span style="color:#666"> </span><span style="color:#6ab825;font-weight:bold">PRIMARY</span><span style="color:#666"> </span><span style="color:#6ab825;font-weight:bold">KEY</span><span style="color:#666"> </span>(id)<span style="color:#666">
</span></span></span><span style="display:flex;"><span><span style="color:#666">          </span>...<span style="color:#666"> </span>);<span style="color:#666">
</span></span></span><span style="display:flex;"><span><span style="color:#666"></span>cassandra@cqlsh:prueba&gt;<span style="color:#666"> </span><span style="color:#6ab825;font-weight:bold">INSERT</span><span style="color:#666"> </span><span style="color:#6ab825;font-weight:bold">INTO</span><span style="color:#666"> </span>prueba1<span style="color:#666"> </span>(id)<span style="color:#666"> </span><span style="color:#6ab825;font-weight:bold">VALUES</span><span style="color:#666"> </span>(<span style="color:#3677a9">1</span>);<span style="color:#666">
</span></span></span><span style="display:flex;"><span><span style="color:#666"></span>cassandra@cqlsh:prueba&gt;<span style="color:#666"> </span><span style="color:#6ab825;font-weight:bold">INSERT</span><span style="color:#666"> </span><span style="color:#6ab825;font-weight:bold">INTO</span><span style="color:#666"> </span>prueba1<span style="color:#666"> </span>(id)<span style="color:#666"> </span><span style="color:#6ab825;font-weight:bold">VALUES</span><span style="color:#666"> </span>(<span style="color:#3677a9">2</span>);<span style="color:#666">
</span></span></span><span style="display:flex;"><span><span style="color:#666"></span>cassandra@cqlsh:prueba&gt;<span style="color:#666"> </span><span style="color:#6ab825;font-weight:bold">INSERT</span><span style="color:#666"> </span><span style="color:#6ab825;font-weight:bold">INTO</span><span style="color:#666"> </span>prueba1<span style="color:#666"> </span>(id)<span style="color:#666"> </span><span style="color:#6ab825;font-weight:bold">VALUES</span><span style="color:#666"> </span>(<span style="color:#3677a9">3</span>);<span style="color:#666">
</span></span></span><span style="display:flex;"><span><span style="color:#666"></span>cassandra@cqlsh:prueba&gt;<span style="color:#666"> </span><span style="color:#6ab825;font-weight:bold">DELETE</span><span style="color:#666"> </span><span style="color:#6ab825;font-weight:bold">FROM</span><span style="color:#666"> </span>prueba1<span style="color:#666"> </span><span style="color:#6ab825;font-weight:bold">WHERE</span><span style="color:#666"> </span>id=<span style="color:#3677a9">3</span>;<span style="color:#666">
</span></span></span><span style="display:flex;"><span><span style="color:#666"></span>cassandra@cqlsh:prueba&gt;<span style="color:#666"> </span><span style="color:#6ab825;font-weight:bold">SELECT</span><span style="color:#666"> </span>*<span style="color:#666"> </span><span style="color:#6ab825;font-weight:bold">FROM</span><span style="color:#666"> </span>prueba1;<span style="color:#666">
</span></span></span><span style="display:flex;"><span><span style="color:#666">
</span></span></span><span style="display:flex;"><span><span style="color:#666"> </span>id<span style="color:#666">
</span></span></span><span style="display:flex;"><span><span style="color:#666"></span><span style="color:#999;font-style:italic">----
</span></span></span><span style="display:flex;"><span><span style="color:#999;font-style:italic"></span><span style="color:#666">  </span><span style="color:#3677a9">1</span><span style="color:#666">
</span></span></span><span style="display:flex;"><span><span style="color:#666">  </span><span style="color:#3677a9">2</span><span style="color:#666">
</span></span></span><span style="display:flex;"><span><span style="color:#666">
</span></span></span><span style="display:flex;"><span><span style="color:#666"></span>(<span style="color:#3677a9">2</span><span style="color:#666"> </span><span style="color:#6ab825;font-weight:bold">rows</span>)<span style="color:#666">
</span></span></span></code></pre></div><p>Por defecto, estos ficheros de log se almacenan en formato binario. Aunque se pueden guardar en texto plano cambiando el parámetro <code>logger</code> a <code>FileAuditLogger</code> en el fichero de configuración, los logs en formato binario también se pueden leer con la herramienta <code>auditlogviewer</code> de Cassandra.</p>
<div class="highlight"><pre tabindex="0" style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash-session" data-lang="bash-session"><span style="display:flex;"><span><span style="color:#ccc">debian@bbdd:~$ auditlogviewer /cassandra/audit/logs/hourly
</span></span></span><span style="display:flex;"><span><span style="color:#ccc">...
</span></span></span><span style="display:flex;"><span><span style="color:#ccc">Type: audit
</span></span></span><span style="display:flex;"><span><span style="color:#ccc">LogMessage: user:cassandra|host:localhost/127.0.0.1:7000|source:/127.0.0.1|port:35794|timestamp:1739993561209|type:LOGIN_SUCCESS|category:AUTH|operation:LOGIN SUCCESSFUL Type: audit
</span></span></span><span style="display:flex;"><span><span style="color:#ccc">LogMessage: user:cassandra|host:localhost/127.0.0.1:7000|source:/127.0.0.1|port:35794|timestamp:1739993590190|type:USE_KEYSPACE|category:OTHER|ks:prueba|operation:use prueba ; Type: audit
</span></span></span><span style="display:flex;"><span><span style="color:#ccc">LogMessage: user:cassandra|host:localhost/127.0.0.1:7000|source:/127.0.0.1|port:35794| imestamp:1739993590194|type:USE_KEYSPACE|category:OTHER|ks:prueba|ope ration:USE &#34;prueba&#34; Type: audit 
</span></span></span><span style="display:flex;"><span><span style="color:#ccc">LogMessage: user:cassandra|host:localhost/127.0.0.1:7000|source:/127.0.0.1|port:35794|timestamp:1739993606766|type:CREATE_TABLE|category:DDL|ks:prueba|scope:prueba1|operation:CREATE TABLE prueba1(id int, PRIMARY KEY (id) ); Type: audit
</span></span></span><span style="display:flex;"><span><span style="color:#ccc">LogMessage: user:cassandra|host:localhost/127.0.0.1:7000|source:/127.0.0.1|port:35794|timestamp:1739993628464|type:UPDATE|category:DML|ks:prueba|scope:prueba1|operation:INSERT INTO prueba1 (id) VALUES (1); Type: audit
</span></span></span><span style="display:flex;"><span><span style="color:#ccc">LogMessage: user:cassandra|host:localhost/127.0.0.1:7000|source:/127.0.0.1|port:35794|timestamp:1739993628470|type:UPDATE|category:DML|ks:prueba|scope:prueba1|operation:INSERT INTO prueba1 (id) VALUES (2); Type: audit
</span></span></span><span style="display:flex;"><span><span style="color:#ccc">LogMessage: user:cassandra|host:localhost/127.0.0.1:7000|source:/127.0.0.1|port:35794|timestamp:1739993628473|type:UPDATE|category:DML|ks:prueba|scope:prueba1|operation:INSERT INTO prueba1 (id) VALUES (3); Type: audit
</span></span></span><span style="display:flex;"><span><span style="color:#ccc">LogMessage: user:cassandra|host:localhost/127.0.0.1:7000|source:/127.0.0.1|port:35794|timestamp:1739993628479|type:DELETE|category:DML|ks:prueba|scope:prueba1|operation:DELETE FROM prueba1 WHERE id=3; Type: audit
</span></span></span><span style="display:flex;"><span><span style="color:#ccc">LogMessage: user:cassandra|host:localhost/127.0.0.1:7000|source:/127.0.0.1|port:35794|timestamp:1739993629069|type:SELECT|category:QUERY|ks:prueba|scope:prueba1|operation:SELECT * FROM prueba1;
</span></span></span></code></pre></div><p>Para filtrar el contenido de este log se puede usar una herramienta como <code>grep</code>. Así, por ejemplo, si se quiere llevar una auditoría únicamente de las inserciones en las tablas se puede filtrar el fichero de log por aquellas entradas en las que la operación sea <code>INSERT</code>.</p>
<div class="highlight"><pre tabindex="0" style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash-session" data-lang="bash-session"><span style="display:flex;"><span><span style="color:#ccc">debian@bbdd:~$ auditlogviewer /cassandra/audit/logs/hourly | grep &#39;operation:INSERT&#39; 
</span></span></span><span style="display:flex;"><span><span style="color:#ccc">LogMessage: user:cassandra|host:localhost/127.0.0.1:7000|source:/127.0.0.1|port:35794|timestamp:1739993628464|type:UPDATE|category:DML|ks:prueba|scope:prueba1|operation:INSERT INTO prueba1 (id) VALUES (1);
</span></span></span><span style="display:flex;"><span><span style="color:#ccc">LogMessage: user:cassandra|host:localhost/127.0.0.1:7000|source:/127.0.0.1|port:35794|timestamp:1739993628470|type:UPDATE|category:DML|ks:prueba|scope:prueba1|operation:INSERT INTO prueba1 (id) VALUES (2);
</span></span></span><span style="display:flex;"><span><span style="color:#ccc">LogMessage: user:cassandra|host:localhost/127.0.0.1:7000|source:/127.0.0.1|port:35794|timestamp:1739993628473|type:UPDATE|category:DML|ks:prueba|scope:prueba1|operation:INSERT INTO prueba1 (id) VALUES (3);
</span></span></span></code></pre></div><h1 id="fuentes">Fuentes</h1>
<p><a href="https://www.dbapath.com/oracle-audit-table-example/"




 target="_blank"
 


>Oracle audit table example</a></p>
<p><a href="https://docs.oracle.com/en/database/oracle/oracle-database/19/sqlrf/AUDIT-Traditional-Auditing.html"




 target="_blank"
 


>AUDIT (Traditional Auditing) </a></p>
<p><a href="https://docs.oracle.com/en/database/oracle/oracle-database/19/dbseg/introduction-to-auditing.html"




 target="_blank"
 


>26 Introduction to Auditing </a></p>
<p><a href="https://www.netwrix.com/how_to_track_down_failed_oracle_logon_attempts.html"




 target="_blank"
 


>Enable Oracle Audit of Failed Login Attempts to Shield Your Sensitive Data </a></p>
<p><a href="https://docs.oracle.com/en/database/oracle/oracle-database/19/refrn/DBA_PRIV_AUDIT_OPTS.html"




 target="_blank"
 


>5.249 DBA_PRIV_AUDIT_OPTS </a></p>
<p><a href="https://docs.oracle.com/en/database/oracle/oracle-database/19/refrn/DBA_AUDIT_SESSION.html"




 target="_blank"
 


>4.159 DBA_AUDIT_SESSION </a></p>
<p><a href="https://www.oracle.com/a/tech/docs/dbsec/unified-audit-best-practice-guidelines.pdf"




 target="_blank"
 


>Oracle Database Unified Audit: Best Practice Guidelines</a></p>
<p><a href="https://dba.stackexchange.com/questions/166252/how-to-track-failed-logon-attempts-using-unified-auditing"




 target="_blank"
 


>How to track failed logon attempts using Unified Auditing</a></p>
<p><a href="https://w3buddy.com/how-to-monitor-identify-failed-login-attempts-oracle/"




 target="_blank"
 


>How to Monitor and Identify Failed Login Attempts in Oracle</a></p>
<p><a href="https://orasite.com/errores"




 target="_blank"
 


>Errores ORACLE mas consultados </a></p>
<p><a href="https://docs.oracle.com/en/database/oracle/oracle-database/19/errmg/ORA-24280.html"




 target="_blank"
 


>85 ORA-24280 to ORA-28726</a></p>
<p><a href="https://dbaclass.com/article/useful-oracle-auditing-related-commands/"




 target="_blank"
 


>Useful oracle auditing related commands</a></p>
<p><a href="https://dba.stackexchange.com/questions/268718/audit-all-insert-delete-update-and-select-statements-on-a-schema-in-oracle-12"




 target="_blank"
 


>Audit all insert, delete, update and select statements on a schema in Oracle 12.2</a></p>
<p><a href="https://docs.oracle.com/en/database/oracle///oracle-database/23/dbseg/value-based-auditing-fine-grained-audit-policies1.html#GUID-7B732634-57CC-475D-9652-632D6F957C51"




 target="_blank"
 


>31 Value-Based Auditing with Fine-Grained Audit Policies </a></p>
<p><a href="https://docs.oracle.com/en/database/oracle/oracle-database/19/arpls/DBMS_FGA.html#GUID-DC7B93AE-4390-4D27-9CAC-43DC932D8622"




 target="_blank"
 


>71 DBMS_FGA</a></p>
<p><a href="https://dbtut.com/index.php/2018/09/14/steps-to-implement-oracle-fine-grained-auditing-fga/"




 target="_blank"
 


>Steps to implement Oracle Fine Grained Auditing (FGA)</a></p>
<p><a href="https://docs.oracle.com/en/database/oracle/oracle-database/12.2/refrn/DBA_AUDIT_TRAIL.html"




 target="_blank"
 


>4.118 DBA_AUDIT_TRAIL</a></p>
<p><a href="https://docs.oracle.com/en/database/oracle/oracle-database/19/refrn/AUDIT_TRAIL.html"




 target="_blank"
 


>1.26 AUDIT_TRAIL </a></p>
<p><a href="https://jhdba.wordpress.com/2014/07/15/the-value-of-audit_traildbextended/"




 target="_blank"
 


>The value of audit_trail=DB,EXTENDED</a></p>
<p><a href="https://github.com/pgaudit/pgaudit/blob/main/README.md"




 target="_blank"
 


>pgAudit. Open Source PostgreSQL Audit Logging</a></p>
<p><a href="https://ozwizard.medium.com/postgres-database-audit-policies-de4e6c5f0eb2"




 target="_blank"
 


>https://ozwizard.medium.com/postgres-database-audit-policies-de4e6c5f0eb2</a></p>
<p><a href="https://stormatics.tech/blogs/guide-to-auditing-and-monitoring-access-in-postgresql"




 target="_blank"
 


>Guide to Auditing and Monitoring Access in PostgreSQL</a></p>
<p><a href="https://serverfault.com/questions/65255/log-mysql-login-attempts"




 target="_blank"
 


>Log MySQL login attempts</a></p>
<p><a href="https://mariadb.com/kb/en/mariadb-audit-plugin/"




 target="_blank"
 


>MariaDB Audit Plugin</a></p>
<p><a href="https://mariadb.com/kb/en/mariadb-audit-plugin-log-settings/"




 target="_blank"
 


>MariaDB Audit Plugin - Log Settings</a></p>
<p><a href="https://mariadb.com/kb/en/trigger-overview/"




 target="_blank"
 


>Trigger Overview</a></p>
<p><a href="https://www.mongodb.com/docs/manual/core/auditing/"




 target="_blank"
 


>Auditing Self-Managed Deployments</a></p>
<p><a href="https://medium.com/helicap-engineering/audit-trails-with-mongodbs-change-stream-a3b5739c33a7"




 target="_blank"
 


>Audit trails with MongoDB’s change stream</a></p>
<p><a href="https://www.mongodb.com/resources/products/capabilities/change-streams"




 target="_blank"
 


>How Do Change Streams Work in MongoDB?</a></p>
<p><a href="https://www.mongodb.com/docs/manual/changeStreams/"




 target="_blank"
 


>Change Streams</a></p>
<p><a href="https://www.slingacademy.com/article/working-with-change-streams-in-mongodb-with-examples/"




 target="_blank"
 


>Working with Change Streams in MongoDB (with examples)</a></p>
<p><a href="https://www.mongodb.com/docs/manual/reference/method/db.collection.watch/#mongodb-method-db.collection.watch"




 target="_blank"
 


>db.collection.watch()</a></p>
<p><a href="https://www.mongodb.com/docs/manual/reference/operator/aggregation/changeStream/#mongodb-pipeline-pipe.-changeStream"




 target="_blank"
 


>$changeStream (aggregation)</a></p>
<p><a href="https://cassandra.apache.org/doc/stable/cassandra/operating/auditlogging.html"




 target="_blank"
 


>Audit Logging - Cassandra</a></p>

          </div>
          <div class="row items-start justify-between">
            
            
              <div class="lg:col-5 mb-10 flex items-center lg:mb-0">
                <h5 class="mr-3">Tags :</h5>
                <ul>
                  
                    <li class="inline-block">
                      <a
                        class="bg-theme-light hover:bg-primary dark:bg-darkmode-theme-light dark:hover:bg-darkmode-primary dark:hover:text-dark m-1 block rounded px-3 py-1 hover:text-white"
                        href="/tags/bases-de-datos/">
                        Bases de datos
                      </a>
                    </li>
                  
                    <li class="inline-block">
                      <a
                        class="bg-theme-light hover:bg-primary dark:bg-darkmode-theme-light dark:hover:bg-darkmode-primary dark:hover:text-dark m-1 block rounded px-3 py-1 hover:text-white"
                        href="/tags/postgresql/">
                        Postgre SQL
                      </a>
                    </li>
                  
                    <li class="inline-block">
                      <a
                        class="bg-theme-light hover:bg-primary dark:bg-darkmode-theme-light dark:hover:bg-darkmode-primary dark:hover:text-dark m-1 block rounded px-3 py-1 hover:text-white"
                        href="/tags/oracle/">
                        Oracle
                      </a>
                    </li>
                  
                    <li class="inline-block">
                      <a
                        class="bg-theme-light hover:bg-primary dark:bg-darkmode-theme-light dark:hover:bg-darkmode-primary dark:hover:text-dark m-1 block rounded px-3 py-1 hover:text-white"
                        href="/tags/mariadb/">
                        Maria db
                      </a>
                    </li>
                  
                    <li class="inline-block">
                      <a
                        class="bg-theme-light hover:bg-primary dark:bg-darkmode-theme-light dark:hover:bg-darkmode-primary dark:hover:text-dark m-1 block rounded px-3 py-1 hover:text-white"
                        href="/tags/mysql/">
                        My SQL
                      </a>
                    </li>
                  
                    <li class="inline-block">
                      <a
                        class="bg-theme-light hover:bg-primary dark:bg-darkmode-theme-light dark:hover:bg-darkmode-primary dark:hover:text-dark m-1 block rounded px-3 py-1 hover:text-white"
                        href="/tags/cassandra/">
                        Cassandra
                      </a>
                    </li>
                  
                    <li class="inline-block">
                      <a
                        class="bg-theme-light hover:bg-primary dark:bg-darkmode-theme-light dark:hover:bg-darkmode-primary dark:hover:text-dark m-1 block rounded px-3 py-1 hover:text-white"
                        href="/tags/mongodb/">
                        Mongo db
                      </a>
                    </li>
                  
                    <li class="inline-block">
                      <a
                        class="bg-theme-light hover:bg-primary dark:bg-darkmode-theme-light dark:hover:bg-darkmode-primary dark:hover:text-dark m-1 block rounded px-3 py-1 hover:text-white"
                        href="/tags/auditor%c3%ada/">
                        Auditoría
                      </a>
                    </li>
                  
                    <li class="inline-block">
                      <a
                        class="bg-theme-light hover:bg-primary dark:bg-darkmode-theme-light dark:hover:bg-darkmode-primary dark:hover:text-dark m-1 block rounded px-3 py-1 hover:text-white"
                        href="/tags/administracion-bbdd/">
                        Administracion bbdd
                      </a>
                    </li>
                  
                    <li class="inline-block">
                      <a
                        class="bg-theme-light hover:bg-primary dark:bg-darkmode-theme-light dark:hover:bg-darkmode-primary dark:hover:text-dark m-1 block rounded px-3 py-1 hover:text-white"
                        href="/tags/administraci%c3%b3n-de-sistemas-gestores-de-bases-de-datos/">
                        Administración de sistemas gestores de bases de datos
                      </a>
                    </li>
                  
                </ul>
              </div>
            
            <div class="lg:col-4 flex items-center">
              
















<div class="share-icons">
  <h5 class="share-title">Compartir :</h5>


  
  
    <a
      class="share-link share-facebook"
      href="https://facebook.com/sharer/sharer.php?u=%2fblog%2fadministracion-bases-de-datos%2f2025-02-17-auditoria-base-de-datos%2f"
      target="_blank"
      rel="noopener"
      aria-label="share facebook">
      <span class="share-icon">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">
          <path
            d="M18.77 7.46H14.5v-1.9c0-.9.6-1.1 1-1.1h3V.5h-4.33C10.24.5 9.5 3.44 9.5 5.32v2.15h-3v4h3v12h5v-12h3.85l.42-4z" />
        </svg>
      </span>
    </a>
  


  
  
    <a
      class="share-link share-twitter"
      href="https://twitter.com/intent/tweet/?text=Compartir&amp;url=%2fblog%2fadministracion-bases-de-datos%2f2025-02-17-auditoria-base-de-datos%2f"
      target="_blank"
      rel="noopener"
      aria-label="share twitter">
      <span aria-hidden="true" class="share-icon">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">
          <path 
            d="M8 2H1l8.26 11.015L1.45 22H4.1l6.388-7.349L16 22h7l-8.608-11.478L21.8 2h-2.65l-5.986 6.886zm9 18L5 4h2l12 16z"/>
        </svg>
      </span>
    </a>
  


  
  
    <a
      class="share-link share-email"
      href="mailto:?subject=Compartir&amp;body=%2fblog%2fadministracion-bases-de-datos%2f2025-02-17-auditoria-base-de-datos%2f"
      target="_self"
      rel="noopener"
      aria-label="share email">
      <span aria-hidden="true" class="share-icon">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">
          <path
            d="M22 4H2C.9 4 0 4.9 0 6v12c0 1.1.9 2 2 2h20c1.1 0 2-.9 2-2V6c0-1.1-.9-2-2-2zM7.25 14.43l-3.5 2c-.08.05-.17.07-.25.07-.17 0-.34-.1-.43-.25-.14-.24-.06-.55.18-.68l3.5-2c.24-.14.55-.06.68.18.14.24.06.55-.18.68zm4.75.07c-.1 0-.2-.03-.27-.08l-8.5-5.5c-.23-.15-.3-.46-.15-.7.15-.22.46-.3.7-.14L12 13.4l8.23-5.32c.23-.15.54-.08.7.15.14.23.07.54-.16.7l-8.5 5.5c-.08.04-.17.07-.27.07zm8.93 1.75c-.1.16-.26.25-.43.25-.08 0-.17-.02-.25-.07l-3.5-2c-.24-.13-.32-.44-.18-.68s.44-.32.68-.18l3.5 2c.24.13.32.44.18.68z" />
        </svg>
      </span>
    </a>
  


  
  
    <a
      class="share-link share-reddit"
      href="https://reddit.com/submit/?url=%2fblog%2fadministracion-bases-de-datos%2f2025-02-17-auditoria-base-de-datos%2f&amp;resubmit=true&amp;title=Compartir"
      target="_blank"
      rel="noopener"
      aria-label="share reddit">
      <span aria-hidden="true" class="share-icon">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">
          <path
            d="M24 11.5c0-1.65-1.35-3-3-3-.96 0-1.86.48-2.42 1.24-1.64-1-3.75-1.64-6.07-1.72.08-1.1.4-3.05 1.52-3.7.72-.4 1.73-.24 3 .5C17.2 6.3 18.46 7.5 20 7.5c1.65 0 3-1.35 3-3s-1.35-3-3-3c-1.38 0-2.54.94-2.88 2.22-1.43-.72-2.64-.8-3.6-.25-1.64.94-1.95 3.47-2 4.55-2.33.08-4.45.7-6.1 1.72C4.86 8.98 3.96 8.5 3 8.5c-1.65 0-3 1.35-3 3 0 1.32.84 2.44 2.05 2.84-.03.22-.05.44-.05.66 0 3.86 4.5 7 10 7s10-3.14 10-7c0-.22-.02-.44-.05-.66 1.2-.4 2.05-1.54 2.05-2.84zM2.3 13.37C1.5 13.07 1 12.35 1 11.5c0-1.1.9-2 2-2 .64 0 1.22.32 1.6.82-1.1.85-1.92 1.9-2.3 3.05zm3.7.13c0-1.1.9-2 2-2s2 .9 2 2-.9 2-2 2-2-.9-2-2zm9.8 4.8c-1.08.63-2.42.96-3.8.96-1.4 0-2.74-.34-3.8-.95-.24-.13-.32-.44-.2-.68.15-.24.46-.32.7-.18 1.83 1.06 4.76 1.06 6.6 0 .23-.13.53-.05.67.2.14.23.06.54-.18.67zm.2-2.8c-1.1 0-2-.9-2-2s.9-2 2-2 2 .9 2 2-.9 2-2 2zm5.7-2.13c-.38-1.16-1.2-2.2-2.3-3.05.38-.5.97-.82 1.6-.82 1.1 0 2 .9 2 2 0 .84-.53 1.57-1.3 1.87z" />
        </svg>
      </span>
    </a>
  


  
  


  
  


  
  


  
  


  
  


  
  
</div>

            </div>
          </div>
          
          
            <div class="mt-20">
              <div id="disqus_thread"></div>
<script>
    window.disqus_config = function () {
    
    
    
    };
    (function() {
        if (["localhost", "127.0.0.1"].indexOf(window.location.hostname) != -1) {
            document.getElementById('disqus_thread').innerHTML = 'Disqus comments not available by default when the website is previewed locally.';
            return;
        }
        var d = document, s = d.createElement('script'); s.async = true;
        s.src = '//' + "javihuete-site" + '.disqus.com/embed.js';
        s.setAttribute('data-timestamp', +new Date());
        (d.head || d.body).appendChild(s);
    })();
</script>
<noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
<a href="https://disqus.com" class="dsq-brlink">comments powered by <span class="logo-disqus">Disqus</span></a>
            </div>
          
        </article>
      </div>

      
      
      
      
        <div class="section pb-0">
          <h2 class="h3 mb-12">Relacionados</h2>
          <div class="row">
            
              <div class="lg:col-4 md:col-6 mb-14">
                <div class="bg-body dark:bg-darkmode-body">
  
  
  <h4 class="mb-3">
    <a href="/blog/administracion-de-sistemas/2025-01-09-systemd-sshfs/">
      Compartición de sistemas de ficheros con sshfs y systemd
    </a>
  </h4>
  
  
    <ul class="mb-4">
      <li class="mr-4 inline-block">
        <a href="/authors/francisco-javier-huete/">
          <i class="fa-regular fa-circle-user mr-2"></i>Francisco Javier Huete
        </a>
      </li>
      <li class="mr-4 inline-block">
        <i class="fa-regular fa-folder mr-1"></i>
        
          <a
            href="/categories/administracion-sistemas/"
            class="ms-1"
            >Administracion sistemas
          </a>
        
      </li>
    </ul>
  
  <p class="mb-6">En este post se demuestra cómo se puede configurar un servidor de almacenamiento en una red local usando sshfs para compartir el sistema de ficheros y systemd para gestionar los puntos de montaje.</p>
  <a class="btn btn-outline-primary btn-sm" href="/blog/administracion-de-sistemas/2025-01-09-systemd-sshfs/">
    Leer
  </a>
</div>

              </div>
            
              <div class="lg:col-4 md:col-6 mb-14">
                <div class="bg-body dark:bg-darkmode-body">
  
  
  <h4 class="mb-3">
    <a href="/blog/implantacion-aplicaciones-web/2025-03-09-instalacion-jenkins-usando-docker-como-runner/">
      Instalación de Jenkins usando Docker como runner
    </a>
  </h4>
  
  
    <ul class="mb-4">
      <li class="mr-4 inline-block">
        <a href="/authors/francisco-javier-huete/">
          <i class="fa-regular fa-circle-user mr-2"></i>Francisco Javier Huete
        </a>
      </li>
      <li class="mr-4 inline-block">
        <i class="fa-regular fa-folder mr-1"></i>
        
          <a
            href="/categories/implantacion/"
            class="ms-1"
            >Implantacion
          </a>
        
      </li>
    </ul>
  
  <p class="mb-6"><p>En primer lugar, en un equipo con Docker instalado instalamos también Jenkins.</p></p>
  <a class="btn btn-outline-primary btn-sm" href="/blog/implantacion-aplicaciones-web/2025-03-09-instalacion-jenkins-usando-docker-como-runner/">
    Leer
  </a>
</div>

              </div>
            
              <div class="lg:col-4 md:col-6 mb-14">
                <div class="bg-body dark:bg-darkmode-body">
  
  
  <h4 class="mb-3">
    <a href="/blog/sistemas/2024-02-04-gestion-sistema-ficheros-debian/">
      Creación y configuración de un sistema de ficheros en Debian 12
    </a>
  </h4>
  
  
    <ul class="mb-4">
      <li class="mr-4 inline-block">
        <a href="/authors/francisco-javier-huete/">
          <i class="fa-regular fa-circle-user mr-2"></i>Francisco Javier Huete
        </a>
      </li>
      <li class="mr-4 inline-block">
        <i class="fa-regular fa-folder mr-1"></i>
        
          <a
            href="/categories/sistemas/"
            class="ms-1"
            >Sistemas
          </a>
        
      </li>
    </ul>
  
  <p class="mb-6"><p>En este post se plantea un caso práctico en el que se emplean varios comandos para la configuración de sistemas de ficheros en Debian. En concreto, se trata de un ejemplo en el que se instala Debina 12 en una máquina con recursos limitados en VirtManager y, posteriormente, se amplía el espacio de almacenamiento añadiendo un nuevo disco duro y clonando el sistema en él.</p></p>
  <a class="btn btn-outline-primary btn-sm" href="/blog/sistemas/2024-02-04-gestion-sistema-ficheros-debian/">
    Leer
  </a>
</div>

              </div>
            
          </div>
        </div>
      
    </div>
  </section>

    </main>

    
    <footer class="bg-theme-light dark:bg-darkmode-theme-light">
  <div class="container">
    <div class="row items-center py-10">
      <div class="lg:col-3 mb-8 text-center lg:mb-0 lg:text-left">
        
        <a
          class="navbar-brand inline-block"
          href="/">
          















  









  
  
  


  
  
    
    
  


  
  
      
      
    
    
    
    
    
    
  
  

  
  
    
    
      
      


      
      
        
        
        
        

        
        
        
      
      
    
  
  

  
    <img
      fetchpriority="high"
      decoding="async"
      class="img img-light"
      width="160"
      height="32"
      src="/images/logo_hu_147412e9a193273b.webp"
      alt="Javi Huete"
      onerror="this.onerror=null;this.src='\/images\/logo_hu_239070bac3e16f0e.png';" />

    <img
      fetchpriority="high"
      decoding="async"
      class="img img-dark"
      width="160"
      height="32"
      src="/images/logo-darkmode_hu_590aa44f8245a468.webp"
      alt="Javi Huete"
      onerror="this.onerror=null;this.src='\/images\/logo-darkmode_hu_7ac6db7b4e6aa847.png';" />
  
  


        </a>
      </div>
      <div class="lg:col-6 mb-8 text-center lg:mb-0">
        <ul>
          
            <li class="m-3 inline-block">
              <a
                
                href="
                  /about
                "
                >Sobre mí</a
              >
            </li>
          
            <li class="m-3 inline-block">
              <a
                
                href="
                  /blog
                "
                >Prácticas</a
              >
            </li>
          
            <li class="m-3 inline-block">
              <a
                
                href="
                  /contact
                "
                >Contacto</a
              >
            </li>
          
        </ul>
      </div>
      <div class="lg:col-3 mb-8 text-center lg:mb-0 lg:mt-0 lg:text-right">
        <ul class="social-icons">
          
            <li>
              <a
                target="_blank"
                aria-label="email"
                rel="nofollow noopener"
                href="mailto:fjhuete.m@gmail.com">
                <i class="fa-solid fa-envelope"></i>
              </a>
            </li>
          
            <li>
              <a
                target="_blank"
                aria-label="github"
                rel="nofollow noopener"
                href="https://www.github.com/fjhuete">
                <i class="fab fa-github"></i>
              </a>
            </li>
          
            <li>
              <a
                target="_blank"
                aria-label="linkedin"
                rel="nofollow noopener"
                href="https://www.linkedin.com/in/fjhuete">
                <i class="fab fa-linkedin"></i>
              </a>
            </li>
          
            <li>
              <a
                target="_blank"
                aria-label="telegram"
                rel="nofollow noopener"
                href="https://t.me/fj_huete">
                <i class="fab fa-telegram"></i>
              </a>
            </li>
          
        </ul>
      </div>
    </div>
  </div>
  <div class="border-border dark:border-darkmode-border border-t py-7">
    <div class="text-light dark:text-darkmode-light container text-center">
      <p>
        Esta web está licenciada bajo <a href="http://creativecommons.org/licenses/by-nc/4.0/?ref=chooser-v1"




 target="_blank"
 


>CC BY-NC-SA 4.0</a>. Funciona con <a href="gohugo.io"



 


>Hugo</a> y <a href="https://github.com/zeon-studio/hugoplate"




 target="_blank"
 


>Hugoplate</a>
      </p>
    </div>
  </div>
</footer>



    
    



  
    
      
    
  

  
    
      
    
  

  
    
      
    
  

  
    
      
    
  

  
    
      
    
  

  
    
      
    
  

  
    
      
    
  

  
    
      
    
  

  
    
      
    
  










  
  



<script
  crossorigin="anonymous"
  integrity="sha256-LO9JECYLqyMcpGlrtxZcpUn0I8AvhO6oIIibJZv4zbk="
  src="/js/script.min.2cef4910260bab231ca4696bb7165ca549f423c02f84eea820889b259bf8cdb9.js"></script>


<script
  defer
  async
  crossorigin="anonymous"
  integrity="sha256-6WomfiWXziApPR9exxy3xjT2w9Za&#43;OYxJPD02L7xe5A="
  src="/js/script-lazy.min.e96a267e2597ce20293d1f5ec71cb7c634f6c3d65af8e63124f0f4d8bef17b90.js"></script>



<script>
  if ('serviceWorker' in navigator){navigator.serviceWorker.register("/service-worker.js");}
</script>






  












  



  </body>
</html>
